<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Ailleyçš„åšå®¢</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ailley.github.io/"/>
  <updated>2016-10-25T01:08:04.079Z</updated>
  <id>https://ailley.github.io/</id>
  
  <author>
    <name>Ailley</name>
    <email>137080253@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ­£åˆ™çš„æ‰©å±•</title>
    <link href="https://ailley.github.io/2016/10/25/%E6%AD%A3%E5%88%99%E7%9A%84%E6%89%A9%E5%B1%95/"/>
    <id>https://ailley.github.io/2016/10/25/æ­£åˆ™çš„æ‰©å±•/</id>
    <published>2016-10-25T01:05:01.000Z</published>
    <updated>2016-10-25T01:08:04.079Z</updated>
    
    <content type="html"><![CDATA[<h2 id="RegExpæ„é€ å‡½æ•°"><a href="#RegExpæ„é€ å‡½æ•°" class="headerlink" title="RegExpæ„é€ å‡½æ•°"></a>RegExpæ„é€ å‡½æ•°</h2><p>åœ¨ES5ä¸­ï¼ŒRegExpæ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚</p>
<p>ç¬¬ä¸€ç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'xyz'</span>, <span class="string">'i'</span>);</div><div class="line"><span class="comment">// ç­‰ä»·äº</span></div><div class="line"><span class="keyword">var</span> regex = <span class="regexp">/xyz/i</span>;</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/i</span>);</div><div class="line"><span class="comment">// ç­‰ä»·äº</span></div><div class="line"><span class="keyword">var</span> regex = <span class="regexp">/xyz/i</span>;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼ŒES5ä¸å…è®¸æ­¤æ—¶ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ·»åŠ ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/</span>, <span class="string">'i'</span>);</div><div class="line"><span class="comment">// Uncaught TypeError: Cannot supply flags when constructing one RegExp from another</span></div></pre></td></tr></table></figure>
<p>ES6æ”¹å˜äº†è¿™ç§è¡Œä¸ºã€‚å¦‚æœRegExpæ„é€ å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¿®é¥°ç¬¦ã€‚è€Œä¸”ï¼Œè¿”å›çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥åŸæœ‰çš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼Œåªä½¿ç”¨æ–°æŒ‡å®šçš„ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/abc/ig</span>, <span class="string">'i'</span>).flags</div><div class="line"><span class="comment">// "i"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸæœ‰æ­£åˆ™å¯¹è±¡çš„ä¿®é¥°ç¬¦æ˜¯<code>ig</code>ï¼Œå®ƒä¼šè¢«ç¬¬äºŒä¸ªå‚æ•°<code>i</code>è¦†ç›–ã€‚<br><a id="more"></a></p>
<h2 id="å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•"><a href="#å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•" class="headerlink" title="å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•"></a>å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•</h2><p>å­—ç¬¦ä¸²å¯¹è±¡å…±æœ‰4ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼š<code>match()</code>ã€<code>replace()</code>ã€<code>search()</code>å’Œ<code>split()</code>ã€‚</p>
<p>ES6å°†è¿™4ä¸ªæ–¹æ³•ï¼Œåœ¨è¯­è¨€å†…éƒ¨å…¨éƒ¨è°ƒç”¨RegExpçš„å®ä¾‹æ–¹æ³•ï¼Œä»è€Œåšåˆ°æ‰€æœ‰ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•ï¼Œå…¨éƒ½å®šä¹‰åœ¨RegExpå¯¹è±¡ä¸Šã€‚</p>
<ul>
<li><code>String.prototype.match</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.match]</code></li>
<li><code>String.prototype.replace</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.replace]</code></li>
<li><code>String.prototype.search</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.search]</code></li>
<li><code>String.prototype.split</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.split]</code></li>
</ul>
<h2 id="uä¿®é¥°ç¬¦"><a href="#uä¿®é¥°ç¬¦" class="headerlink" title="uä¿®é¥°ç¬¦"></a>uä¿®é¥°ç¬¦</h2><p>ES6å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†<code>u</code>ä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicodeæ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº<code>\uFFFF</code>çš„Unicodeå­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/^\uD83D/u.test(<span class="string">'\uD83D\uDC2A'</span>)</div><div class="line"><span class="comment">// false</span></div><div class="line">/^\uD83D/.test(<span class="string">'\uD83D\uDC2A'</span>)</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>\uD83D\uDC2A</code>æ˜¯ä¸€ä¸ªå››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ï¼Œä»£è¡¨ä¸€ä¸ªå­—ç¬¦ã€‚ä½†æ˜¯ï¼ŒES5ä¸æ”¯æŒå››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ï¼Œä¼šå°†å…¶è¯†åˆ«ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ç¬¬äºŒè¡Œä»£ç ç»“æœä¸º<code>true</code>ã€‚åŠ äº†<code>u</code>ä¿®é¥°ç¬¦ä»¥åï¼ŒES6å°±ä¼šè¯†åˆ«å…¶ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œä»£ç ç»“æœä¸º<code>false</code>ã€‚</p>
<p>ä¸€æ—¦åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦å·ï¼Œå°±ä¼šä¿®æ”¹ä¸‹é¢è¿™äº›æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸ºã€‚</p>
<p><strong>ï¼ˆ1ï¼‰ç‚¹å­—ç¬¦</strong></p>
<p>ç‚¹ï¼ˆ<code>.</code>ï¼‰å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·'</span>;</div><div class="line"></div><div class="line"><span class="regexp">/^.$/</span>.test(s) <span class="comment">// false</span></div><div class="line">/^.$/u.test(s) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸æ·»åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±ä¼šè®¤ä¸ºå­—ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œä»è€ŒåŒ¹é…å¤±è´¥ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰Unicodeå­—ç¬¦è¡¨ç¤ºæ³•</strong></p>
<p>ES6æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤ºUnicodeå­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/\u&#123;<span class="number">61</span>&#125;/.test(<span class="string">'a'</span>) <span class="comment">// false</span></div><div class="line">/\u&#123;<span class="number">61</span>&#125;/u.test(<span class="string">'a'</span>) <span class="comment">// true</span></div><div class="line">/\u&#123;<span class="number">20</span>BB7&#125;/u.test(<span class="string">'ğ ®·'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ— æ³•è¯†åˆ«<code>\u{61}</code>è¿™ç§è¡¨ç¤ºæ³•ï¼Œåªä¼šè®¤ä¸ºè¿™åŒ¹é…61ä¸ªè¿ç»­çš„<code>u</code>ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰é‡è¯</strong></p>
<p>ä½¿ç”¨<code>u</code>ä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/a&#123;<span class="number">2</span>&#125;/.test(<span class="string">'aa'</span>) <span class="comment">// true</span></div><div class="line">/a&#123;<span class="number">2</span>&#125;/u.test(<span class="string">'aa'</span>) <span class="comment">// true</span></div><div class="line">/ğ ®·&#123;<span class="number">2</span>&#125;/.test(<span class="string">'ğ ®·ğ ®·'</span>) <span class="comment">// false</span></div><div class="line">/ğ ®·&#123;<span class="number">2</span>&#125;/u.test(<span class="string">'ğ ®·ğ ®·'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œåªæœ‰åœ¨ä½¿ç”¨<code>u</code>ä¿®é¥°ç¬¦çš„æƒ…å†µä¸‹ï¼ŒUnicodeè¡¨è¾¾å¼å½“ä¸­çš„å¤§æ‹¬å·æ‰ä¼šè¢«æ­£ç¡®è§£è¯»ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/^\u&#123;<span class="number">3</span>&#125;$/.test(<span class="string">'uuu'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºæ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰<code>u</code>ä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥å¤§æ‹¬å·è¢«è§£è¯»ä¸ºé‡è¯ã€‚åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ï¼Œå°±ä¼šè¢«è§£è¯»ä¸ºUnicodeè¡¨è¾¾å¼ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰é¢„å®šä¹‰æ¨¡å¼</strong></p>
<p><code>u</code>ä¿®é¥°ç¬¦ä¹Ÿå½±å“åˆ°é¢„å®šä¹‰æ¨¡å¼ï¼Œèƒ½å¦æ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/^\S$/.test(<span class="string">'ğ ®·'</span>) <span class="comment">// false</span></div><div class="line">/^\S$/u.test(<span class="string">'ğ ®·'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>\S</code>æ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰ä¸æ˜¯ç©ºæ ¼çš„å­—ç¬¦ã€‚åªæœ‰åŠ äº†<code>u</code>ä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸€ä¸ªæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">codePointLength</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> result = text.match(<span class="regexp">/[\s\S]/gu</span>);</div><div class="line">  <span class="keyword">return</span> result ? result.length : <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·ğ ®·'</span>;</div><div class="line"></div><div class="line">s.length <span class="comment">// 4</span></div><div class="line">codePointLength(s) <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ5ï¼‰iä¿®é¥°ç¬¦</strong></p>
<p>æœ‰äº›Unicodeå­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆç›¸è¿‘ï¼Œæ¯”å¦‚ï¼Œ<code>\u004B</code>ä¸<code>\u212A</code>éƒ½æ˜¯å¤§å†™çš„Kã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/[a-z]/i.test(<span class="string">'\u212A'</span>) <span class="comment">// false</span></div><div class="line">/[a-z]/iu.test(<span class="string">'\u212A'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œå°±æ— æ³•è¯†åˆ«éè§„èŒƒçš„Kå­—ç¬¦ã€‚</p>
<h2 id="yä¿®é¥°ç¬¦"><a href="#yä¿®é¥°ç¬¦" class="headerlink" title="yä¿®é¥°ç¬¦"></a>yä¿®é¥°ç¬¦</h2><p>é™¤äº†<code>u</code>ä¿®é¥°ç¬¦ï¼ŒES6è¿˜ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†<code>y</code>ä¿®é¥°ç¬¦ï¼Œå«åšâ€œç²˜è¿â€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦ã€‚</p>
<p><code>y</code>ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸<code>g</code>ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<code>g</code>ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ<code>y</code>ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯â€œç²˜è¿â€çš„æ¶µä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'aaa_aa_a'</span>;</div><div class="line"><span class="keyword">var</span> r1 = <span class="regexp">/a+/g</span>;</div><div class="line"><span class="keyword">var</span> r2 = <span class="regexp">/a+/y</span>;</div><div class="line"></div><div class="line">r1.exec(s) <span class="comment">// ["aaa"]</span></div><div class="line">r2.exec(s) <span class="comment">// ["aaa"]</span></div><div class="line"></div><div class="line">r1.exec(s) <span class="comment">// ["aa"]</span></div><div class="line">r2.exec(s) <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æœ‰ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸€ä¸ªä½¿ç”¨<code>g</code>ä¿®é¥°ç¬¦ï¼Œå¦ä¸€ä¸ªä½¿ç”¨<code>y</code>ä¿®é¥°ç¬¦ã€‚è¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼å„æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸¤è€…è¡Œä¸ºç›¸åŒï¼Œå‰©ä½™å­—ç¬¦ä¸²éƒ½æ˜¯<code>_aa_a</code>ã€‚ç”±äº<code>g</code>ä¿®é¥°æ²¡æœ‰ä½ç½®è¦æ±‚ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡æ‰§è¡Œä¼šè¿”å›ç»“æœï¼Œè€Œ<code>y</code>ä¿®é¥°ç¬¦è¦æ±‚åŒ¹é…å¿…é¡»ä»å¤´éƒ¨å¼€å§‹ï¼Œæ‰€ä»¥è¿”å›<code>null</code>ã€‚</p>
<p>å¦‚æœæ”¹ä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¿è¯æ¯æ¬¡éƒ½èƒ½å¤´éƒ¨åŒ¹é…ï¼Œ<code>y</code>ä¿®é¥°ç¬¦å°±ä¼šè¿”å›ç»“æœäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'aaa_aa_a'</span>;</div><div class="line"><span class="keyword">var</span> r = <span class="regexp">/a+_/y</span>;</div><div class="line"></div><div class="line">r.exec(s) <span class="comment">// ["aaa_"]</span></div><div class="line">r.exec(s) <span class="comment">// ["aa_"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ¯æ¬¡åŒ¹é…ï¼Œéƒ½æ˜¯ä»å‰©ä½™å­—ç¬¦ä¸²çš„å¤´éƒ¨å¼€å§‹ã€‚</p>
<p>ä½¿ç”¨<code>lastIndex</code>å±æ€§ï¼Œå¯ä»¥æ›´å¥½åœ°è¯´æ˜<code>y</code>ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> REGEX = <span class="regexp">/a/g</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŒ‡å®šä»2å·ä½ç½®ï¼ˆyï¼‰å¼€å§‹åŒ¹é…</span></div><div class="line">REGEX.lastIndex = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">// åŒ¹é…æˆåŠŸ</span></div><div class="line"><span class="keyword">const</span> match = REGEX.exec(<span class="string">'xaya'</span>);</div><div class="line"></div><div class="line"><span class="comment">// åœ¨3å·ä½ç½®åŒ¹é…æˆåŠŸ</span></div><div class="line">match.index <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="comment">// ä¸‹ä¸€æ¬¡åŒ¹é…ä»4å·ä½å¼€å§‹</span></div><div class="line">REGEX.lastIndex <span class="comment">// 4</span></div><div class="line"></div><div class="line"><span class="comment">// 4å·ä½å¼€å§‹åŒ¹é…å¤±è´¥</span></div><div class="line">REGEX.exec(<span class="string">'xaxa'</span>) <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>lastIndex</code>å±æ€§æŒ‡å®šæ¯æ¬¡æœç´¢çš„å¼€å§‹ä½ç½®ï¼Œ<code>g</code>ä¿®é¥°ç¬¦ä»è¿™ä¸ªä½ç½®å¼€å§‹å‘åæœç´¢ï¼Œç›´åˆ°å‘ç°åŒ¹é…ä¸ºæ­¢ã€‚</p>
<p><code>y</code>ä¿®é¥°ç¬¦åŒæ ·éµå®ˆ<code>lastIndex</code>å±æ€§ï¼Œä½†æ˜¯è¦æ±‚å¿…é¡»åœ¨<code>lastIndex</code>æŒ‡å®šçš„ä½ç½®å‘ç°åŒ¹é…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> REGEX = <span class="regexp">/a/y</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŒ‡å®šä»2å·ä½ç½®å¼€å§‹åŒ¹é…</span></div><div class="line">REGEX.lastIndex = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä¸æ˜¯ç²˜è¿ï¼ŒåŒ¹é…å¤±è´¥</span></div><div class="line">REGEX.exec(<span class="string">'xaya'</span>) <span class="comment">// null</span></div><div class="line"></div><div class="line"><span class="comment">// æŒ‡å®šä»3å·ä½ç½®å¼€å§‹åŒ¹é…</span></div><div class="line">REGEX.lastIndex = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// 3å·ä½ç½®æ˜¯ç²˜è¿ï¼ŒåŒ¹é…æˆåŠŸ</span></div><div class="line"><span class="keyword">const</span> match = REGEX.exec(<span class="string">'xaxa'</span>);</div><div class="line">match.index <span class="comment">// 3</span></div><div class="line">REGEX.lastIndex <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<p>è¿›ä¸€æ­¥è¯´ï¼Œ<code>y</code>ä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—<code>^</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/b/y.exec(<span class="string">'aba'</span>)</div><div class="line"><span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ç”±äºä¸èƒ½ä¿è¯å¤´éƒ¨åŒ¹é…ï¼Œæ‰€ä»¥è¿”å›<code>null</code>ã€‚<code>y</code>ä¿®é¥°ç¬¦çš„è®¾è®¡æœ¬æ„ï¼Œå°±æ˜¯è®©å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—<code>^</code>åœ¨å…¨å±€åŒ¹é…ä¸­éƒ½æœ‰æ•ˆã€‚</p>
<p>åœ¨<code>split</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>y</code>ä¿®é¥°ç¬¦ï¼ŒåŸå­—ç¬¦ä¸²å¿…é¡»ä»¥åˆ†éš”ç¬¦å¼€å¤´ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œåªè¦åŒ¹é…æˆåŠŸï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜è‚¯å®šæ˜¯ç©ºå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ²¡æœ‰æ‰¾åˆ°åŒ¹é…</span></div><div class="line"><span class="string">'x##'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ 'x##' ]</span></div><div class="line"></div><div class="line"><span class="comment">// æ‰¾åˆ°ä¸¤ä¸ªåŒ¹é…</span></div><div class="line"><span class="string">'##x'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ '', '', 'x' ]</span></div></pre></td></tr></table></figure>
<p>åç»­çš„åˆ†éš”ç¬¦åªæœ‰ç´§è·Ÿå‰é¢çš„åˆ†éš”ç¬¦ï¼Œæ‰ä¼šè¢«è¯†åˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'#x#'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ '', 'x#' ]</span></div><div class="line"></div><div class="line"><span class="string">'##'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ '', '', '' ]</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å­—ç¬¦ä¸²å¯¹è±¡çš„<code>replace</code>æ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> REGEX = <span class="regexp">/a/gy</span>;</div><div class="line"><span class="string">'aaxa'</span>.replace(REGEX, <span class="string">'-'</span>) <span class="comment">// '--xa'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ª<code>a</code>å› ä¸ºä¸æ˜¯å‡ºç°ä¸‹ä¸€æ¬¡åŒ¹é…çš„å¤´éƒ¨ï¼Œæ‰€ä»¥ä¸ä¼šè¢«æ›¿æ¢ã€‚</p>
<p>å•å•ä¸€ä¸ª<code>y</code>ä¿®é¥°ç¬¦å¯¹<code>match</code>æ–¹æ³•ï¼Œåªèƒ½è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œå¿…é¡»ä¸<code>g</code>ä¿®é¥°ç¬¦è”ç”¨ï¼Œæ‰èƒ½è¿”å›æ‰€æœ‰åŒ¹é…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'a1a2a3'</span>.match(<span class="regexp">/a\d/y</span>) <span class="comment">// ["a1"]</span></div><div class="line"><span class="string">'a1a2a3'</span>.match(<span class="regexp">/a\d/gy</span>) <span class="comment">// ["a1", "a2", "a3"]</span></div></pre></td></tr></table></figure>
<p><code>y</code>ä¿®é¥°ç¬¦çš„ä¸€ä¸ªåº”ç”¨ï¼Œæ˜¯ä»å­—ç¬¦ä¸²æå–tokenï¼ˆè¯å…ƒï¼‰ï¼Œ<code>y</code>ä¿®é¥°ç¬¦ç¡®ä¿äº†åŒ¹é…ä¹‹é—´ä¸ä¼šæœ‰æ¼æ‰çš„å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TOKEN_Y = <span class="regexp">/\s*(\+|[0-9]+)\s*/y</span>;</div><div class="line"><span class="keyword">const</span> TOKEN_G  = <span class="regexp">/\s*(\+|[0-9]+)\s*/g</span>;</div><div class="line"></div><div class="line">tokenize(TOKEN_Y, <span class="string">'3 + 4'</span>)</div><div class="line"><span class="comment">// [ '3', '+', '4' ]</span></div><div class="line">tokenize(TOKEN_G, <span class="string">'3 + 4'</span>)</div><div class="line"><span class="comment">// [ '3', '+', '4' ]</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tokenize</span>(<span class="params">TOKEN_REGEX, str</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> result = [];</div><div class="line">  <span class="keyword">let</span> match;</div><div class="line">  <span class="keyword">while</span> (match = TOKEN_REGEX.exec(str)) &#123;</div><div class="line">    result.push(match[<span class="number">1</span>]);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²é‡Œé¢æ²¡æœ‰éæ³•å­—ç¬¦ï¼Œ<code>y</code>ä¿®é¥°ç¬¦ä¸<code>g</code>ä¿®é¥°ç¬¦çš„æå–ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦å‡ºç°éæ³•å­—ç¬¦ï¼Œä¸¤è€…çš„è¡Œä¸ºå°±ä¸ä¸€æ ·äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">tokenize(TOKEN_Y, <span class="string">'3x + 4'</span>)</div><div class="line"><span class="comment">// [ '3' ]</span></div><div class="line">tokenize(TOKEN_G, <span class="string">'3x + 4'</span>)</div><div class="line"><span class="comment">// [ '3', '+', '4' ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>g</code>ä¿®é¥°ç¬¦ä¼šå¿½ç•¥éæ³•å­—ç¬¦ï¼Œè€Œ<code>y</code>ä¿®é¥°ç¬¦ä¸ä¼šï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“å‘ç°é”™è¯¯ã€‚</p>
<h2 id="stickyå±æ€§"><a href="#stickyå±æ€§" class="headerlink" title="stickyå±æ€§"></a>stickyå±æ€§</h2><p>ä¸<code>y</code>ä¿®é¥°ç¬¦ç›¸åŒ¹é…ï¼ŒES6çš„æ­£åˆ™å¯¹è±¡å¤šäº†<code>sticky</code>å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†<code>y</code>ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> r = <span class="regexp">/hello\d/y</span>;</div><div class="line">r.sticky <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h2 id="flagså±æ€§"><a href="#flagså±æ€§" class="headerlink" title="flagså±æ€§"></a>flagså±æ€§</h2><p>ES6ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ–°å¢äº†<code>flags</code>å±æ€§ï¼Œä¼šè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5çš„sourceå±æ€§</span></div><div class="line"><span class="comment">// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„æ­£æ–‡</span></div><div class="line">/abc/ig.source</div><div class="line"><span class="comment">// "abc"</span></div><div class="line"></div><div class="line"><span class="comment">// ES6çš„flagså±æ€§</span></div><div class="line"><span class="comment">// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦</span></div><div class="line">/abc/ig.flags</div><div class="line"><span class="comment">// 'gi'</span></div></pre></td></tr></table></figure>
<h2 id="RegExp-escape"><a href="#RegExp-escape" class="headerlink" title="RegExp.escape()"></a>RegExp.escape()</h2><p>å­—ç¬¦ä¸²å¿…é¡»è½¬ä¹‰ï¼Œæ‰èƒ½ä½œä¸ºæ­£åˆ™æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escapeRegExp</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/[\-\[\]\/\&#123;\&#125;\(\)\*\+\?\.\\\^\$\|]/g</span>, <span class="string">'\\$&amp;'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> str = <span class="string">'/path/to/resource.html?search=query'</span>;</div><div class="line">escapeRegExp(str)</div><div class="line"><span class="comment">// "\/path\/to\/resource\.html\?search=query"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>str</code>æ˜¯ä¸€ä¸ªæ­£å¸¸å­—ç¬¦ä¸²ï¼Œå¿…é¡»ä½¿ç”¨åæ–œæ å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œæ‰èƒ½ç”¨æ¥ä½œä¸ºä¸€ä¸ªæ­£åˆ™åŒ¹é…çš„æ¨¡å¼ã€‚</p>
<p>å·²ç»æœ‰<a href="https://esdiscuss.org/topic/regexp-escape" target="_blank" rel="external">æè®®</a>å°†è¿™ä¸ªéœ€æ±‚æ ‡å‡†åŒ–ï¼Œä½œä¸ºRegExpå¯¹è±¡çš„é™æ€æ–¹æ³•<a href="https://github.com/benjamingr/RexExp.escape" target="_blank" rel="external">RegExp.escape()</a>ï¼Œæ”¾å…¥ES7ã€‚2015å¹´7æœˆ31æ—¥ï¼ŒTC39è®¤ä¸ºï¼Œè¿™ä¸ªæ–¹æ³•æœ‰å®‰å…¨é£é™©ï¼Œåˆä¸æ„¿è¿™ä¸ªæ–¹æ³•å˜å¾—è¿‡äºå¤æ‚ï¼Œæ²¡æœ‰åŒæ„å°†å…¶åˆ—å…¥ES7ï¼Œä½†è¿™ä¸å¤±ä¸ºä¸€ä¸ªçœŸå®çš„éœ€æ±‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">RegExp</span>.escape(<span class="string">'The Quick Brown Fox'</span>);</div><div class="line"><span class="comment">// "The Quick Brown Fox"</span></div><div class="line"></div><div class="line"><span class="built_in">RegExp</span>.escape(<span class="string">'Buy it. use it. break it. fix it.'</span>);</div><div class="line"><span class="comment">// "Buy it\. use it\. break it\. fix it\."</span></div><div class="line"></div><div class="line"><span class="built_in">RegExp</span>.escape(<span class="string">'(*.*)'</span>);</div><div class="line"><span class="comment">// "\(\*\.\*\)"</span></div></pre></td></tr></table></figure>
<p>å­—ç¬¦ä¸²è½¬ä¹‰ä»¥åï¼Œå¯ä»¥ä½¿ç”¨RegExpæ„é€ å‡½æ•°ç”Ÿæˆæ­£åˆ™æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'hello. how are you?'</span>;</div><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="built_in">RegExp</span>.escape(str), <span class="string">'g'</span>);</div><div class="line">assert.equal(<span class="built_in">String</span>(regex), <span class="string">'/hello\. how are you\?/g'</span>);</div></pre></td></tr></table></figure>
<p>ç›®å‰ï¼Œè¯¥æ–¹æ³•å¯ä»¥ç”¨ä¸Šæ–‡çš„<code>escapeRegExp</code>å‡½æ•°æˆ–è€…å«ç‰‡æ¨¡å—<a href="https://github.com/ljharb/regexp.escape" target="_blank" rel="external">regexp.escape</a>å®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="built_in">escape</span> = <span class="built_in">require</span>(<span class="string">'regexp.escape'</span>);</div><div class="line"><span class="built_in">escape</span>(<span class="string">'hi. how are you?'</span>);</div><div class="line"><span class="comment">// "hi\\. how are you\\?"</span></div></pre></td></tr></table></figure>
<h2 id="åè¡Œæ–­è¨€"><a href="#åè¡Œæ–­è¨€" class="headerlink" title="åè¡Œæ–­è¨€"></a>åè¡Œæ–­è¨€</h2><p>JavaScriptè¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæ”¯æŒå…ˆè¡Œæ–­è¨€ï¼ˆlookaheadï¼‰å’Œå…ˆè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookaheadï¼‰ï¼Œä¸æ”¯æŒåè¡Œæ–­è¨€ï¼ˆlookbehindï¼‰å’Œåè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookbehindï¼‰ã€‚</p>
<p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ª<a href="https://github.com/goyakin/es-regexp-lookbehind" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œåœ¨ES7åŠ å…¥åè¡Œæ–­è¨€ã€‚V8å¼•æ“4.9ç‰ˆå·²ç»æ”¯æŒï¼ŒChromeæµè§ˆå™¨49ç‰ˆæ‰“å¼€â€experimental JavaScript featuresâ€œå¼€å…³ï¼ˆåœ°å€æ é”®å…¥<code>about:flags</code>ï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ã€‚</p>
<p>â€å…ˆè¡Œæ–­è¨€â€œæŒ‡çš„æ˜¯ï¼Œ<code>x</code>åªæœ‰åœ¨<code>y</code>å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/x(?=y)/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ<code>/\d+(?=%)/</code>ã€‚â€å…ˆè¡Œå¦å®šæ–­è¨€â€œæŒ‡çš„æ˜¯ï¼Œ<code>x</code>åªæœ‰ä¸åœ¨<code>y</code>å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/x(?!y)/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ<code>/\d+(?!%)/</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/\d+(?=%)/.exec(<span class="string">'100% of US presidents have been male'</span>)  <span class="comment">// ["100"]</span></div><div class="line">/\d+(?!%)/.exec(<span class="string">'thatâ€™s all 44 of them'</span>)                 <span class="comment">// ["44"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœäº’æ¢æ­£åˆ™è¡¨è¾¾å¼ï¼Œå°±ä¼šåŒ¹é…å¤±è´¥ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ï¼Œâ€å…ˆè¡Œæ–­è¨€â€œæ‹¬å·ä¹‹ä¸­çš„éƒ¨åˆ†ï¼ˆ<code>(?=%)</code>ï¼‰ï¼Œæ˜¯ä¸è®¡å…¥è¿”å›ç»“æœçš„ã€‚</p>
<p>â€œåè¡Œæ–­è¨€â€æ­£å¥½ä¸â€å…ˆè¡Œæ–­è¨€â€ç›¸åï¼Œ<code>x</code>åªæœ‰åœ¨<code>y</code>åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/(?&lt;=y)x/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç¾å…ƒç¬¦å·ä¹‹åçš„æ•°å­—ï¼Œè¦å†™æˆ<code>/(?&lt;=\$)\d+/</code>ã€‚â€åè¡Œå¦å®šæ–­è¨€â€œåˆ™ä¸â€å…ˆè¡Œå¦å®šæ–­è¨€â€œç›¸åï¼Œ<code>x</code>åªæœ‰ä¸åœ¨<code>y</code>åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/(?&lt;!y)x/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç¾å…ƒç¬¦å·åé¢çš„æ•°å­—ï¼Œè¦å†™æˆ<code>/(?&lt;!\$)\d+/</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/(?&lt;=\$)\d+/.exec('Benjamin Franklin is on the $100 bill')  // ["100"]</div><div class="line">/(?&lt;!\$)\d+/.exec('itâ€™s is worth about â‚¬90')                // ["90"]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œâ€åè¡Œæ–­è¨€â€çš„æ‹¬å·ä¹‹ä¸­çš„éƒ¨åˆ†ï¼ˆ<code>(?&lt;=\$)</code>ï¼‰ï¼Œä¹Ÿæ˜¯ä¸è®¡å…¥è¿”å›ç»“æœã€‚</p>
<p>â€œåè¡Œæ–­è¨€â€çš„å®ç°ï¼Œéœ€è¦å…ˆåŒ¹é…<code>/(?&lt;=y)x/</code>çš„<code>x</code>ï¼Œç„¶åå†å›åˆ°å·¦è¾¹ï¼ŒåŒ¹é…<code>y</code>çš„éƒ¨åˆ†ã€‚è¿™ç§â€å…ˆå³åå·¦â€çš„æ‰§è¡Œé¡ºåºï¼Œä¸æ‰€æœ‰å…¶ä»–æ­£åˆ™æ“ä½œç›¸åï¼Œå¯¼è‡´äº†ä¸€äº›ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚</p>
<p>é¦–å…ˆï¼Œâ€åè¡Œæ–­è¨€â€œçš„ç»„åŒ¹é…ï¼Œä¸æ­£å¸¸æƒ…å†µä¸‹ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/(?&lt;=(\d+)(\d+))$/.exec('1053') // ["", "1", "053"]</div><div class="line">/^(\d+)(\d+)$/.exec('1053') // ["1053", "105", "3"]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œéœ€è¦æ•æ‰ä¸¤ä¸ªç»„åŒ¹é…ã€‚æ²¡æœ‰â€åè¡Œæ–­è¨€â€æ—¶ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬äºŒä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯<code>105</code>å’Œ<code>3</code>ã€‚è€Œâ€åè¡Œæ–­è¨€â€æ—¶ï¼Œç”±äºæ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼Œç¬¬äºŒä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯<code>1</code>å’Œ<code>053</code>ã€‚</p>
<p>å…¶æ¬¡ï¼Œâ€åè¡Œæ–­è¨€â€çš„åæ–œæ å¼•ç”¨ï¼Œä¹Ÿä¸é€šå¸¸çš„é¡ºåºç›¸åï¼Œå¿…é¡»æ”¾åœ¨å¯¹åº”çš„é‚£ä¸ªæ‹¬å·ä¹‹å‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/(?&lt;=(o)d\1)r/.exec('hodor')  // null</div><div class="line">/(?&lt;=\1d(o))r/.exec('hodor')  // ["r", "o"]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåè¡Œæ–­è¨€çš„åæ–œæ å¼•ç”¨ï¼ˆ<code>\1</code>ï¼‰æ”¾åœ¨æ‹¬å·çš„åé¢ï¼Œå°±ä¸ä¼šå¾—åˆ°åŒ¹é…ç»“æœï¼Œå¿…é¡»æ”¾åœ¨å‰é¢æ‰å¯ä»¥ã€‚</p>
<h2 id="Unicodeå±æ€§ç±»"><a href="#Unicodeå±æ€§ç±»" class="headerlink" title="Unicodeå±æ€§ç±»"></a>Unicodeå±æ€§ç±»</h2><p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ª<a href="https://github.com/mathiasbynens/es-regexp-unicode-property-escapes" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œå¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³•<code>\p{...}</code>å’Œ<code>\P{...}</code>ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆUnicodeæŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> regexGreekSymbol = <span class="regexp">/\p&#123;Script=Greek&#125;/u</span>;</div><div class="line">regexGreekSymbol.test(<span class="string">'Ï€'</span>) <span class="comment">// u</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>\p{Script=Greek}</code>æŒ‡å®šåŒ¹é…ä¸€ä¸ªå¸Œè…Šæ–‡å­—æ¯ï¼Œæ‰€ä»¥åŒ¹é…<code>Ï€</code>æˆåŠŸã€‚</p>
<p>Unicodeå±æ€§ç±»è¦æŒ‡å®šå±æ€§åå’Œå±æ€§å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\p&#123;UnicodePropertyName=UnicodePropertyValue&#125;</div></pre></td></tr></table></figure>
<p>å¯¹äºæŸäº›å±æ€§ï¼Œå¯ä»¥åªå†™å±æ€§åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\p&#123;UnicodePropertyName&#125;</div></pre></td></tr></table></figure>
<p><code>\P{â€¦}</code>æ˜¯<code>\p{â€¦}</code>çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ä¸¤ç§ç±»åªå¯¹Unicodeæœ‰æ•ˆï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ã€‚å¦‚æœä¸åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨<code>\p</code>å’Œ<code>\P</code>ä¼šæŠ¥é”™ï¼ŒECMAScripté¢„ç•™äº†è¿™ä¸¤ä¸ªç±»ã€‚</p>
<p>ç”±äºUnicodeçš„å„ç§å±æ€§éå¸¸å¤šï¼Œæ‰€ä»¥è¿™ç§æ–°çš„ç±»çš„è¡¨è¾¾èƒ½åŠ›éå¸¸å¼ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> regex = <span class="regexp">/^\p&#123;Decimal_Number&#125;+$/u</span>;</div><div class="line">regex.test(<span class="string">'ğŸğŸğŸ‘ğŸœğŸğŸğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸºğŸ»ğŸ¼'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§ç±»æŒ‡å®šåŒ¹é…æ‰€æœ‰åè¿›åˆ¶å­—ç¬¦ï¼Œå¯ä»¥çœ‹åˆ°å„ç§å­—å‹çš„åè¿›åˆ¶å­—ç¬¦éƒ½ä¼šåŒ¹é…æˆåŠŸã€‚</p>
<p><code>\p{Number}</code>ç”šè‡³èƒ½åŒ¹é…ç½—é©¬æ•°å­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŒ¹é…æ‰€æœ‰æ•°å­—</span></div><div class="line"><span class="keyword">const</span> regex = <span class="regexp">/^\p&#123;Number&#125;+$/u</span>;</div><div class="line">regex.test(<span class="string">'Â²Â³Â¹Â¼Â½Â¾'</span>) <span class="comment">// true</span></div><div class="line">regex.test(<span class="string">'ã‰›ã‰œã‰'</span>) <span class="comment">// true</span></div><div class="line">regex.test(<span class="string">'â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å…¶ä»–ä¸€äº›ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰å­—æ¯ï¼Œç­‰åŒäºUnicodeç‰ˆçš„\w</span></div><div class="line">[\p&#123;Alphabetic&#125;\p&#123;Mark&#125;\p&#123;Decimal_Number&#125;\p&#123;Connector_Punctuation&#125;\p&#123;Join_Control&#125;]</div><div class="line"></div><div class="line"><span class="comment">// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰éå­—æ¯çš„å­—ç¬¦ï¼Œç­‰åŒäºUnicodeç‰ˆçš„\W</span></div><div class="line">[\p&#123;Alphabetic&#125;\p&#123;Mark&#125;\p&#123;Decimal_Number&#125;\p&#123;Connector_Punctuation&#125;\p&#123;Join_Control&#125;]</div><div class="line"></div><div class="line"><span class="comment">// åŒ¹é…æ‰€æœ‰çš„ç®­å¤´å­—ç¬¦</span></div><div class="line"><span class="keyword">const</span> regexArrows = <span class="regexp">/^\p&#123;Block=Arrows&#125;+$/u</span>;</div><div class="line">regexArrows.test(<span class="string">'â†â†‘â†’â†“â†”â†•â†–â†—â†˜â†™â‡â‡â‡‘â‡’â‡“â‡”â‡•â‡–â‡—â‡˜â‡™â‡§â‡©'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;RegExpæ„é€ å‡½æ•°&quot;&gt;&lt;a href=&quot;#RegExpæ„é€ å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;RegExpæ„é€ å‡½æ•°&quot;&gt;&lt;/a&gt;RegExpæ„é€ å‡½æ•°&lt;/h2&gt;&lt;p&gt;åœ¨ES5ä¸­ï¼ŒRegExpæ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; regex = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;RegExp&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;xyz&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;i&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ç­‰ä»·äº&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; regex = &lt;span class=&quot;regexp&quot;&gt;/xyz/i&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç¬¬äºŒç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; regex = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;RegExp&lt;/span&gt;(&lt;span class=&quot;regexp&quot;&gt;/xyz/i&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ç­‰ä»·äº&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; regex = &lt;span class=&quot;regexp&quot;&gt;/xyz/i&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½†æ˜¯ï¼ŒES5ä¸å…è®¸æ­¤æ—¶ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ·»åŠ ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; regex = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;RegExp&lt;/span&gt;(&lt;span class=&quot;regexp&quot;&gt;/xyz/&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;i&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Uncaught TypeError: Cannot supply flags when constructing one RegExp from another&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES6æ”¹å˜äº†è¿™ç§è¡Œä¸ºã€‚å¦‚æœRegExpæ„é€ å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¿®é¥°ç¬¦ã€‚è€Œä¸”ï¼Œè¿”å›çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥åŸæœ‰çš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼Œåªä½¿ç”¨æ–°æŒ‡å®šçš„ä¿®é¥°ç¬¦ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;RegExp&lt;/span&gt;(&lt;span class=&quot;regexp&quot;&gt;/abc/ig&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;i&#39;&lt;/span&gt;).flags&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &quot;i&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸæœ‰æ­£åˆ™å¯¹è±¡çš„ä¿®é¥°ç¬¦æ˜¯&lt;code&gt;ig&lt;/code&gt;ï¼Œå®ƒä¼šè¢«ç¬¬äºŒä¸ªå‚æ•°&lt;code&gt;i&lt;/code&gt;è¦†ç›–ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="ECMAScript 6" scheme="https://ailley.github.io/tags/ECMAScript-6/"/>
    
  </entry>
  
  <entry>
    <title>å­—ç¬¦ä¸²çš„æ‰©å±•</title>
    <link href="https://ailley.github.io/2016/10/25/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%89%A9%E5%B1%95/"/>
    <id>https://ailley.github.io/2016/10/25/å­—ç¬¦ä¸²çš„æ‰©å±•/</id>
    <published>2016-10-25T01:02:27.000Z</published>
    <updated>2016-10-25T01:03:21.886Z</updated>
    
    <content type="html"><![CDATA[<p>ES6åŠ å¼ºäº†å¯¹Unicodeçš„æ”¯æŒï¼Œå¹¶ä¸”æ‰©å±•äº†å­—ç¬¦ä¸²å¯¹è±¡ã€‚</p>
<h2 id="å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•"><a href="#å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•" class="headerlink" title="å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•"></a>å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•</h2><p>JavaScriptå…è®¸é‡‡ç”¨<code>\uxxxx</code>å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­â€œxxxxâ€è¡¨ç¤ºå­—ç¬¦çš„ç ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">"\u0061"</span></div><div class="line"><span class="comment">// "a"</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•åªé™äº<code>\u0000</code>â€”â€”<code>\uFFFF</code>ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨è¾¾ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">"\uD842\uDFB7"</span></div><div class="line"><span class="comment">// "ğ ®·"</span></div><div class="line"></div><div class="line"><span class="string">"\u20BB7"</span></div><div class="line"><span class="comment">// " 7"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨â€œ\uâ€åé¢è·Ÿä¸Šè¶…è¿‡<code>0xFFFF</code>çš„æ•°å€¼ï¼ˆæ¯”å¦‚<code>\u20BB7</code>ï¼‰ï¼ŒJavaScriptä¼šç†è§£æˆâ€œ\u20BB+7â€ã€‚ç”±äº<code>\u20BB</code>æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª7ã€‚</p>
<p>ES6å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="string">"\u&#123;20BB7&#125;"</span></div><div class="line"><span class="comment">// "ğ ®·"</span></div><div class="line"></div><div class="line"><span class="string">"\u&#123;41&#125;\u&#123;42&#125;\u&#123;43&#125;"</span></div><div class="line"><span class="comment">// "ABC"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> hello = <span class="number">123</span>;</div><div class="line">hell\u&#123;<span class="number">6</span>F&#125; <span class="comment">// 123</span></div><div class="line"></div><div class="line"><span class="string">'\u&#123;1F680&#125;'</span> === <span class="string">'\uD83D\uDE80'</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ªä¾‹å­è¡¨æ˜ï¼Œå¤§æ‹¬å·è¡¨ç¤ºæ³•ä¸å››å­—èŠ‚çš„UTF-16ç¼–ç æ˜¯ç­‰ä»·çš„ã€‚<br><a id="more"></a><br>æœ‰äº†è¿™ç§è¡¨ç¤ºæ³•ä¹‹åï¼ŒJavaScriptå…±æœ‰6ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\z'</span> === <span class="string">'z'</span>  <span class="comment">// true</span></div><div class="line"><span class="string">'\172'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div><div class="line"><span class="string">'\x7A'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div><div class="line"><span class="string">'\u007A'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div><div class="line"><span class="string">'\u&#123;7A&#125;'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h2 id="codePointAt"><a href="#codePointAt" class="headerlink" title="codePointAt()"></a>codePointAt()</h2><p>JavaScriptå†…éƒ¨ï¼Œå­—ç¬¦ä»¥UTF-16çš„æ ¼å¼å‚¨å­˜ï¼Œæ¯ä¸ªå­—ç¬¦å›ºå®šä¸º2ä¸ªå­—èŠ‚ã€‚å¯¹äºé‚£äº›éœ€è¦4ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼ˆUnicodeç ç‚¹å¤§äº0xFFFFçš„å­—ç¬¦ï¼‰ï¼ŒJavaScriptä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">"ğ ®·"</span>;</div><div class="line"></div><div class="line">s.length <span class="comment">// 2</span></div><div class="line">s.charAt(<span class="number">0</span>) <span class="comment">// ''</span></div><div class="line">s.charAt(<span class="number">1</span>) <span class="comment">// ''</span></div><div class="line">s.charCodeAt(<span class="number">0</span>) <span class="comment">// 55362</span></div><div class="line">s.charCodeAt(<span class="number">1</span>) <span class="comment">// 57271</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ±‰å­—â€œğ ®·â€çš„ç ç‚¹æ˜¯<code>0x20BB7</code>ï¼ŒUTF-16ç¼–ç ä¸º<code>0xD842 0xDFB7</code>ï¼ˆåè¿›åˆ¶ä¸º55362 57271ï¼‰ï¼Œéœ€è¦4ä¸ªå­—èŠ‚å‚¨å­˜ã€‚å¯¹äºè¿™ç§4ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScriptä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º2ï¼Œè€Œä¸”<code>charAt</code>æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼Œ<code>charCodeAt</code>æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚</p>
<p>ES6æä¾›äº†<code>codePointAt</code>æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç†4ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·a'</span>;</div><div class="line"></div><div class="line">s.codePointAt(<span class="number">0</span>) <span class="comment">// 134071</span></div><div class="line">s.codePointAt(<span class="number">1</span>) <span class="comment">// 57271</span></div><div class="line"></div><div class="line">s.charCodeAt(<span class="number">2</span>) <span class="comment">// 97</span></div></pre></td></tr></table></figure>
<p><code>codePointAt</code>æ–¹æ³•çš„å‚æ•°ï¼Œæ˜¯å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼ˆä»0å¼€å§‹ï¼‰ã€‚ä¸Šé¢ä»£ç ä¸­ï¼ŒJavaScriptå°†â€œğ ®·aâ€è§†ä¸ºä¸‰ä¸ªå­—ç¬¦ï¼ŒcodePointAtæ–¹æ³•åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸Šï¼Œæ­£ç¡®åœ°è¯†åˆ«äº†â€œğ ®·â€ï¼Œè¿”å›äº†å®ƒçš„åè¿›åˆ¶ç ç‚¹134071ï¼ˆå³åå…­è¿›åˆ¶çš„<code>20BB7</code>ï¼‰ã€‚åœ¨ç¬¬äºŒä¸ªå­—ç¬¦ï¼ˆå³â€œğ ®·â€çš„åä¸¤ä¸ªå­—èŠ‚ï¼‰å’Œç¬¬ä¸‰ä¸ªå­—ç¬¦â€œaâ€ä¸Šï¼Œ<code>codePointAt</code>æ–¹æ³•çš„ç»“æœä¸<code>charCodeAt</code>æ–¹æ³•ç›¸åŒã€‚</p>
<p>æ€»ä¹‹ï¼Œ<code>codePointAt</code>æ–¹æ³•ä¼šæ­£ç¡®è¿”å›32ä½çš„UTF-16å­—ç¬¦çš„ç ç‚¹ã€‚å¯¹äºé‚£äº›ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜çš„å¸¸è§„å­—ç¬¦ï¼Œå®ƒçš„è¿”å›ç»“æœä¸<code>charCodeAt</code>æ–¹æ³•ç›¸åŒã€‚</p>
<p><code>codePointAt</code>æ–¹æ³•è¿”å›çš„æ˜¯ç ç‚¹çš„åè¿›åˆ¶å€¼ï¼Œå¦‚æœæƒ³è¦åå…­è¿›åˆ¶çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>toString</code>æ–¹æ³•è½¬æ¢ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·a'</span>;</div><div class="line"></div><div class="line">s.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>) <span class="comment">// "20bb7"</span></div><div class="line">s.charCodeAt(<span class="number">2</span>).toString(<span class="number">16</span>) <span class="comment">// "61"</span></div></pre></td></tr></table></figure>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œ<code>codePointAt</code>æ–¹æ³•çš„å‚æ•°ï¼Œä»ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦<code>a</code>åœ¨å­—ç¬¦ä¸²<code>s</code>çš„æ­£ç¡®ä½ç½®åºå·åº”è¯¥æ˜¯1ï¼Œä½†æ˜¯å¿…é¡»å‘<code>charCodeAt</code>æ–¹æ³•ä¼ å…¥2ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨<code>for...of</code>å¾ªç¯ï¼Œå› ä¸ºå®ƒä¼šæ­£ç¡®è¯†åˆ«32ä½çš„UTF-16å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·a'</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> s) &#123;</div><div class="line">  <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</div><div class="line">&#125;</div><div class="line"><span class="comment">// 20bb7</span></div><div class="line"><span class="comment">// 61</span></div></pre></td></tr></table></figure>
<p><code>codePointAt</code>æ–¹æ³•æ˜¯æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯ç”±å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">is32Bit</span>(<span class="params">c</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> c.codePointAt(<span class="number">0</span>) &gt; <span class="number">0xFFFF</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">is32Bit(<span class="string">"ğ ®·"</span>) <span class="comment">// true</span></div><div class="line">is32Bit(<span class="string">"a"</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<h2 id="String-fromCodePoint"><a href="#String-fromCodePoint" class="headerlink" title="String.fromCodePoint()"></a>String.fromCodePoint()</h2><p>ES5æä¾›<code>String.fromCharCode</code>æ–¹æ³•ï¼Œç”¨äºä»ç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸èƒ½è¯†åˆ«32ä½çš„UTF-16å­—ç¬¦ï¼ˆUnicodeç¼–å·å¤§äº<code>0xFFFF</code>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.fromCharCode(<span class="number">0x20BB7</span>)</div><div class="line"><span class="comment">// "à®·"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>String.fromCharCode</code>ä¸èƒ½è¯†åˆ«å¤§äº<code>0xFFFF</code>çš„ç ç‚¹ï¼Œæ‰€ä»¥<code>0x20BB7</code>å°±å‘ç”Ÿäº†æº¢å‡ºï¼Œæœ€é«˜ä½<code>2</code>è¢«èˆå¼ƒäº†ï¼Œæœ€åè¿”å›ç ç‚¹<code>U+0BB7</code>å¯¹åº”çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯ç ç‚¹<code>U+20BB7</code>å¯¹åº”çš„å­—ç¬¦ã€‚</p>
<p>ES6æä¾›äº†<code>String.fromCodePoint</code>æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«<code>0xFFFF</code>çš„å­—ç¬¦ï¼Œå¼¥è¡¥äº†<code>String.fromCharCode</code>æ–¹æ³•çš„ä¸è¶³ã€‚åœ¨ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸<code>codePointAt</code>æ–¹æ³•ç›¸åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>)</div><div class="line"><span class="comment">// "ğ ®·"</span></div><div class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>String.fromCodePoint</code>æ–¹æ³•æœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™å®ƒä»¬ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿”å›ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>fromCodePoint</code>æ–¹æ³•å®šä¹‰åœ¨<code>String</code>å¯¹è±¡ä¸Šï¼Œè€Œ<code>codePointAt</code>æ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚</p>
<h2 id="å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£"><a href="#å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£" class="headerlink" title="å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£"></a>å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£</h2><p>ES6ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼ˆè¯¦è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢«<code>for...of</code>å¾ªç¯éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> codePoint <span class="keyword">of</span> <span class="string">'foo'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(codePoint)</div><div class="line">&#125;</div><div class="line"><span class="comment">// "f"</span></div><div class="line"><span class="comment">// "o"</span></div><div class="line"><span class="comment">// "o"</span></div></pre></td></tr></table></figure>
<p>é™¤äº†éå†å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªéå†å™¨æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¯†åˆ«å¤§äº<code>0xFFFF</code>çš„ç ç‚¹ï¼Œä¼ ç»Ÿçš„<code>for</code>å¾ªç¯æ— æ³•è¯†åˆ«è¿™æ ·çš„ç ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> text = <span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; text.length; i++) &#123;</div><div class="line">  <span class="built_in">console</span>.log(text[i]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// " "</span></div><div class="line"><span class="comment">// " "</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> text) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "ğ ®·"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²<code>text</code>åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯<code>for</code>å¾ªç¯ä¼šè®¤ä¸ºå®ƒåŒ…å«ä¸¤ä¸ªå­—ç¬¦ï¼ˆéƒ½ä¸å¯æ‰“å°ï¼‰ï¼Œè€Œ<code>for...of</code>å¾ªç¯ä¼šæ­£ç¡®è¯†åˆ«å‡ºè¿™ä¸€ä¸ªå­—ç¬¦ã€‚</p>
<h2 id="at"><a href="#at" class="headerlink" title="at()"></a>at()</h2><p>ES5å¯¹å­—ç¬¦ä¸²å¯¹è±¡æä¾›<code>charAt</code>æ–¹æ³•ï¼Œè¿”å›å­—ç¬¦ä¸²ç»™å®šä½ç½®çš„å­—ç¬¦ã€‚è¯¥æ–¹æ³•ä¸èƒ½è¯†åˆ«ç ç‚¹å¤§äº<code>0xFFFF</code>çš„å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'abc'</span>.charAt(<span class="number">0</span>) <span class="comment">// "a"</span></div><div class="line"><span class="string">'ğ ®·'</span>.charAt(<span class="number">0</span>) <span class="comment">// "\uD842"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>charAt</code>æ–¹æ³•è¿”å›çš„æ˜¯UTF-16ç¼–ç çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå®é™…ä¸Šæ˜¯æ— æ³•æ˜¾ç¤ºçš„ã€‚</p>
<p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºå­—ç¬¦ä¸²å®ä¾‹çš„<code>at</code>æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«Unicodeç¼–å·å¤§äº<code>0xFFFF</code>çš„å­—ç¬¦ï¼Œè¿”å›æ­£ç¡®çš„å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'abc'</span>.at(<span class="number">0</span>) <span class="comment">// "a"</span></div><div class="line"><span class="string">'ğ ®·'</span>.at(<span class="number">0</span>) <span class="comment">// "ğ ®·"</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡<a href="https://github.com/es-shims/String.prototype.at" target="_blank" rel="external">å«ç‰‡åº“</a>å®ç°ã€‚</p>
<h2 id="normalize"><a href="#normalize" class="headerlink" title="normalize()"></a>normalize()</h2><p>è®¸å¤šæ¬§æ´²è¯­è¨€æœ‰è¯­è°ƒç¬¦å·å’Œé‡éŸ³ç¬¦å·ã€‚ä¸ºäº†è¡¨ç¤ºå®ƒä»¬ï¼ŒUnicodeæä¾›äº†ä¸¤ç§æ–¹æ³•ã€‚ä¸€ç§æ˜¯ç›´æ¥æä¾›å¸¦é‡éŸ³ç¬¦å·çš„å­—ç¬¦ï¼Œæ¯”å¦‚<code>Ç‘</code>ï¼ˆ\u01D1ï¼‰ã€‚å¦ä¸€ç§æ˜¯æä¾›åˆæˆç¬¦å·ï¼ˆcombining characterï¼‰ï¼Œå³åŸå­—ç¬¦ä¸é‡éŸ³ç¬¦å·çš„åˆæˆï¼Œä¸¤ä¸ªå­—ç¬¦åˆæˆä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚<code>O</code>ï¼ˆ\u004Fï¼‰å’Œ<code>Ë‡</code>ï¼ˆ\u030Cï¼‰åˆæˆ<code>Ç‘</code>ï¼ˆ\u004F\u030Cï¼‰ã€‚</p>
<p>è¿™ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œåœ¨è§†è§‰å’Œè¯­ä¹‰ä¸Šéƒ½ç­‰ä»·ï¼Œä½†æ˜¯JavaScriptä¸èƒ½è¯†åˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\u01D1'</span>===<span class="string">'\u004F\u030C'</span> <span class="comment">//false</span></div><div class="line"></div><div class="line"><span class="string">'\u01D1'</span>.length <span class="comment">// 1</span></div><div class="line"><span class="string">'\u004F\u030C'</span>.length <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼ŒJavaScriptå°†åˆæˆå­—ç¬¦è§†ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ä¸ç›¸ç­‰ã€‚</p>
<p>ES6æä¾›å­—ç¬¦ä¸²å®ä¾‹çš„<code>normalize()</code>æ–¹æ³•ï¼Œç”¨æ¥å°†å­—ç¬¦çš„ä¸åŒè¡¨ç¤ºæ–¹æ³•ç»Ÿä¸€ä¸ºåŒæ ·çš„å½¢å¼ï¼Œè¿™ç§°ä¸ºUnicodeæ­£è§„åŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\u01D1'</span>.normalize() === <span class="string">'\u004F\u030C'</span>.normalize()</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p><code>normalize</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°æ¥æŒ‡å®š<code>normalize</code>çš„æ–¹å¼ï¼Œå‚æ•°çš„å››ä¸ªå¯é€‰å€¼å¦‚ä¸‹ã€‚</p>
<ul>
<li><code>NFC</code>ï¼Œé»˜è®¤å‚æ•°ï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Canonical Compositionï¼‰ï¼Œè¿”å›å¤šä¸ªç®€å•å­—ç¬¦çš„åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œæ ‡å‡†ç­‰ä»·â€æŒ‡çš„æ˜¯è§†è§‰å’Œè¯­ä¹‰ä¸Šçš„ç­‰ä»·ã€‚</li>
<li><code>NFD</code>ï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Canonical Decompositionï¼‰ï¼Œå³åœ¨æ ‡å‡†ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚</li>
<li><code>NFKC</code>ï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Compatibility Compositionï¼‰ï¼Œè¿”å›åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œå…¼å®¹ç­‰ä»·â€æŒ‡çš„æ˜¯è¯­ä¹‰ä¸Šå­˜åœ¨ç­‰ä»·ï¼Œä½†è§†è§‰ä¸Šä¸ç­‰ä»·ï¼Œæ¯”å¦‚â€œå›â€å’Œâ€œå–œå–œâ€ã€‚ï¼ˆè¿™åªæ˜¯ç”¨æ¥ä¸¾ä¾‹ï¼Œ<code>normalize</code>æ–¹æ³•ä¸èƒ½è¯†åˆ«ä¸­æ–‡ã€‚ï¼‰</li>
<li><code>NFKD</code>ï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Compatibility Decompositionï¼‰ï¼Œå³åœ¨å…¼å®¹ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\u004F\u030C'</span>.normalize(<span class="string">'NFC'</span>).length <span class="comment">// 1</span></div><div class="line"><span class="string">'\u004F\u030C'</span>.normalize(<span class="string">'NFD'</span>).length <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ<code>NFC</code>å‚æ•°è¿”å›å­—ç¬¦çš„åˆæˆå½¢å¼ï¼Œ<code>NFD</code>å‚æ•°è¿”å›å­—ç¬¦çš„åˆ†è§£å½¢å¼ã€‚</p>
<p>ä¸è¿‡ï¼Œ<code>normalize</code>æ–¹æ³•ç›®å‰ä¸èƒ½è¯†åˆ«ä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Šå­—ç¬¦çš„åˆæˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯åªèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šè¿‡Unicodeç¼–å·åŒºé—´åˆ¤æ–­ã€‚</p>
<h2 id="includes-startsWith-endsWith"><a href="#includes-startsWith-endsWith" class="headerlink" title="includes(), startsWith(), endsWith()"></a>includes(), startsWith(), endsWith()</h2><p>ä¼ ç»Ÿä¸Šï¼ŒJavaScriptåªæœ‰<code>indexOf</code>æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ES6åˆæä¾›äº†ä¸‰ç§æ–°æ–¹æ³•ã€‚</p>
<ul>
<li><strong>includes()</strong>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²ã€‚</li>
<li><strong>startsWith()</strong>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨æºå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚</li>
<li><strong>endsWith()</strong>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨æºå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</div><div class="line"></div><div class="line">s.startsWith(<span class="string">'Hello'</span>) <span class="comment">// true</span></div><div class="line">s.endsWith(<span class="string">'!'</span>) <span class="comment">// true</span></div><div class="line">s.includes(<span class="string">'o'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹æœç´¢çš„ä½ç½®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</div><div class="line"></div><div class="line">s.startsWith(<span class="string">'world'</span>, <span class="number">6</span>) <span class="comment">// true</span></div><div class="line">s.endsWith(<span class="string">'Hello'</span>, <span class="number">5</span>) <span class="comment">// true</span></div><div class="line">s.includes(<span class="string">'Hello'</span>, <span class="number">6</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°<code>n</code>æ—¶ï¼Œ<code>endsWith</code>çš„è¡Œä¸ºä¸å…¶ä»–ä¸¤ä¸ªæ–¹æ³•æœ‰æ‰€ä¸åŒã€‚å®ƒé’ˆå¯¹å‰<code>n</code>ä¸ªå­—ç¬¦ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•é’ˆå¯¹ä»ç¬¬<code>n</code>ä¸ªä½ç½®ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚</p>
<h2 id="repeat"><a href="#repeat" class="headerlink" title="repeat()"></a>repeat()</h2><p><code>repeat</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤<code>n</code>æ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x'</span>.repeat(<span class="number">3</span>) <span class="comment">// "xxx"</span></div><div class="line"><span class="string">'hello'</span>.repeat(<span class="number">2</span>) <span class="comment">// "hellohello"</span></div><div class="line"><span class="string">'na'</span>.repeat(<span class="number">0</span>) <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>å‚æ•°å¦‚æœæ˜¯å°æ•°ï¼Œä¼šè¢«å–æ•´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="number">2.9</span>) <span class="comment">// "nana"</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>repeat</code>çš„å‚æ•°æ˜¯è´Ÿæ•°æˆ–è€…<code>Infinity</code>ï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="literal">Infinity</span>)</div><div class="line"><span class="comment">// RangeError</span></div><div class="line"><span class="string">'na'</span>.repeat(<span class="number">-1</span>)</div><div class="line"><span class="comment">// RangeError</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¦‚æœå‚æ•°æ˜¯0åˆ°-1ä¹‹é—´çš„å°æ•°ï¼Œåˆ™ç­‰åŒäº0ï¼Œè¿™æ˜¯å› ä¸ºä¼šå…ˆè¿›è¡Œå–æ•´è¿ç®—ã€‚0åˆ°-1ä¹‹é—´çš„å°æ•°ï¼Œå–æ•´ä»¥åç­‰äº<code>-0</code>ï¼Œ<code>repeat</code>è§†åŒä¸º0ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="number">-0.9</span>) <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>å‚æ•°<code>NaN</code>ç­‰åŒäº0ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="literal">NaN</span>) <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>repeat</code>çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå…ˆè½¬æ¢æˆæ•°å­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="string">'na'</span>) <span class="comment">// ""</span></div><div class="line"><span class="string">'na'</span>.repeat(<span class="string">'3'</span>) <span class="comment">// "nanana"</span></div></pre></td></tr></table></figure>
<h2 id="padStart-ï¼ŒpadEnd"><a href="#padStart-ï¼ŒpadEnd" class="headerlink" title="padStart()ï¼ŒpadEnd()"></a>padStart()ï¼ŒpadEnd()</h2><p>ES7æ¨å‡ºäº†å­—ç¬¦ä¸²è¡¥å…¨é•¿åº¦çš„åŠŸèƒ½ã€‚å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚<code>padStart</code>ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼Œ<code>padEnd</code>ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x'</span>.padStart(<span class="number">5</span>, <span class="string">'ab'</span>) <span class="comment">// 'ababx'</span></div><div class="line"><span class="string">'x'</span>.padStart(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'abax'</span></div><div class="line"></div><div class="line"><span class="string">'x'</span>.padEnd(<span class="number">5</span>, <span class="string">'ab'</span>) <span class="comment">// 'xabab'</span></div><div class="line"><span class="string">'x'</span>.padEnd(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'xaba'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>padStart</code>å’Œ<code>padEnd</code>ä¸€å…±æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šå­—ç¬¦ä¸²çš„æœ€å°é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœåŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºæˆ–å¤§äºæŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'xxx'</span>.padStart(<span class="number">2</span>, <span class="string">'ab'</span>) <span class="comment">// 'xxx'</span></div><div class="line"><span class="string">'xxx'</span>.padEnd(<span class="number">2</span>, <span class="string">'ab'</span>) <span class="comment">// 'xxx'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ä¸åŸå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºä½æ•°çš„è¡¥å…¨å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'abc'</span>.padStart(<span class="number">10</span>, <span class="string">'0123456789'</span>)</div><div class="line"><span class="comment">// '0123456abc'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™ä¼šç”¨ç©ºæ ¼è¡¥å…¨é•¿åº¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x'</span>.padStart(<span class="number">4</span>) <span class="comment">// '   x'</span></div><div class="line"><span class="string">'x'</span>.padEnd(<span class="number">4</span>) <span class="comment">// 'x   '</span></div></pre></td></tr></table></figure>
<p><code>padStart</code>çš„å¸¸è§ç”¨é€”æ˜¯ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•°ã€‚ä¸‹é¢ä»£ç ç”Ÿæˆ10ä½çš„æ•°å€¼å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">'1'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000001"</span></div><div class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000012"</span></div><div class="line"><span class="string">'123456'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000123456"</span></div></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªç”¨é€”æ˜¯æç¤ºå­—ç¬¦ä¸²æ ¼å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-MM-12"</span></div><div class="line"><span class="string">'09-12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-09-12"</span></div></pre></td></tr></table></figure>
<h2 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h2><p>ä¼ ç»Ÿçš„JavaScriptè¯­è¨€ï¼Œè¾“å‡ºæ¨¡æ¿é€šå¸¸æ˜¯è¿™æ ·å†™çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#result'</span>).append(</div><div class="line">  <span class="string">'There are &lt;b&gt;'</span> + basket.count + <span class="string">'&lt;/b&gt; '</span> +</div><div class="line">  <span class="string">'items in your basket, '</span> +</div><div class="line">  <span class="string">'&lt;em&gt;'</span> + basket.onSale +</div><div class="line">  <span class="string">'&lt;/em&gt; are on sale!'</span></div><div class="line">);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ç§å†™æ³•ç›¸å½“ç¹çä¸æ–¹ä¾¿ï¼ŒES6å¼•å…¥äº†æ¨¡æ¿å­—ç¬¦ä¸²è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#result'</span>).append(<span class="string">`</span></div><div class="line">  There are &lt;b&gt;<span class="subst">$&#123;basket.count&#125;</span>&lt;/b&gt; items</div><div class="line">   in your basket, &lt;em&gt;<span class="subst">$&#123;basket.onSale&#125;</span>&lt;/em&gt;</div><div class="line">  are on sale!</div><div class="line">`);</div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ&#96;ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ™®é€šå­—ç¬¦ä¸²</span></div><div class="line"><span class="string">`In JavaScript '\n' is a line-feed.`</span></div><div class="line"></div><div class="line"><span class="comment">// å¤šè¡Œå­—ç¬¦ä¸²</span></div><div class="line"><span class="string">`In JavaScript this is</span></div><div class="line"> not legal.`</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`string text line 1</span></div><div class="line">string text line 2`);</div><div class="line"></div><div class="line"><span class="comment">// å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡</span></div><div class="line"><span class="keyword">var</span> name = <span class="string">"Bob"</span>, time = <span class="string">"today"</span>;</div><div class="line"><span class="string">`Hello <span class="subst">$&#123;name&#125;</span>, how are you <span class="subst">$&#123;time&#125;</span>?`</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œéƒ½æ˜¯ç”¨åå¼•å·è¡¨ç¤ºã€‚å¦‚æœåœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­éœ€è¦ä½¿ç”¨åå¼•å·ï¼Œåˆ™å‰é¢è¦ç”¨åæ–œæ è½¬ä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> greeting = <span class="string">`\`Yo\` World!`</span>;</div></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œæ‰€æœ‰çš„ç©ºæ ¼å’Œç¼©è¿›éƒ½ä¼šè¢«ä¿ç•™åœ¨è¾“å‡ºä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#list'</span>).html(<span class="string">`</span></div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;li&gt;first&lt;/li&gt;</div><div class="line">  &lt;li&gt;second&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">`);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰€æœ‰æ¨¡æ¿å­—ç¬¦ä¸²çš„ç©ºæ ¼å’Œæ¢è¡Œï¼Œéƒ½æ˜¯è¢«ä¿ç•™çš„ï¼Œæ¯”å¦‚<code>&lt;ul&gt;</code>æ ‡ç­¾å‰é¢ä¼šæœ‰ä¸€ä¸ªæ¢è¡Œã€‚å¦‚æœä½ ä¸æƒ³è¦è¿™ä¸ªæ¢è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>trim</code>æ–¹æ³•æ¶ˆé™¤å®ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#list'</span>).html(<span class="string">`</span></div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;li&gt;first&lt;/li&gt;</div><div class="line">  &lt;li&gt;second&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">`.trim());</div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ï¼Œéœ€è¦å°†å˜é‡åå†™åœ¨<code>${}</code>ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">authorize</span>(<span class="params">user, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!user.hasPrivilege(action)) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">      <span class="comment">// ä¼ ç»Ÿå†™æ³•ä¸º</span></div><div class="line">      <span class="comment">// 'User '</span></div><div class="line">      <span class="comment">// + user.name</span></div><div class="line">      <span class="comment">// + ' is not authorized to do '</span></div><div class="line">      <span class="comment">// + action</span></div><div class="line">      <span class="comment">// + '.'</span></div><div class="line">      <span class="string">`User <span class="subst">$&#123;user.name&#125;</span> is not authorized to do <span class="subst">$&#123;action&#125;</span>.`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¤§æ‹¬å·å†…éƒ¨å¯ä»¥æ”¾å…¥ä»»æ„çš„JavaScriptè¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> y = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="string">`<span class="subst">$&#123;x&#125;</span> + <span class="subst">$&#123;y&#125;</span> = <span class="subst">$&#123;x + y&#125;</span>`</span></div><div class="line"><span class="comment">// "1 + 2 = 3"</span></div><div class="line"></div><div class="line"><span class="string">`<span class="subst">$&#123;x&#125;</span> + <span class="subst">$&#123;y * <span class="number">2</span>&#125;</span> = <span class="subst">$&#123;x + y * <span class="number">2</span>&#125;</span>`</span></div><div class="line"><span class="comment">// "1 + 4 = 5"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;;</div><div class="line"><span class="string">`<span class="subst">$&#123;obj.x + obj.y&#125;</span>`</span></div><div class="line"><span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­è¿˜èƒ½è°ƒç”¨å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">"Hello World"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="string">`foo <span class="subst">$&#123;fn()&#125;</span> bar`</span></div><div class="line"><span class="comment">// foo Hello World bar</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå¤§æ‹¬å·ä¸­çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå°†æŒ‰ç…§ä¸€èˆ¬çš„è§„åˆ™è½¬ä¸ºå­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼Œå¤§æ‹¬å·ä¸­æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°†é»˜è®¤è°ƒç”¨å¯¹è±¡çš„<code>toString</code>æ–¹æ³•ã€‚</p>
<p>å¦‚æœæ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„å˜é‡æ²¡æœ‰å£°æ˜ï¼Œå°†æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å˜é‡placeæ²¡æœ‰å£°æ˜</span></div><div class="line"><span class="keyword">var</span> msg = <span class="string">`Hello, <span class="subst">$&#123;place&#125;</span>`</span>;</div><div class="line"><span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ç”±äºæ¨¡æ¿å­—ç¬¦ä¸²çš„å¤§æ‹¬å·å†…éƒ¨ï¼Œå°±æ˜¯æ‰§è¡ŒJavaScriptä»£ç ï¼Œå› æ­¤å¦‚æœå¤§æ‹¬å·å†…éƒ¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°†ä¼šåŸæ ·è¾“å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">`Hello <span class="subst">$&#123;<span class="string">'World'</span>&#125;</span>`</span></div><div class="line"><span class="comment">// "Hello World"</span></div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ç”šè‡³è¿˜èƒ½åµŒå¥—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> tmpl = <span class="function"><span class="params">addrs</span> =&gt;</span> <span class="string">`</span></div><div class="line">  &lt;table&gt;</div><div class="line">  <span class="subst">$&#123;addrs.map(addr =&gt; <span class="string">`</span></span></div><div class="line">    &lt;tr&gt;&lt;td&gt;<span class="subst">$&#123;addr.first&#125;</span>&lt;/td&gt;&lt;/tr&gt;</div><div class="line">    &lt;tr&gt;&lt;td&gt;<span class="subst">$&#123;addr.last&#125;</span>&lt;/td&gt;&lt;/tr&gt;</div><div class="line">  `).join(<span class="string">''</span>)&#125;</div><div class="line">  &lt;/table&gt;</div><div class="line">`;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²çš„å˜é‡ä¹‹ä¸­ï¼ŒåˆåµŒå…¥äº†å¦ä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = [</div><div class="line">    &#123; <span class="attr">first</span>: <span class="string">'&lt;Jane&gt;'</span>, <span class="attr">last</span>: <span class="string">'Bond'</span> &#125;,</div><div class="line">    &#123; <span class="attr">first</span>: <span class="string">'Lars'</span>, <span class="attr">last</span>: <span class="string">'&lt;Croft&gt;'</span> &#125;,</div><div class="line">];</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(tmpl(data));</div><div class="line"><span class="comment">// &lt;table&gt;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;&lt;Jane&gt;&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;Bond&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;Lars&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;&lt;Croft&gt;&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// &lt;/table&gt;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦å¼•ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«ï¼Œåœ¨éœ€è¦æ—¶æ‰§è¡Œï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å†™æ³•ä¸€</span></div><div class="line"><span class="keyword">let</span> str = <span class="string">'return '</span> + <span class="string">'`Hello $&#123;name&#125;!`'</span>;</div><div class="line"><span class="keyword">let</span> func = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">'name'</span>, str);</div><div class="line">func(<span class="string">'Jack'</span>) <span class="comment">// "Hello Jack!"</span></div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•äºŒ</span></div><div class="line"><span class="keyword">let</span> str = <span class="string">'(name) =&gt; `Hello $&#123;name&#125;!`'</span>;</div><div class="line"><span class="keyword">let</span> func = <span class="built_in">eval</span>.call(<span class="literal">null</span>, str);</div><div class="line">func(<span class="string">'Jack'</span>) <span class="comment">// "Hello Jack!"</span></div></pre></td></tr></table></figure>
<h2 id="å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘"><a href="#å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘" class="headerlink" title="å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘"></a>å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘</h2><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”Ÿæˆæ­£å¼æ¨¡æ¿çš„å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> template = <span class="string">`</span></div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;% for(var i=0; i &lt; data.supplies.length; i++) &#123; %&gt;</div><div class="line">    &lt;li&gt;&lt;%= data.supplies[i] %&gt;&lt;/li&gt;</div><div class="line">  &lt;% &#125; %&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">`;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œæ”¾ç½®äº†ä¸€ä¸ªå¸¸è§„æ¨¡æ¿ã€‚è¯¥æ¨¡æ¿ä½¿ç”¨<code>&lt;%...%&gt;</code>æ”¾ç½®JavaScriptä»£ç ï¼Œä½¿ç”¨<code>&lt;%= ... %&gt;</code>è¾“å‡ºJavaScriptè¡¨è¾¾å¼ã€‚</p>
<p>æ€ä¹ˆç¼–è¯‘è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²å‘¢ï¼Ÿ</p>
<p>ä¸€ç§æ€è·¯æ˜¯å°†å…¶è½¬æ¢ä¸ºJavaScriptè¡¨è¾¾å¼å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">echo(<span class="string">'&lt;ul&gt;'</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; data.supplies.length; i++) &#123;</div><div class="line">  echo(<span class="string">'&lt;li&gt;'</span>);</div><div class="line">  echo(data.supplies[i]);</div><div class="line">  echo(<span class="string">'&lt;/li&gt;'</span>);</div><div class="line">&#125;;</div><div class="line">echo(<span class="string">'&lt;/ul&gt;'</span>);</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªè½¬æ¢ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°±è¡Œäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> evalExpr = <span class="regexp">/&lt;%=(.+?)%&gt;/g</span>;</div><div class="line"><span class="keyword">var</span> expr = <span class="regexp">/&lt;%([\s\S]+?)%&gt;/g</span>;</div><div class="line"></div><div class="line">template = template</div><div class="line">  .replace(evalExpr, <span class="string">'`); \n  echo( $1 ); \n  echo(`'</span>)</div><div class="line">  .replace(expr, <span class="string">'`); \n $1 \n  echo(`'</span>);</div><div class="line"></div><div class="line">template = <span class="string">'echo(`'</span> + template + <span class="string">'`);'</span>;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°†<code>template</code>å°è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢è¿”å›ï¼Œå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> script =</div><div class="line"><span class="string">`(function parse(data)&#123;</span></div><div class="line">  var output = "";</div><div class="line"></div><div class="line">  function echo(html)&#123;</div><div class="line">    output += html;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="subst">$&#123; template &#125;</span></div><div class="line"></div><div class="line">  return output;</div><div class="line">&#125;)`;</div><div class="line"></div><div class="line"><span class="keyword">return</span> script;</div></pre></td></tr></table></figure>
<p>å°†ä¸Šé¢çš„å†…å®¹æ‹¼è£…æˆä¸€ä¸ªæ¨¡æ¿ç¼–è¯‘å‡½æ•°<code>compile</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">compile</span>(<span class="params">template</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> evalExpr = <span class="regexp">/&lt;%=(.+?)%&gt;/g</span>;</div><div class="line">  <span class="keyword">var</span> expr = <span class="regexp">/&lt;%([\s\S]+?)%&gt;/g</span>;</div><div class="line"></div><div class="line">  template = template</div><div class="line">    .replace(evalExpr, <span class="string">'`); \n  echo( $1 ); \n  echo(`'</span>)</div><div class="line">    .replace(expr, <span class="string">'`); \n $1 \n  echo(`'</span>);</div><div class="line"></div><div class="line">  template = <span class="string">'echo(`'</span> + template + <span class="string">'`);'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> script =</div><div class="line">  <span class="string">`(function parse(data)&#123;</span></div><div class="line">    var output = "";</div><div class="line"></div><div class="line">    function echo(html)&#123;</div><div class="line">      output += html;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="subst">$&#123; template &#125;</span></div><div class="line"></div><div class="line">    return output;</div><div class="line">  &#125;)`;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> script;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>compile</code>å‡½æ•°çš„ç”¨æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> parse = <span class="built_in">eval</span>(compile(template));</div><div class="line">div.innerHTML = parse(&#123; <span class="attr">supplies</span>: [ <span class="string">"broom"</span>, <span class="string">"mop"</span>, <span class="string">"cleaner"</span> ] &#125;);</div><div class="line"><span class="comment">//   &lt;ul&gt;</span></div><div class="line"><span class="comment">//     &lt;li&gt;broom&lt;/li&gt;</span></div><div class="line"><span class="comment">//     &lt;li&gt;mop&lt;/li&gt;</span></div><div class="line"><span class="comment">//     &lt;li&gt;cleaner&lt;/li&gt;</span></div><div class="line"><span class="comment">//   &lt;/ul&gt;</span></div></pre></td></tr></table></figure>
<h2 id="æ ‡ç­¾æ¨¡æ¿"><a href="#æ ‡ç­¾æ¨¡æ¿" class="headerlink" title="æ ‡ç­¾æ¨¡æ¿"></a>æ ‡ç­¾æ¨¡æ¿</h2><p>æ¨¡æ¿å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ä¸Šé¢è¿™äº›ã€‚å®ƒå¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">alert<span class="string">`123`</span></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">alert(<span class="number">123</span>)</div></pre></td></tr></table></figure>
<p>æ ‡ç­¾æ¨¡æ¿å…¶å®ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚â€œæ ‡ç­¾â€æŒ‡çš„å°±æ˜¯å‡½æ•°ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„å‚æ•°ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">10</span>;</div><div class="line"></div><div class="line">tag<span class="string">`Hello <span class="subst">$&#123; a + b &#125;</span> world <span class="subst">$&#123; a * b &#125;</span>`</span>;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">tag([<span class="string">'Hello '</span>, <span class="string">' world '</span>, <span class="string">''</span>], <span class="number">15</span>, <span class="number">50</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å‰é¢æœ‰ä¸€ä¸ªæ ‡è¯†å<code>tag</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯<code>tag</code>å‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚</p>
<p>å‡½æ•°<code>tag</code>ä¾æ¬¡ä¼šæ¥æ”¶åˆ°å¤šä¸ªå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">stringArr, value1, value2</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">stringArr, ...values</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>tag</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ä¸­é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå˜é‡æ›¿æ¢åªå‘ç”Ÿåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ä¸ç¬¬äºŒä¸ªæˆå‘˜ä¹‹é—´ã€ç¬¬äºŒä¸ªæˆå‘˜ä¸ç¬¬ä¸‰ä¸ªæˆå‘˜ä¹‹é—´ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p><code>tag</code>å‡½æ•°çš„å…¶ä»–å‚æ•°ï¼Œéƒ½æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²å„ä¸ªå˜é‡è¢«æ›¿æ¢åçš„å€¼ã€‚ç”±äºæœ¬ä¾‹ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å«æœ‰ä¸¤ä¸ªå˜é‡ï¼Œå› æ­¤<code>tag</code>ä¼šæ¥å—åˆ°<code>value1</code>å’Œ<code>value2</code>ä¸¤ä¸ªå‚æ•°ã€‚</p>
<p><code>tag</code>å‡½æ•°æ‰€æœ‰å‚æ•°çš„å®é™…å€¼å¦‚ä¸‹ã€‚</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<code>[&#39;Hello &#39;, &#39; world &#39;, &#39;&#39;]</code></li>
<li>ç¬¬äºŒä¸ªå‚æ•°: 15</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š50</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>tag</code>å‡½æ•°å®é™…ä¸Šä»¥ä¸‹é¢çš„å½¢å¼è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tag([<span class="string">'Hello '</span>, <span class="string">' world '</span>, <span class="string">''</span>], <span class="number">15</span>, <span class="number">50</span>)</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥æŒ‰ç…§éœ€è¦ç¼–å†™<code>tag</code>å‡½æ•°çš„ä»£ç ã€‚ä¸‹é¢æ˜¯<code>tag</code>å‡½æ•°çš„ä¸€ç§å†™æ³•ï¼Œä»¥åŠè¿è¡Œç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">s, v1, v2</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(s[<span class="number">0</span>]);</div><div class="line">  <span class="built_in">console</span>.log(s[<span class="number">1</span>]);</div><div class="line">  <span class="built_in">console</span>.log(s[<span class="number">2</span>]);</div><div class="line">  <span class="built_in">console</span>.log(v1);</div><div class="line">  <span class="built_in">console</span>.log(v2);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="string">"OK"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">tag<span class="string">`Hello <span class="subst">$&#123; a + b &#125;</span> world <span class="subst">$&#123; a * b&#125;</span>`</span>;</div><div class="line"><span class="comment">// "Hello "</span></div><div class="line"><span class="comment">// " world "</span></div><div class="line"><span class="comment">// ""</span></div><div class="line"><span class="comment">// 15</span></div><div class="line"><span class="comment">// 50</span></div><div class="line"><span class="comment">// "OK"</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> total = <span class="number">30</span>;</div><div class="line"><span class="keyword">var</span> msg = passthru<span class="string">`The total is <span class="subst">$&#123;total&#125;</span> (<span class="subst">$&#123;total*<span class="number">1.05</span>&#125;</span> with tax)`</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">passthru</span>(<span class="params">literals</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> result = <span class="string">''</span>;</div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">while</span> (i &lt; literals.length) &#123;</div><div class="line">    result += literals[i++];</div><div class="line">    <span class="keyword">if</span> (i &lt; <span class="built_in">arguments</span>.length) &#123;</div><div class="line">      result += <span class="built_in">arguments</span>[i];</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line">msg <span class="comment">// "The total is 30 (31.5 with tax)"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ï¼Œå¦‚ä½•å°†å„ä¸ªå‚æ•°æŒ‰ç…§åŸæ¥çš„ä½ç½®æ‹¼åˆå›å»ã€‚</p>
<p><code>passthru</code>å‡½æ•°é‡‡ç”¨restå‚æ•°çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">passthru</span>(<span class="params">literals, ...values</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> output = <span class="string">""</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; values.length; index++) &#123;</div><div class="line">    output += literals[index] + values[index];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  output += literals[index]</div><div class="line">  <span class="keyword">return</span> output;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>â€œæ ‡ç­¾æ¨¡æ¿â€çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå°±æ˜¯è¿‡æ»¤HTMLå­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> message =</div><div class="line">  SaferHTML<span class="string">`&lt;p&gt;<span class="subst">$&#123;sender&#125;</span> has sent you a message.&lt;/p&gt;`</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SaferHTML</span>(<span class="params">templateData</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> s = templateData[<span class="number">0</span>];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> arg = <span class="built_in">String</span>(<span class="built_in">arguments</span>[i]);</div><div class="line"></div><div class="line">    <span class="comment">// Escape special characters in the substitution.</span></div><div class="line">    s += arg.replace(<span class="regexp">/&amp;/g</span>, <span class="string">"&amp;amp;"</span>)</div><div class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">"&amp;lt;"</span>)</div><div class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">"&amp;gt;"</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Don't escape special characters in the template.</span></div><div class="line">    s += templateData[i];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> s;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>sender</code>å˜é‡å¾€å¾€æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œç»è¿‡<code>SaferHTML</code>å‡½æ•°å¤„ç†ï¼Œé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sender = <span class="string">'&lt;script&gt;alert("abc")&lt;/script&gt;'</span>; <span class="comment">// æ¶æ„ä»£ç </span></div><div class="line"><span class="keyword">var</span> message = SaferHTML<span class="string">`&lt;p&gt;<span class="subst">$&#123;sender&#125;</span> has sent you a message.&lt;/p&gt;`</span>;</div><div class="line"></div><div class="line">message</div><div class="line"><span class="comment">// &lt;p&gt;&amp;lt;script&amp;gt;alert("abc")&amp;lt;/script&amp;gt; has sent you a message.&lt;/p&gt;</span></div></pre></td></tr></table></figure>
<p>æ ‡ç­¾æ¨¡æ¿çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œå°±æ˜¯å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">i18n<span class="string">`Welcome to <span class="subst">$&#123;siteName&#125;</span>, you are visitor number <span class="subst">$&#123;visitorNumber&#125;</span>!`</span></div><div class="line"><span class="comment">// "æ¬¢è¿è®¿é—®xxxï¼Œæ‚¨æ˜¯ç¬¬xxxxä½è®¿é—®è€…ï¼"</span></div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«å¹¶ä¸èƒ½å–ä»£Mustacheä¹‹ç±»çš„æ¨¡æ¿åº“ï¼Œå› ä¸ºæ²¡æœ‰æ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯å¤„ç†åŠŸèƒ½ï¼Œä½†æ˜¯é€šè¿‡æ ‡ç­¾å‡½æ•°ï¼Œä½ å¯ä»¥è‡ªå·±æ·»åŠ è¿™äº›åŠŸèƒ½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸‹é¢çš„hashTemplateå‡½æ•°</span></div><div class="line"><span class="comment">// æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¨¡æ¿å¤„ç†å‡½æ•°</span></div><div class="line"><span class="keyword">var</span> libraryHtml = hashTemplate<span class="string">`</span></div><div class="line">  &lt;ul&gt;</div><div class="line">    #for book in <span class="subst">$&#123;myBooks&#125;</span></div><div class="line">      &lt;li&gt;&lt;i&gt;#&#123;book.title&#125;&lt;/i&gt; by #&#123;book.author&#125;&lt;/li&gt;</div><div class="line">    #end</div><div class="line">  &lt;/ul&gt;</div><div class="line">`;</div></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿ï¼Œåœ¨JavaScriptè¯­è¨€ä¹‹ä¸­åµŒå…¥å…¶ä»–è¯­è¨€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">jsx<span class="string">`</span></div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;input</div><div class="line">      ref='input'</div><div class="line">      onChange='<span class="subst">$&#123;<span class="keyword">this</span>.handleChange&#125;</span>'</div><div class="line">      defaultValue='<span class="subst">$&#123;<span class="keyword">this</span>.state.value&#125;</span>' /&gt;</div><div class="line">      <span class="subst">$&#123;<span class="keyword">this</span>.state.value&#125;</span></div><div class="line">   &lt;/div&gt;</div><div class="line">`</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç é€šè¿‡<code>jsx</code>å‡½æ•°ï¼Œå°†ä¸€ä¸ªDOMå­—ç¬¦ä¸²è½¬ä¸ºReactå¯¹è±¡ã€‚ä½ å¯ä»¥åœ¨Githubæ‰¾åˆ°<code>jsx</code>å‡½æ•°çš„<a href="https://gist.github.com/lygaret/a68220defa69174bdec5" target="_blank" rel="external">å…·ä½“å®ç°</a>ã€‚</p>
<p>ä¸‹é¢åˆ™æ˜¯ä¸€ä¸ªå‡æƒ³çš„ä¾‹å­ï¼Œé€šè¿‡<code>java</code>å‡½æ•°ï¼Œåœ¨JavaScriptä»£ç ä¹‹ä¸­è¿è¡ŒJavaä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">java<span class="string">`</span></div><div class="line">class HelloWorldApp &#123;</div><div class="line">  public static void main(String[] args) &#123;</div><div class="line">    System.out.println(â€œHello World!â€); // Display the string.</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">`</div><div class="line">HelloWorldApp.main();</div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>raw</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log<span class="string">`123`</span></div><div class="line"><span class="comment">// ["123", raw: Array[1]]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>console.log</code>æ¥å—çš„å‚æ•°ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„æœ‰ä¸€ä¸ª<code>raw</code>å±æ€§ï¼Œä¿å­˜çš„æ˜¯è½¬ä¹‰åçš„åŸå­—ç¬¦ä¸²ã€‚</p>
<p>è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">tag<span class="string">`First line\nSecond line`</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">strings</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(strings.raw[<span class="number">0</span>]);</div><div class="line">  <span class="comment">// "First line\\nSecond line"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>tag</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°<code>strings</code>ï¼Œæœ‰ä¸€ä¸ª<code>raw</code>å±æ€§ï¼Œä¹ŸæŒ‡å‘ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„çš„æˆå‘˜ä¸<code>strings</code>æ•°ç»„å®Œå…¨ä¸€è‡´ã€‚æ¯”å¦‚ï¼Œ<code>strings</code>æ•°ç»„æ˜¯<code>[&quot;First line\nSecond line&quot;]</code>ï¼Œé‚£ä¹ˆ<code>strings.raw</code>æ•°ç»„å°±æ˜¯<code>[&quot;First line\\nSecond line&quot;]</code>ã€‚ä¸¤è€…å”¯ä¸€çš„åŒºåˆ«ï¼Œå°±æ˜¯å­—ç¬¦ä¸²é‡Œé¢çš„æ–œæ éƒ½è¢«è½¬ä¹‰äº†ã€‚æ¯”å¦‚ï¼Œstrings.rawæ•°ç»„ä¼šå°†<code>\n</code>è§†ä¸º<code>\\</code>å’Œ<code>n</code>ä¸¤ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯æ¢è¡Œç¬¦ã€‚è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿å–å¾—è½¬ä¹‰ä¹‹å‰çš„åŸå§‹æ¨¡æ¿è€Œè®¾è®¡çš„ã€‚</p>
<h2 id="String-raw"><a href="#String-raw" class="headerlink" title="String.raw()"></a>String.raw()</h2><p>ES6è¿˜ä¸ºåŸç”Ÿçš„Stringå¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ª<code>raw</code>æ–¹æ³•ã€‚</p>
<p><code>String.raw</code>æ–¹æ³•ï¼Œå¾€å¾€ç”¨æ¥å……å½“æ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰ï¼ˆå³æ–œæ å‰é¢å†åŠ ä¸€ä¸ªæ–œæ ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå¯¹åº”äºæ›¿æ¢å˜é‡åçš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw<span class="string">`Hi\n<span class="subst">$&#123;<span class="number">2</span>+<span class="number">3</span>&#125;</span>!`</span>;</div><div class="line"><span class="comment">// "Hi\\n5!"</span></div><div class="line"></div><div class="line"><span class="built_in">String</span>.raw<span class="string">`Hi\u000A!`</span>;</div><div class="line"><span class="comment">// 'Hi\\u000A!'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœåŸå­—ç¬¦ä¸²çš„æ–œæ å·²ç»è½¬ä¹‰ï¼Œé‚£ä¹ˆ<code>String.raw</code>ä¸ä¼šåšä»»ä½•å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw<span class="string">`Hi\\n`</span></div><div class="line"><span class="comment">// "Hi\\n"</span></div></pre></td></tr></table></figure>
<p><code>String.raw</code>çš„ä»£ç åŸºæœ¬å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw = <span class="function"><span class="keyword">function</span> (<span class="params">strings, ...values</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> output = <span class="string">""</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; values.length; index++) &#123;</div><div class="line">    output += strings.raw[index] + values[index];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  output += strings.raw[index]</div><div class="line">  <span class="keyword">return</span> output;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>String.raw</code>æ–¹æ³•å¯ä»¥ä½œä¸ºå¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²çš„åŸºæœ¬æ–¹æ³•ï¼Œå®ƒä¼šå°†æ‰€æœ‰å˜é‡æ›¿æ¢ï¼Œè€Œä¸”å¯¹æ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ­¥ä½œä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨ã€‚</p>
<p><code>String.raw</code>æ–¹æ³•ä¹Ÿå¯ä»¥ä½œä¸ºæ­£å¸¸çš„å‡½æ•°ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå…·æœ‰<code>raw</code>å±æ€§çš„å¯¹è±¡ï¼Œä¸”<code>raw</code>å±æ€§çš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw(&#123; <span class="attr">raw</span>: <span class="string">'test'</span> &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="comment">// 't0e1s2t'</span></div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="built_in">String</span>.raw(&#123; <span class="attr">raw</span>: [<span class="string">'t'</span>,<span class="string">'e'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>] &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</div></pre></td></tr></table></figure>
<h2 id="æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶"></a>æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶</h2><p>å‰é¢æåˆ°æ ‡ç­¾æ¨¡æ¿é‡Œé¢ï¼Œå¯ä»¥å†…åµŒå…¶ä»–è¯­è¨€ã€‚ä½†æ˜¯ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²é»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå› æ­¤å¯¼è‡´äº†æ— æ³•åµŒå…¥å…¶ä»–è¯­è¨€ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨æ ‡ç­¾æ¨¡æ¿é‡Œé¢å¯ä»¥åµŒå…¥Latexè¯­è¨€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">latex</span>(<span class="params">strings</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> <span class="built_in">document</span> = latex<span class="string">`</span></div><div class="line">\newcommand&#123;\fun&#125;&#123;\textbf&#123;Fun!&#125;&#125;  // æ­£å¸¸å·¥ä½œ</div><div class="line">\newcommand&#123;\unicode&#125;&#123;\textbf&#123;Unicode!&#125;&#125; // æŠ¥é”™</div><div class="line">\newcommand&#123;\xerxes&#125;&#123;\textbf&#123;King!&#125;&#125; // æŠ¥é”™</div><div class="line"></div><div class="line">Breve over the h goes \u&#123;h&#125;ere // æŠ¥é”™</div><div class="line">`</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>document</code>å†…åµŒçš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå¯¹äºLatexè¯­è¨€æ¥è¯´å®Œå…¨æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯JavaScriptå¼•æ“ä¼šæŠ¥é”™ã€‚åŸå› å°±åœ¨äºå­—ç¬¦ä¸²çš„è½¬ä¹‰ã€‚</p>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ä¼šå°†<code>\u00FF</code>å’Œ<code>\u{42}</code>å½“ä½œUnicodeå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥<code>\unicode</code>è§£ææ—¶æŠ¥é”™ï¼›è€Œ<code>\x56</code>ä¼šè¢«å½“ä½œåå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œæ‰€ä»¥<code>\xerxes</code>ä¼šæŠ¥é”™ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç°åœ¨æœ‰ä¸€ä¸ª<a href="https://tc39.github.io/proposal-template-literal-revision/" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œæ”¾æ¾å¯¹æ ‡ç­¾æ¨¡æ¿é‡Œé¢çš„å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ã€‚å¦‚æœé‡åˆ°ä¸åˆæ³•çš„å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå°±è¿”å›<code>undefined</code>ï¼Œè€Œä¸æ˜¯æŠ¥é”™ï¼Œå¹¶ä¸”ä»<code>raw</code>å±æ€§ä¸Šé¢å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">strs</span>) </span>&#123;</div><div class="line">  strs[<span class="number">0</span>] === <span class="literal">undefined</span></div><div class="line">  strs.raw[<span class="number">0</span>] === <span class="string">"\\unicode and \\u&#123;55&#125;"</span>;</div><div class="line">&#125;</div><div class="line">tag<span class="string">`\unicode and \u&#123;55&#125;`</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²åŸæœ¬æ˜¯åº”è¯¥æŠ¥é”™çš„ï¼Œä½†æ˜¯ç”±äºæ”¾æ¾äº†å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ï¼Œæ‰€ä»¥ä¸æŠ¥é”™äº†ï¼ŒJavaScriptå¼•æ“å°†ç¬¬ä¸€ä¸ªå­—ç¬¦è®¾ç½®ä¸º<code>undefined</code>ï¼Œä½†æ˜¯<code>raw</code>å±æ€§ä¾ç„¶å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ï¼Œå› æ­¤<code>tag</code>å‡½æ•°è¿˜æ˜¯å¯ä»¥å¯¹åŸå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ç§å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„æ”¾æ¾ï¼Œåªåœ¨æ ‡ç­¾æ¨¡æ¿è§£æå­—ç¬¦ä¸²æ—¶ç”Ÿæ•ˆï¼Œä¸æ˜¯æ ‡ç­¾æ¨¡æ¿çš„åœºåˆï¼Œä¾ç„¶ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> bad = <span class="string">`bad escape sequence: \unicode`</span>; <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ES6åŠ å¼ºäº†å¯¹Unicodeçš„æ”¯æŒï¼Œå¹¶ä¸”æ‰©å±•äº†å­—ç¬¦ä¸²å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•&quot;&gt;&lt;a href=&quot;#å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•&quot; class=&quot;headerlink&quot; title=&quot;å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•&quot;&gt;&lt;/a&gt;å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•&lt;/h2&gt;&lt;p&gt;JavaScriptå…è®¸é‡‡ç”¨&lt;code&gt;\uxxxx&lt;/code&gt;å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­â€œxxxxâ€è¡¨ç¤ºå­—ç¬¦çš„ç ç‚¹ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\u0061&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &quot;a&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•åªé™äº&lt;code&gt;\u0000&lt;/code&gt;â€”â€”&lt;code&gt;\uFFFF&lt;/code&gt;ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨è¾¾ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\uD842\uDFB7&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &quot;ğ ®·&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\u20BB7&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &quot; 7&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨â€œ\uâ€åé¢è·Ÿä¸Šè¶…è¿‡&lt;code&gt;0xFFFF&lt;/code&gt;çš„æ•°å€¼ï¼ˆæ¯”å¦‚&lt;code&gt;\u20BB7&lt;/code&gt;ï¼‰ï¼ŒJavaScriptä¼šç†è§£æˆâ€œ\u20BB+7â€ã€‚ç”±äº&lt;code&gt;\u20BB&lt;/code&gt;æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª7ã€‚&lt;/p&gt;
&lt;p&gt;ES6å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\u&amp;#123;20BB7&amp;#125;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &quot;ğ ®·&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\u&amp;#123;41&amp;#125;\u&amp;#123;42&amp;#125;\u&amp;#123;43&amp;#125;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &quot;ABC&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; hello = &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;hell\u&amp;#123;&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;F&amp;#125; &lt;span class=&quot;comment&quot;&gt;// 123&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;1F680&amp;#125;&#39;&lt;/span&gt; === &lt;span class=&quot;string&quot;&gt;&#39;\uD83D\uDE80&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// true&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ªä¾‹å­è¡¨æ˜ï¼Œå¤§æ‹¬å·è¡¨ç¤ºæ³•ä¸å››å­—èŠ‚çš„UTF-16ç¼–ç æ˜¯ç­‰ä»·çš„ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="ECMAScript 6" scheme="https://ailley.github.io/tags/ECMAScript-6/"/>
    
  </entry>
  
  <entry>
    <title>å˜é‡çš„è§£æ„èµ‹å€¼</title>
    <link href="https://ailley.github.io/2016/10/25/%E5%8F%98%E9%87%8F%E7%9A%84%E8%A7%A3%E6%9E%84%E8%B5%8B%E5%80%BC/"/>
    <id>https://ailley.github.io/2016/10/25/å˜é‡çš„è§£æ„èµ‹å€¼/</id>
    <published>2016-10-25T00:58:35.000Z</published>
    <updated>2016-10-25T00:59:51.369Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ•°ç»„çš„è§£æ„èµ‹å€¼"><a href="#æ•°ç»„çš„è§£æ„èµ‹å€¼" class="headerlink" title="æ•°ç»„çš„è§£æ„èµ‹å€¼"></a>æ•°ç»„çš„è§£æ„èµ‹å€¼</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚</p>
<p>ä»¥å‰ï¼Œä¸ºå˜é‡èµ‹å€¼ï¼Œåªèƒ½ç›´æ¥æŒ‡å®šå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">2</span>;</div><div class="line"><span class="keyword">var</span> c = <span class="number">3</span>;</div></pre></td></tr></table></figure>
<p>ES6å…è®¸å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨åµŒå¥—æ•°ç»„è¿›è¡Œè§£æ„çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [foo, [[bar], baz]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</div><div class="line">foo <span class="comment">// 1</span></div><div class="line">bar <span class="comment">// 2</span></div><div class="line">baz <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [ , , third] = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>];</div><div class="line">third <span class="comment">// "baz"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [x, , y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line">head <span class="comment">// 1</span></div><div class="line">tail <span class="comment">// [2, 3, 4]</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [x, y, ...z] = [<span class="string">'a'</span>];</div><div class="line">x <span class="comment">// "a"</span></div><div class="line">y <span class="comment">// undefined</span></div><div class="line">z <span class="comment">// []</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè§£æ„ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ç­‰äº<code>undefined</code>ã€‚<br><a id="more"></a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [foo] = [];</div><div class="line"><span class="keyword">var</span> [bar, foo] = [<span class="number">1</span>];</div></pre></td></tr></table></figure></p>
<p>ä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½å±äºè§£æ„ä¸æˆåŠŸï¼Œ<code>foo</code>çš„å€¼éƒ½ä¼šç­‰äº<code>undefined</code>ã€‚</p>
<p>å¦ä¸€ç§æƒ…å†µæ˜¯ä¸å®Œå…¨è§£æ„ï¼Œå³ç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼ŒåªåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè§£æ„ä¾ç„¶å¯ä»¥æˆåŠŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [x, y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 2</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [a, [b], d] = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>];</div><div class="line">a <span class="comment">// 1</span></div><div class="line">b <span class="comment">// 2</span></div><div class="line">d <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ä¸ªä¾‹å­ï¼Œéƒ½å±äºä¸å®Œå…¨è§£æ„ï¼Œä½†æ˜¯å¯ä»¥æˆåŠŸã€‚</p>
<p>å¦‚æœç­‰å·çš„å³è¾¹ä¸æ˜¯æ•°ç»„ï¼ˆæˆ–è€…ä¸¥æ ¼åœ°è¯´ï¼Œä¸æ˜¯å¯éå†çš„ç»“æ„ï¼Œå‚è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">let</span> [foo] = <span class="number">1</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">false</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">NaN</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">undefined</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">null</span>;</div><div class="line"><span class="keyword">let</span> [foo] = &#123;&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¡¨è¾¾å¼éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºç­‰å·å³è¾¹çš„å€¼ï¼Œè¦ä¹ˆè½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡Iteratoræ¥å£ï¼ˆå‰äº”ä¸ªè¡¨è¾¾å¼ï¼‰ï¼Œè¦ä¹ˆæœ¬èº«å°±ä¸å…·å¤‡Iteratoræ¥å£ï¼ˆæœ€åä¸€ä¸ªè¡¨è¾¾å¼ï¼‰ã€‚</p>
<p>è§£æ„èµ‹å€¼ä¸ä»…é€‚ç”¨äºvarå‘½ä»¤ï¼Œä¹Ÿé€‚ç”¨äºletå’Œconstå‘½ä»¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [v1, v2, ..., vN ] = array;</div><div class="line"><span class="keyword">let</span> [v1, v2, ..., vN ] = array;</div><div class="line"><span class="keyword">const</span> [v1, v2, ..., vN ] = array;</div></pre></td></tr></table></figure>
<p>å¯¹äºSetç»“æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [x, y, z] = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>]);</div><div class="line">x <span class="comment">// "a"</span></div></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œåªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰Iteratoræ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fibs</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">0</span>;</div><div class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</div><div class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">yield</span> a;</div><div class="line">    [a, b] = [b, a + b];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> [first, second, third, fourth, fifth, sixth] = fibs();</div><div class="line">sixth <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>fibs</code>æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼ŒåŸç”Ÿå…·æœ‰Iteratoræ¥å£ã€‚è§£æ„èµ‹å€¼ä¼šä¾æ¬¡ä»è¿™ä¸ªæ¥å£è·å–å€¼ã€‚</p>
<h3 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h3><p>è§£æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [foo = <span class="literal">true</span>] = [];</div><div class="line">foo <span class="comment">// true</span></div><div class="line"></div><div class="line">[x, y = <span class="string">'b'</span>] = [<span class="string">'a'</span>]; <span class="comment">// x='a', y='b'</span></div><div class="line">[x, y = <span class="string">'b'</span>] = [<span class="string">'a'</span>, <span class="literal">undefined</span>]; <span class="comment">// x='a', y='b'</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼ŒES6å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ<code>===</code>ï¼‰ï¼Œåˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦æœ‰å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸ä¸¥æ ¼ç­‰äº<code>undefined</code>ï¼Œé»˜è®¤å€¼æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">undefined</span>];</div><div class="line">x <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">null</span>];</div><div class="line">x <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ•°ç»„æˆå‘˜æ˜¯<code>null</code>ï¼Œé»˜è®¤å€¼å°±ä¸ä¼šç”Ÿæ•ˆï¼Œå› ä¸º<code>null</code>ä¸ä¸¥æ ¼ç­‰äº<code>undefined</code>ã€‚</p>
<p>å¦‚æœé»˜è®¤å€¼æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼æ˜¯æƒ°æ€§æ±‚å€¼çš„ï¼Œå³åªæœ‰åœ¨ç”¨åˆ°çš„æ—¶å€™ï¼Œæ‰ä¼šæ±‚å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'aaa'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> [x = f()] = [<span class="number">1</span>];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸º<code>x</code>èƒ½å–åˆ°å€¼ï¼Œæ‰€ä»¥å‡½æ•°<code>f</code>æ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚ä¸Šé¢çš„ä»£ç å…¶å®ç­‰ä»·äºä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x;</div><div class="line"><span class="keyword">if</span> ([<span class="number">1</span>][<span class="number">0</span>] === <span class="literal">undefined</span>) &#123;</div><div class="line">  x = f();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  x = [<span class="number">1</span>][<span class="number">0</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é»˜è®¤å€¼å¯ä»¥å¼•ç”¨è§£æ„èµ‹å€¼çš„å…¶ä»–å˜é‡ï¼Œä½†è¯¥å˜é‡å¿…é¡»å·²ç»å£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [];     <span class="comment">// x=1; y=1</span></div><div class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">2</span>];    <span class="comment">// x=2; y=2</span></div><div class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">1</span>, <span class="number">2</span>]; <span class="comment">// x=1; y=2</span></div><div class="line"><span class="keyword">let</span> [x = y, y = <span class="number">1</span>] = [];     <span class="comment">// ReferenceError</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢æœ€åä¸€ä¸ªè¡¨è¾¾å¼ä¹‹æ‰€ä»¥ä¼šæŠ¥é”™ï¼Œæ˜¯å› ä¸º<code>x</code>ç”¨åˆ°é»˜è®¤å€¼<code>y</code>æ—¶ï¼Œ<code>y</code>è¿˜æ²¡æœ‰å£°æ˜ã€‚</p>
<h2 id="å¯¹è±¡çš„è§£æ„èµ‹å€¼"><a href="#å¯¹è±¡çš„è§£æ„èµ‹å€¼" class="headerlink" title="å¯¹è±¡çš„è§£æ„èµ‹å€¼"></a>å¯¹è±¡çš„è§£æ„èµ‹å€¼</h2><p>è§£æ„ä¸ä»…å¯ä»¥ç”¨äºæ•°ç»„ï¼Œè¿˜å¯ä»¥ç”¨äºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">foo <span class="comment">// "aaa"</span></div><div class="line">bar <span class="comment">// "bbb"</span></div></pre></td></tr></table></figure>
<p>å¯¹è±¡çš„è§£æ„ä¸æ•°ç»„æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒã€‚æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼›è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; bar, foo &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">foo <span class="comment">// "aaa"</span></div><div class="line">bar <span class="comment">// "bbb"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">baz <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œç­‰å·å·¦è¾¹çš„ä¸¤ä¸ªå˜é‡çš„æ¬¡åºï¼Œä¸ç­‰å·å³è¾¹ä¸¤ä¸ªåŒåå±æ€§çš„æ¬¡åºä¸ä¸€è‡´ï¼Œä½†æ˜¯å¯¹å–å€¼å®Œå…¨æ²¡æœ‰å½±å“ã€‚ç¬¬äºŒä¸ªä¾‹å­çš„å˜é‡æ²¡æœ‰å¯¹åº”çš„åŒåå±æ€§ï¼Œå¯¼è‡´å–ä¸åˆ°å€¼ï¼Œæœ€åç­‰äº<code>undefined</code>ã€‚</p>
<p>å¦‚æœå˜é‡åä¸å±æ€§åä¸ä¸€è‡´ï¼Œå¿…é¡»å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; <span class="attr">foo</span>: baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">'aaa'</span>, <span class="attr">bar</span>: <span class="string">'bbb'</span> &#125;;</div><div class="line">baz <span class="comment">// "aaa"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">first</span>: <span class="string">'hello'</span>, <span class="attr">last</span>: <span class="string">'world'</span> &#125;;</div><div class="line"><span class="keyword">let</span> &#123; <span class="attr">first</span>: f, <span class="attr">last</span>: l &#125; = obj;</div><div class="line">f <span class="comment">// 'hello'</span></div><div class="line">l <span class="comment">// 'world'</span></div></pre></td></tr></table></figure>
<p>è¿™å®é™…ä¸Šè¯´æ˜ï¼Œå¯¹è±¡çš„è§£æ„èµ‹å€¼æ˜¯ä¸‹é¢å½¢å¼çš„ç®€å†™ï¼ˆå‚è§ã€Šå¯¹è±¡çš„æ‰©å±•ã€‹ä¸€ç« ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; <span class="attr">foo</span>: foo, <span class="attr">bar</span>: bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡çš„è§£æ„èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶ï¼Œæ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…ï¼Œè€Œä¸æ˜¯å‰è€…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; <span class="attr">foo</span>: baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">baz <span class="comment">// "aaa"</span></div><div class="line">foo <span class="comment">// error: foo is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒçœŸæ­£è¢«èµ‹å€¼çš„æ˜¯å˜é‡<code>baz</code>ï¼Œè€Œä¸æ˜¯æ¨¡å¼<code>foo</code>ã€‚</p>
<p>æ³¨æ„ï¼Œé‡‡ç”¨è¿™ç§å†™æ³•æ—¶ï¼Œå˜é‡çš„å£°æ˜å’Œèµ‹å€¼æ˜¯ä¸€ä½“çš„ã€‚å¯¹äº<code>let</code>å’Œ<code>const</code>æ¥è¯´ï¼Œå˜é‡ä¸èƒ½é‡æ–°å£°æ˜ï¼Œæ‰€ä»¥ä¸€æ—¦èµ‹å€¼çš„å˜é‡ä»¥å‰å£°æ˜è¿‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo;</div><div class="line"><span class="keyword">let</span> &#123;foo&#125; = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "foo"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> baz;</div><div class="line"><span class="keyword">let</span> &#123;<span class="attr">bar</span>: baz&#125; = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "baz"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè§£æ„èµ‹å€¼çš„å˜é‡éƒ½ä¼šé‡æ–°å£°æ˜ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚ä¸è¿‡ï¼Œå› ä¸º<code>var</code>å‘½ä»¤å…è®¸é‡æ–°å£°æ˜ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯åªä¼šåœ¨ä½¿ç”¨<code>let</code>å’Œ<code>const</code>å‘½ä»¤æ—¶å‡ºç°ã€‚å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ª<code>let</code>å‘½ä»¤ï¼Œä¸Šé¢çš„ä»£ç å°±ä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo;</div><div class="line">(&#123;foo&#125; = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;); <span class="comment">// æˆåŠŸ</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> baz;</div><div class="line">(&#123;<span class="attr">bar</span>: baz&#125; = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;); <span class="comment">// æˆåŠŸ</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>let</code>å‘½ä»¤ä¸‹é¢ä¸€è¡Œçš„åœ†æ‹¬å·æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å› ä¸ºè§£æå™¨ä¼šå°†èµ·é¦–çš„å¤§æ‹¬å·ï¼Œç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œè€Œä¸æ˜¯èµ‹å€¼è¯­å¥ã€‚</p>
<p>å’Œæ•°ç»„ä¸€æ ·ï¼Œè§£æ„ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">p</span>: [</div><div class="line">    <span class="string">'Hello'</span>,</div><div class="line">    &#123; <span class="attr">y</span>: <span class="string">'World'</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">p</span>: [x, &#123; y &#125;] &#125; = obj;</div><div class="line">x <span class="comment">// "Hello"</span></div><div class="line">y <span class="comment">// "World"</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™æ—¶<code>p</code>æ˜¯æ¨¡å¼ï¼Œä¸æ˜¯å˜é‡ï¼Œå› æ­¤ä¸ä¼šè¢«èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> node = &#123;</div><div class="line">  <span class="attr">loc</span>: &#123;</div><div class="line">    <span class="attr">start</span>: &#123;</div><div class="line">      <span class="attr">line</span>: <span class="number">1</span>,</div><div class="line">      <span class="attr">column</span>: <span class="number">5</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">loc</span>: &#123; <span class="attr">start</span>: &#123; line &#125;&#125; &#125; = node;</div><div class="line">line <span class="comment">// 1</span></div><div class="line">loc  <span class="comment">// error: loc is undefined</span></div><div class="line">start <span class="comment">// error: start is undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªæœ‰<code>line</code>æ˜¯å˜é‡ï¼Œ<code>loc</code>å’Œ<code>start</code>éƒ½æ˜¯æ¨¡å¼ï¼Œä¸ä¼šè¢«èµ‹å€¼ã€‚</p>
<p>ä¸‹é¢æ˜¯åµŒå¥—èµ‹å€¼çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;&#125;;</div><div class="line"><span class="keyword">let</span> arr = [];</div><div class="line"></div><div class="line">(&#123; <span class="attr">foo</span>: obj.prop, <span class="attr">bar</span>: arr[<span class="number">0</span>] &#125; = &#123; <span class="attr">foo</span>: <span class="number">123</span>, <span class="attr">bar</span>: <span class="literal">true</span> &#125;);</div><div class="line"></div><div class="line">obj <span class="comment">// &#123;prop:123&#125;</span></div><div class="line">arr <span class="comment">// [true]</span></div></pre></td></tr></table></figure>
<p>å¯¹è±¡çš„è§£æ„ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;&#125;;</div><div class="line">x <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;x, y = <span class="number">5</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 5</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>:y = <span class="number">3</span>&#125; = &#123;&#125;;</div><div class="line">y <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>:y = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">5</span>&#125;;</div><div class="line">y <span class="comment">// 5</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">message</span>: msg = <span class="string">'Something went wrong'</span> &#125; = &#123;&#125;;</div><div class="line">msg <span class="comment">// "Something went wrong"</span></div></pre></td></tr></table></figure>
<p>é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äº<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="literal">undefined</span>&#125;;</div><div class="line">x <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="literal">null</span>&#125;;</div><div class="line">x <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>x</code>å±æ€§ç­‰äº<code>null</code>ï¼Œå°±ä¸ä¸¥æ ¼ç›¸ç­‰äº<code>undefined</code>ï¼Œå¯¼è‡´é»˜è®¤å€¼ä¸ä¼šç”Ÿæ•ˆã€‚</p>
<p>å¦‚æœè§£æ„å¤±è´¥ï¼Œå˜é‡çš„å€¼ç­‰äº<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123;foo&#125; = &#123;<span class="attr">bar</span>: <span class="string">'baz'</span>&#125;;</div><div class="line">foo <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè§£æ„æ¨¡å¼æ˜¯åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸”å­å¯¹è±¡æ‰€åœ¨çš„çˆ¶å±æ€§ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">foo</span>: &#123;bar&#125;&#125; = &#123;<span class="attr">baz</span>: <span class="string">'baz'</span>&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç­‰å·å·¦è¾¹å¯¹è±¡çš„<code>foo</code>å±æ€§ï¼Œå¯¹åº”ä¸€ä¸ªå­å¯¹è±¡ã€‚è¯¥å­å¯¹è±¡çš„<code>bar</code>å±æ€§ï¼Œè§£æ„æ—¶ä¼šæŠ¥é”™ã€‚åŸå› å¾ˆç®€å•ï¼Œå› ä¸º<code>foo</code>è¿™æ—¶ç­‰äº<code>undefined</code>ï¼Œå†å–å­å±æ€§å°±ä¼šæŠ¥é”™ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _tmp = &#123;<span class="attr">baz</span>: <span class="string">'baz'</span>&#125;;</div><div class="line">_tmp.foo.bar <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè¦å°†ä¸€ä¸ªå·²ç»å£°æ˜çš„å˜é‡ç”¨äºè§£æ„èµ‹å€¼ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// é”™è¯¯çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> x;</div><div class="line">&#123;x&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</div><div class="line"><span class="comment">// SyntaxError: syntax error</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„å†™æ³•ä¼šæŠ¥é”™ï¼Œå› ä¸ºJavaScriptå¼•æ“ä¼šå°†<code>{x}</code>ç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œä»è€Œå‘ç”Ÿè¯­æ³•é”™è¯¯ã€‚åªæœ‰ä¸å°†å¤§æ‹¬å·å†™åœ¨è¡Œé¦–ï¼Œé¿å…JavaScriptå°†å…¶è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ­£ç¡®çš„å†™æ³•</span></div><div class="line">(&#123;x&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†æ•´ä¸ªè§£æ„èµ‹å€¼è¯­å¥ï¼Œæ”¾åœ¨ä¸€ä¸ªåœ†æ‹¬å·é‡Œé¢ï¼Œå°±å¯ä»¥æ­£ç¡®æ‰§è¡Œã€‚å…³äºåœ†æ‹¬å·ä¸è§£æ„èµ‹å€¼çš„å…³ç³»ï¼Œå‚è§ä¸‹æ–‡ã€‚</p>
<p>è§£æ„èµ‹å€¼å…è®¸ï¼Œç­‰å·å·¦è¾¹çš„æ¨¡å¼ä¹‹ä¸­ï¼Œä¸æ”¾ç½®ä»»ä½•å˜é‡åã€‚å› æ­¤ï¼Œå¯ä»¥å†™å‡ºéå¸¸å¤æ€ªçš„èµ‹å€¼è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(&#123;&#125; = [<span class="literal">true</span>, <span class="literal">false</span>]);</div><div class="line">(&#123;&#125; = <span class="string">'abc'</span>);</div><div class="line">(&#123;&#125; = []);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¡¨è¾¾å¼è™½ç„¶æ¯«æ— æ„ä¹‰ï¼Œä½†æ˜¯è¯­æ³•æ˜¯åˆæ³•çš„ï¼Œå¯ä»¥æ‰§è¡Œã€‚</p>
<p>å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ç°æœ‰å¯¹è±¡çš„æ–¹æ³•ï¼Œèµ‹å€¼åˆ°æŸä¸ªå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; log, sin, cos &#125; = <span class="built_in">Math</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†<code>Math</code>å¯¹è±¡çš„å¯¹æ•°ã€æ­£å¼¦ã€ä½™å¼¦ä¸‰ä¸ªæ–¹æ³•ï¼Œèµ‹å€¼åˆ°å¯¹åº”çš„å˜é‡ä¸Šï¼Œä½¿ç”¨èµ·æ¥å°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</p>
<p>ç”±äºæ•°ç»„æœ¬è´¨æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œå¯¹è±¡å±æ€§çš„è§£æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> &#123;<span class="number">0</span> : first, [arr.length - <span class="number">1</span>] : last&#125; = arr;</div><div class="line">first <span class="comment">// 1</span></div><div class="line">last <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯¹æ•°ç»„è¿›è¡Œå¯¹è±¡è§£æ„ã€‚æ•°ç»„<code>arr</code>çš„<code>0</code>é”®å¯¹åº”çš„å€¼æ˜¯<code>1</code>ï¼Œ<code>[arr.length - 1]</code>å°±æ˜¯<code>2</code>é”®ï¼Œå¯¹åº”çš„å€¼æ˜¯<code>3</code>ã€‚æ–¹æ‹¬å·è¿™ç§å†™æ³•ï¼Œå±äºâ€œå±æ€§åè¡¨è¾¾å¼â€ï¼Œå‚è§ã€Šå¯¹è±¡çš„æ‰©å±•ã€‹ä¸€ç« ã€‚</p>
<h2 id="å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"><a href="#å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼" class="headerlink" title="å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"></a>å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼</h2><p>å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è§£æ„èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ï¼Œå­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">'hello'</span>;</div><div class="line">a <span class="comment">// "h"</span></div><div class="line">b <span class="comment">// "e"</span></div><div class="line">c <span class="comment">// "l"</span></div><div class="line">d <span class="comment">// "l"</span></div><div class="line">e <span class="comment">// "o"</span></div></pre></td></tr></table></figure>
<p>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>length</code>å±æ€§ï¼Œå› æ­¤è¿˜å¯ä»¥å¯¹è¿™ä¸ªå±æ€§è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123;<span class="attr">length</span> : len&#125; = <span class="string">'hello'</span>;</div><div class="line">len <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<h2 id="æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼"><a href="#æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼" class="headerlink" title="æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼"></a>æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼</h2><p>è§£æ„èµ‹å€¼æ—¶ï¼Œå¦‚æœç­‰å·å³è¾¹æ˜¯æ•°å€¼å’Œå¸ƒå°”å€¼ï¼Œåˆ™ä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123;<span class="attr">toString</span>: s&#125; = <span class="number">123</span>;</div><div class="line">s === <span class="built_in">Number</span>.prototype.toString <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123;<span class="attr">toString</span>: s&#125; = <span class="literal">true</span>;</div><div class="line">s === <span class="built_in">Boolean</span>.prototype.toString <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°å€¼å’Œå¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡éƒ½æœ‰<code>toString</code>å±æ€§ï¼Œå› æ­¤å˜é‡<code>s</code>éƒ½èƒ½å–åˆ°å€¼ã€‚</p>
<p>è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äº<code>undefined</code>å’Œ<code>null</code>æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; <span class="attr">prop</span>: x &#125; = <span class="literal">undefined</span>; <span class="comment">// TypeError</span></div><div class="line"><span class="keyword">let</span> &#123; <span class="attr">prop</span>: y &#125; = <span class="literal">null</span>; <span class="comment">// TypeError</span></div></pre></td></tr></table></figure>
<h2 id="å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼"><a href="#å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼" class="headerlink" title="å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼"></a>å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼</h2><p>å‡½æ•°çš„å‚æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">[x, y]</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> x + y;</div><div class="line">&#125;</div><div class="line"></div><div class="line">add([<span class="number">1</span>, <span class="number">2</span>]); <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>add</code>çš„å‚æ•°è¡¨é¢ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½†åœ¨ä¼ å…¥å‚æ•°çš„é‚£ä¸€åˆ»ï¼Œæ•°ç»„å‚æ•°å°±è¢«è§£æ„æˆå˜é‡<code>x</code>å’Œ<code>y</code>ã€‚å¯¹äºå‡½æ•°å†…éƒ¨çš„ä»£ç æ¥è¯´ï¼Œå®ƒä»¬èƒ½æ„Ÿå—åˆ°çš„å‚æ•°å°±æ˜¯<code>x</code>å’Œ<code>y</code>ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]].map(<span class="function">(<span class="params">[a, b]</span>) =&gt;</span> a + b);</div><div class="line"><span class="comment">// [ 3, 7 ]</span></div></pre></td></tr></table></figure>
<p>å‡½æ•°å‚æ•°çš„è§£æ„ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x = <span class="number">0</span>, y = <span class="number">0</span>&#125; = &#123;&#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;); <span class="comment">// [3, 0]</span></div><div class="line">move(&#123;&#125;); <span class="comment">// [0, 0]</span></div><div class="line">move(); <span class="comment">// [0, 0]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>move</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œè§£æ„ï¼Œå¾—åˆ°å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼ã€‚å¦‚æœè§£æ„å¤±è´¥ï¼Œ<code>x</code>å’Œ<code>y</code>ç­‰äºé»˜è®¤å€¼ã€‚</p>
<p>æ³¨æ„ï¼Œä¸‹é¢çš„å†™æ³•ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x, y&#125; = &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;); <span class="comment">// [3, undefined]</span></div><div class="line">move(&#123;&#125;); <span class="comment">// [undefined, undefined]</span></div><div class="line">move(); <span class="comment">// [0, 0]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸ºå‡½æ•°<code>move</code>çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸ºå˜é‡<code>x</code>å’Œ<code>y</code>æŒ‡å®šé»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¼šå¾—åˆ°ä¸å‰ä¸€ç§å†™æ³•ä¸åŒçš„ç»“æœã€‚</p>
<p><code>undefined</code>å°±ä¼šè§¦å‘å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="literal">undefined</span>, <span class="number">3</span>].map(<span class="function">(<span class="params">x = <span class="string">'yes'</span></span>) =&gt;</span> x);</div><div class="line"><span class="comment">// [ 1, 'yes', 3 ]</span></div></pre></td></tr></table></figure>
<h2 id="åœ†æ‹¬å·é—®é¢˜"><a href="#åœ†æ‹¬å·é—®é¢˜" class="headerlink" title="åœ†æ‹¬å·é—®é¢˜"></a>åœ†æ‹¬å·é—®é¢˜</h2><p>è§£æ„èµ‹å€¼è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è§£æèµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œä¸€ä¸ªå¼å­åˆ°åº•æ˜¯æ¨¡å¼ï¼Œè¿˜æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åŠæ³•ä»ä¸€å¼€å§‹å°±çŸ¥é“ï¼Œå¿…é¡»è§£æåˆ°ï¼ˆæˆ–è§£æä¸åˆ°ï¼‰ç­‰å·æ‰èƒ½çŸ¥é“ã€‚</p>
<p>ç”±æ­¤å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæ¨¡å¼ä¸­å‡ºç°åœ†æ‹¬å·æ€ä¹ˆå¤„ç†ã€‚ES6çš„è§„åˆ™æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½å¯¼è‡´è§£æ„çš„æ­§ä¹‰ï¼Œå°±ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™æ¡è§„åˆ™å®é™…ä¸Šä¸é‚£ä¹ˆå®¹æ˜“è¾¨åˆ«ï¼Œå¤„ç†èµ·æ¥ç›¸å½“éº»çƒ¦ã€‚å› æ­¤ï¼Œå»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·ã€‚</p>
<h3 id="ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"><a href="#ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ" class="headerlink" title="ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"></a>ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ</h3><p>ä»¥ä¸‹ä¸‰ç§è§£æ„èµ‹å€¼ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<p>ï¼ˆ1ï¼‰å˜é‡å£°æ˜è¯­å¥ä¸­ï¼Œä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å…¨éƒ¨æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> [(a)] = [<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>: (c)&#125; = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> (&#123;<span class="attr">x</span>: c&#125;) = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> &#123;(x: c)&#125; = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> &#123;(x): c&#125; = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">o</span>: (&#123; <span class="attr">p</span>: p &#125;) &#125; = &#123; <span class="attr">o</span>: &#123; <span class="attr">p</span>: <span class="number">2</span> &#125; &#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸‰ä¸ªè¯­å¥éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯å˜é‡å£°æ˜è¯­å¥ï¼Œæ¨¡å¼ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<p>ï¼ˆ2ï¼‰å‡½æ•°å‚æ•°ä¸­ï¼Œæ¨¡å¼ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚</p>
<p>å‡½æ•°å‚æ•°ä¹Ÿå±äºå˜é‡å£°æ˜ï¼Œå› æ­¤ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[(z</span>)]) </span>&#123; <span class="keyword">return</span> z; &#125;</div></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰èµ‹å€¼è¯­å¥ä¸­ï¼Œä¸èƒ½å°†æ•´ä¸ªæ¨¡å¼ï¼Œæˆ–åµŒå¥—æ¨¡å¼ä¸­çš„ä¸€å±‚ï¼Œæ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å…¨éƒ¨æŠ¥é”™</span></div><div class="line">(&#123; <span class="attr">p</span>: a &#125;) = &#123; <span class="attr">p</span>: <span class="number">42</span> &#125;;</div><div class="line">([a]) = [<span class="number">5</span>];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†æ•´ä¸ªæ¨¡å¼æ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line">[(&#123; <span class="attr">p</span>: a &#125;), &#123; <span class="attr">x</span>: c &#125;] = [&#123;&#125;, &#123;&#125;];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†åµŒå¥—æ¨¡å¼çš„ä¸€å±‚ï¼Œæ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<h3 id="å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"><a href="#å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ" class="headerlink" title="å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"></a>å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ</h3><p>å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µåªæœ‰ä¸€ç§ï¼šèµ‹å€¼è¯­å¥çš„éæ¨¡å¼éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[(b)] = [<span class="number">3</span>]; <span class="comment">// æ­£ç¡®</span></div><div class="line">(&#123; <span class="attr">p</span>: (d) &#125; = &#123;&#125;); <span class="comment">// æ­£ç¡®</span></div><div class="line">[(<span class="built_in">parseInt</span>.prop)] = [<span class="number">3</span>]; <span class="comment">// æ­£ç¡®</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸‰è¡Œè¯­å¥éƒ½å¯ä»¥æ­£ç¡®æ‰§è¡Œï¼Œå› ä¸ºé¦–å…ˆå®ƒä»¬éƒ½æ˜¯èµ‹å€¼è¯­å¥ï¼Œè€Œä¸æ˜¯å£°æ˜è¯­å¥ï¼›å…¶æ¬¡å®ƒä»¬çš„åœ†æ‹¬å·éƒ½ä¸å±äºæ¨¡å¼çš„ä¸€éƒ¨åˆ†ã€‚ç¬¬ä¸€è¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯å–æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œè·Ÿåœ†æ‹¬å·æ— å…³ï¼›ç¬¬äºŒè¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯pï¼Œè€Œä¸æ˜¯dï¼›ç¬¬ä¸‰è¡Œè¯­å¥ä¸ç¬¬ä¸€è¡Œè¯­å¥çš„æ€§è´¨ä¸€è‡´ã€‚</p>
<h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p>å˜é‡çš„è§£æ„èµ‹å€¼ç”¨é€”å¾ˆå¤šã€‚</p>
<p><strong>ï¼ˆ1ï¼‰äº¤æ¢å˜é‡çš„å€¼</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x, y] = [y, x];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç äº¤æ¢å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼ï¼Œè¿™æ ·çš„å†™æ³•ä¸ä»…ç®€æ´ï¼Œè€Œä¸”æ˜“è¯»ï¼Œè¯­ä¹‰éå¸¸æ¸…æ™°ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼</strong></p>
<p>å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¦è¿”å›å¤šä¸ªå€¼ï¼Œåªèƒ½å°†å®ƒä»¬æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œè¿”å›ã€‚æœ‰äº†è§£æ„èµ‹å€¼ï¼Œå–å‡ºè¿™äº›å€¼å°±éå¸¸æ–¹ä¾¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è¿”å›ä¸€ä¸ªæ•°ç»„</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> [a, b, c] = example();</div><div class="line"></div><div class="line"><span class="comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">bar</span>: <span class="number">2</span></div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = example();</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰å‡½æ•°å‚æ•°çš„å®šä¹‰</strong></p>
<p>è§£æ„èµ‹å€¼å¯ä»¥æ–¹ä¾¿åœ°å°†ä¸€ç»„å‚æ•°ä¸å˜é‡åå¯¹åº”èµ·æ¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[x, y, z]</span>) </span>&#123; ... &#125;</div><div class="line">f([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line"></div><div class="line"><span class="comment">// å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">&#123;x, y, z&#125;</span>) </span>&#123; ... &#125;</div><div class="line">f(&#123;<span class="attr">z</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">x</span>: <span class="number">1</span>&#125;);</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰æå–JSONæ•°æ®</strong></p>
<p>è§£æ„èµ‹å€¼å¯¹æå–JSONå¯¹è±¡ä¸­çš„æ•°æ®ï¼Œå°¤å…¶æœ‰ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> jsonData = &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">42</span>,</div><div class="line">  <span class="attr">status</span>: <span class="string">"OK"</span>,</div><div class="line">  <span class="attr">data</span>: [<span class="number">867</span>, <span class="number">5309</span>]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123; id, status, <span class="attr">data</span>: number &#125; = jsonData;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(id, status, number);</div><div class="line"><span class="comment">// 42, "OK", [867, 5309]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯ä»¥å¿«é€Ÿæå–JSONæ•°æ®çš„å€¼ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">jQuery.ajax = <span class="function"><span class="keyword">function</span> (<span class="params">url, &#123;</span></span></div><div class="line">  async = true,</div><div class="line">  beforeSend = function () &#123;&#125;,</div><div class="line">  cache = <span class="literal">true</span>,</div><div class="line">  complete = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</div><div class="line">  crossDomain = <span class="literal">false</span>,</div><div class="line">  global = <span class="literal">true</span>,</div><div class="line">  <span class="comment">// ... more config</span></div><div class="line">&#125;) &#123;</div><div class="line">  <span class="comment">// ... do stuff</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±é¿å…äº†åœ¨å‡½æ•°ä½“å†…éƒ¨å†å†™<code>var foo = config.foo || &#39;default foo&#39;;</code>è¿™æ ·çš„è¯­å¥ã€‚</p>
<p><strong>ï¼ˆ6ï¼‰éå†Mapç»“æ„</strong></p>
<p>ä»»ä½•éƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†ã€‚Mapç»“æ„åŸç”Ÿæ”¯æŒIteratoræ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">map.set(<span class="string">'first'</span>, <span class="string">'hello'</span>);</div><div class="line">map.set(<span class="string">'second'</span>, <span class="string">'world'</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key + <span class="string">" is "</span> + value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// first is hello</span></div><div class="line"><span class="comment">// second is world</span></div></pre></td></tr></table></figure>
<p>å¦‚æœåªæƒ³è·å–é”®åï¼Œæˆ–è€…åªæƒ³è·å–é”®å€¼ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è·å–é”®å</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è·å–é”®å€¼</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [,value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ7ï¼‰è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³•</strong></p>
<p>åŠ è½½æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦æŒ‡å®šè¾“å…¥é‚£äº›æ–¹æ³•ã€‚è§£æ„èµ‹å€¼ä½¿å¾—è¾“å…¥è¯­å¥éå¸¸æ¸…æ™°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; SourceMapConsumer, SourceNode &#125; = <span class="built_in">require</span>(<span class="string">"source-map"</span>);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ•°ç»„çš„è§£æ„èµ‹å€¼&quot;&gt;&lt;a href=&quot;#æ•°ç»„çš„è§£æ„èµ‹å€¼&quot; class=&quot;headerlink&quot; title=&quot;æ•°ç»„çš„è§£æ„èµ‹å€¼&quot;&gt;&lt;/a&gt;æ•°ç»„çš„è§£æ„èµ‹å€¼&lt;/h2&gt;&lt;h3 id=&quot;åŸºæœ¬ç”¨æ³•&quot;&gt;&lt;a href=&quot;#åŸºæœ¬ç”¨æ³•&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬ç”¨æ³•&quot;&gt;&lt;/a&gt;åŸºæœ¬ç”¨æ³•&lt;/h3&gt;&lt;p&gt;ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥å‰ï¼Œä¸ºå˜é‡èµ‹å€¼ï¼Œåªèƒ½ç›´æ¥æŒ‡å®šå€¼ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; b = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; c = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES6å…è®¸å†™æˆä¸‹é¢è¿™æ ·ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; [a, b, c] = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;];&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨åµŒå¥—æ•°ç»„è¿›è¡Œè§£æ„çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [foo, [[bar], baz]] = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, [[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;foo &lt;span class=&quot;comment&quot;&gt;// 1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;bar &lt;span class=&quot;comment&quot;&gt;// 2&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;baz &lt;span class=&quot;comment&quot;&gt;// 3&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [ , , third] = [&lt;span class=&quot;string&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;bar&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;baz&quot;&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;third &lt;span class=&quot;comment&quot;&gt;// &quot;baz&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [x, , y] = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;x &lt;span class=&quot;comment&quot;&gt;// 1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;y &lt;span class=&quot;comment&quot;&gt;// 3&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [head, ...tail] = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;head &lt;span class=&quot;comment&quot;&gt;// 1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tail &lt;span class=&quot;comment&quot;&gt;// [2, 3, 4]&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [x, y, ...z] = [&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;x &lt;span class=&quot;comment&quot;&gt;// &quot;a&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;y &lt;span class=&quot;comment&quot;&gt;// undefined&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;z &lt;span class=&quot;comment&quot;&gt;// []&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœè§£æ„ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ç­‰äº&lt;code&gt;undefined&lt;/code&gt;ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="ECMAScript 6" scheme="https://ailley.github.io/tags/ECMAScript-6/"/>
    
  </entry>
  
  <entry>
    <title>letå’Œconstå‘½ä»¤</title>
    <link href="https://ailley.github.io/2016/10/25/let%E5%92%8Cconst%E5%91%BD%E4%BB%A4/"/>
    <id>https://ailley.github.io/2016/10/25/letå’Œconstå‘½ä»¤/</id>
    <published>2016-10-25T00:54:36.000Z</published>
    <updated>2016-10-25T00:56:36.972Z</updated>
    
    <content type="html"><![CDATA[<h2 id="letå‘½ä»¤"><a href="#letå‘½ä»¤" class="headerlink" title="letå‘½ä»¤"></a>letå‘½ä»¤</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>ES6æ–°å¢äº†<code>let</code>å‘½ä»¤ï¼Œç”¨æ¥å£°æ˜å˜é‡ã€‚å®ƒçš„ç”¨æ³•ç±»ä¼¼äº<code>var</code>ï¼Œä½†æ˜¯æ‰€å£°æ˜çš„å˜é‡ï¼Œåªåœ¨<code>let</code>å‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">a <span class="comment">// ReferenceError: a is not defined.</span></div><div class="line">b <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ä»£ç å—ä¹‹ä¸­ï¼Œåˆ†åˆ«ç”¨<code>let</code>å’Œ<code>var</code>å£°æ˜äº†ä¸¤ä¸ªå˜é‡ã€‚ç„¶ååœ¨ä»£ç å—ä¹‹å¤–è°ƒç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œç»“æœ<code>let</code>å£°æ˜çš„å˜é‡æŠ¥é”™ï¼Œ<code>var</code>å£°æ˜çš„å˜é‡è¿”å›äº†æ­£ç¡®çš„å€¼ã€‚è¿™è¡¨æ˜ï¼Œ<code>let</code>å£°æ˜çš„å˜é‡åªåœ¨å®ƒæ‰€åœ¨çš„ä»£ç å—æœ‰æ•ˆã€‚</p>
<p><code>for</code>å¾ªç¯çš„è®¡æ•°å™¨ï¼Œå°±å¾ˆåˆé€‚ä½¿ç”¨<code>let</code>å‘½ä»¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(i);</div><div class="line"><span class="comment">//ReferenceError: i is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè®¡æ•°å™¨<code>i</code>åªåœ¨<code>for</code>å¾ªç¯ä½“å†…æœ‰æ•ˆï¼Œåœ¨å¾ªç¯ä½“å¤–å¼•ç”¨å°±ä¼šæŠ¥é”™ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç å¦‚æœä½¿ç”¨<code>var</code>ï¼Œæœ€åè¾“å‡ºçš„æ˜¯10ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line">a[<span class="number">6</span>](); <span class="comment">// 10</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>i</code>æ˜¯<code>var</code>å£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚æ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯ï¼Œæ–°çš„<code>i</code>å€¼éƒ½ä¼šè¦†ç›–æ—§å€¼ï¼Œå¯¼è‡´æœ€åè¾“å‡ºçš„æ˜¯æœ€åä¸€è½®çš„<code>i</code>çš„å€¼ã€‚</p>
<p>å¦‚æœä½¿ç”¨<code>let</code>ï¼Œå£°æ˜çš„å˜é‡ä»…åœ¨å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œæœ€åè¾“å‡ºçš„æ˜¯6ã€‚<br><a id="more"></a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line">a[<span class="number">6</span>](); <span class="comment">// 6</span></div></pre></td></tr></table></figure></p>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>i</code>æ˜¯<code>let</code>å£°æ˜çš„ï¼Œå½“å‰çš„<code>i</code>åªåœ¨æœ¬è½®å¾ªç¯æœ‰æ•ˆï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯çš„<code>i</code>å…¶å®éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçš„æ˜¯6ã€‚</p>
<h3 id="ä¸å­˜åœ¨å˜é‡æå‡"><a href="#ä¸å­˜åœ¨å˜é‡æå‡" class="headerlink" title="ä¸å­˜åœ¨å˜é‡æå‡"></a>ä¸å­˜åœ¨å˜é‡æå‡</h3><p><code>let</code>ä¸åƒ<code>var</code>é‚£æ ·ä¼šå‘ç”Ÿâ€œå˜é‡æå‡â€ç°è±¡ã€‚æ‰€ä»¥ï¼Œå˜é‡ä¸€å®šè¦åœ¨å£°æ˜åä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// è¾“å‡ºundefined</span></div><div class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// æŠ¥é”™ReferenceError</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</div><div class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>foo</code>ç”¨<code>var</code>å‘½ä»¤å£°æ˜ï¼Œä¼šå‘ç”Ÿå˜é‡æå‡ï¼Œå³è„šæœ¬å¼€å§‹è¿è¡Œæ—¶ï¼Œå˜é‡<code>foo</code>å·²ç»å­˜åœ¨äº†ï¼Œä½†æ˜¯æ²¡æœ‰å€¼ï¼Œæ‰€ä»¥ä¼šè¾“å‡º<code>undefined</code>ã€‚å˜é‡<code>bar</code>ç”¨<code>let</code>å‘½ä»¤å£°æ˜ï¼Œä¸ä¼šå‘ç”Ÿå˜é‡æå‡ã€‚è¿™è¡¨ç¤ºåœ¨å£°æ˜å®ƒä¹‹å‰ï¼Œå˜é‡<code>bar</code>æ˜¯ä¸å­˜åœ¨çš„ï¼Œè¿™æ—¶å¦‚æœç”¨åˆ°å®ƒï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<h3 id="æš‚æ—¶æ€§æ­»åŒº"><a href="#æš‚æ—¶æ€§æ­»åŒº" class="headerlink" title="æš‚æ—¶æ€§æ­»åŒº"></a>æš‚æ—¶æ€§æ­»åŒº</h3><p>åªè¦å—çº§ä½œç”¨åŸŸå†…å­˜åœ¨<code>let</code>å‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±â€œç»‘å®šâ€ï¼ˆbindingï¼‰è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tmp = <span class="number">123</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  tmp = <span class="string">'abc'</span>; <span class="comment">// ReferenceError</span></div><div class="line">  <span class="keyword">let</span> tmp;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜åœ¨å…¨å±€å˜é‡<code>tmp</code>ï¼Œä½†æ˜¯å—çº§ä½œç”¨åŸŸå†…<code>let</code>åˆå£°æ˜äº†ä¸€ä¸ªå±€éƒ¨å˜é‡<code>tmp</code>ï¼Œå¯¼è‡´åè€…ç»‘å®šè¿™ä¸ªå—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥åœ¨<code>let</code>å£°æ˜å˜é‡å‰ï¼Œå¯¹<code>tmp</code>èµ‹å€¼ä¼šæŠ¥é”™ã€‚</p>
<p>ES6æ˜ç¡®è§„å®šï¼Œå¦‚æœåŒºå—ä¸­å­˜åœ¨<code>let</code>å’Œ<code>const</code>å‘½ä»¤ï¼Œè¿™ä¸ªåŒºå—å¯¹è¿™äº›å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä»ä¸€å¼€å§‹å°±å½¢æˆäº†å°é—­ä½œç”¨åŸŸã€‚å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>æ€»ä¹‹ï¼Œåœ¨ä»£ç å—å†…ï¼Œä½¿ç”¨letå‘½ä»¤å£°æ˜å˜é‡ä¹‹å‰ï¼Œè¯¥å˜é‡éƒ½æ˜¯ä¸å¯ç”¨çš„ã€‚è¿™åœ¨è¯­æ³•ä¸Šï¼Œç§°ä¸ºâ€œæš‚æ—¶æ€§æ­»åŒºâ€ï¼ˆtemporal dead zoneï¼Œç®€ç§°TDZï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="comment">// TDZå¼€å§‹</span></div><div class="line">  tmp = <span class="string">'abc'</span>; <span class="comment">// ReferenceError</span></div><div class="line">  <span class="built_in">console</span>.log(tmp); <span class="comment">// ReferenceError</span></div><div class="line"></div><div class="line">  <span class="keyword">let</span> tmp; <span class="comment">// TDZç»“æŸ</span></div><div class="line">  <span class="built_in">console</span>.log(tmp); <span class="comment">// undefined</span></div><div class="line"></div><div class="line">  tmp = <span class="number">123</span>;</div><div class="line">  <span class="built_in">console</span>.log(tmp); <span class="comment">// 123</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåœ¨<code>let</code>å‘½ä»¤å£°æ˜å˜é‡<code>tmp</code>ä¹‹å‰ï¼Œéƒ½å±äºå˜é‡<code>tmp</code>çš„â€œæ­»åŒºâ€ã€‚</p>
<p>â€œæš‚æ—¶æ€§æ­»åŒºâ€ä¹Ÿæ„å‘³ç€<code>typeof</code>ä¸å†æ˜¯ä¸€ä¸ªç™¾åˆ†ä¹‹ç™¾å®‰å…¨çš„æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> x; <span class="comment">// ReferenceError</span></div><div class="line"><span class="keyword">let</span> x;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>x</code>ä½¿ç”¨<code>let</code>å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥åœ¨å£°æ˜ä¹‹å‰ï¼Œéƒ½å±äº<code>x</code>çš„â€œæ­»åŒºâ€ï¼Œåªè¦ç”¨åˆ°è¯¥å˜é‡å°±ä¼šæŠ¥é”™ã€‚å› æ­¤ï¼Œ<code>typeof</code>è¿è¡Œæ—¶å°±ä¼šæŠ›å‡ºä¸€ä¸ª<code>ReferenceError</code>ã€‚</p>
<p>ä½œä¸ºæ¯”è¾ƒï¼Œå¦‚æœä¸€ä¸ªå˜é‡æ ¹æœ¬æ²¡æœ‰è¢«å£°æ˜ï¼Œä½¿ç”¨<code>typeof</code>åè€Œä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> undeclared_variable <span class="comment">// "undefined"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>undeclared_variable</code>æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡åï¼Œç»“æœè¿”å›â€œundefinedâ€ã€‚æ‰€ä»¥ï¼Œåœ¨æ²¡æœ‰<code>let</code>ä¹‹å‰ï¼Œ<code>typeof</code>è¿ç®—ç¬¦æ˜¯ç™¾åˆ†ä¹‹ç™¾å®‰å…¨çš„ï¼Œæ°¸è¿œä¸ä¼šæŠ¥é”™ã€‚ç°åœ¨è¿™ä¸€ç‚¹ä¸æˆç«‹äº†ã€‚è¿™æ ·çš„è®¾è®¡æ˜¯ä¸ºäº†è®©å¤§å®¶å…»æˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œå˜é‡ä¸€å®šè¦åœ¨å£°æ˜ä¹‹åä½¿ç”¨ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p>
<p>æœ‰äº›â€œæ­»åŒºâ€æ¯”è¾ƒéšè”½ï¼Œä¸å¤ªå®¹æ˜“å‘ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">x = y, y = <span class="number">2</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">bar(); <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>bar</code>å‡½æ•°ä¹‹æ‰€ä»¥æŠ¥é”™ï¼ˆæŸäº›å®ç°å¯èƒ½ä¸æŠ¥é”™ï¼‰ï¼Œæ˜¯å› ä¸ºå‚æ•°<code>x</code>é»˜è®¤å€¼ç­‰äºå¦ä¸€ä¸ªå‚æ•°<code>y</code>ï¼Œè€Œæ­¤æ—¶<code>y</code>è¿˜æ²¡æœ‰å£°æ˜ï¼Œå±äºâ€æ­»åŒºâ€œã€‚å¦‚æœ<code>y</code>çš„é»˜è®¤å€¼æ˜¯<code>x</code>ï¼Œå°±ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶<code>x</code>å·²ç»å£°æ˜äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">x = <span class="number">2</span>, y = x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line">bar(); <span class="comment">// [2, 2]</span></div></pre></td></tr></table></figure>
<p>ES6è§„å®šæš‚æ—¶æ€§æ­»åŒºå’Œ<code>let</code>ã€<code>const</code>è¯­å¥ä¸å‡ºç°å˜é‡æå‡ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‡å°‘è¿è¡Œæ—¶é”™è¯¯ï¼Œé˜²æ­¢åœ¨å˜é‡å£°æ˜å‰å°±ä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œä»è€Œå¯¼è‡´æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºã€‚è¿™æ ·çš„é”™è¯¯åœ¨ES5æ˜¯å¾ˆå¸¸è§çš„ï¼Œç°åœ¨æœ‰äº†è¿™ç§è§„å®šï¼Œé¿å…æ­¤ç±»é”™è¯¯å°±å¾ˆå®¹æ˜“äº†ã€‚</p>
<p>æ€»ä¹‹ï¼Œæš‚æ—¶æ€§æ­»åŒºçš„æœ¬è´¨å°±æ˜¯ï¼Œåªè¦ä¸€è¿›å…¥å½“å‰ä½œç”¨åŸŸï¼Œæ‰€è¦ä½¿ç”¨çš„å˜é‡å°±å·²ç»å­˜åœ¨äº†ï¼Œä½†æ˜¯ä¸å¯è·å–ï¼Œåªæœ‰ç­‰åˆ°å£°æ˜å˜é‡çš„é‚£ä¸€è¡Œä»£ç å‡ºç°ï¼Œæ‰å¯ä»¥è·å–å’Œä½¿ç”¨è¯¥å˜é‡ã€‚</p>
<h3 id="ä¸å…è®¸é‡å¤å£°æ˜"><a href="#ä¸å…è®¸é‡å¤å£°æ˜" class="headerlink" title="ä¸å…è®¸é‡å¤å£°æ˜"></a>ä¸å…è®¸é‡å¤å£°æ˜</h3><p>letä¸å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…ï¼Œé‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨é‡æ–°å£°æ˜å‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> arg; <span class="comment">// æŠ¥é”™</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">let</span> arg; <span class="comment">// ä¸æŠ¥é”™</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å—çº§ä½œç”¨åŸŸ"><a href="#å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å—çº§ä½œç”¨åŸŸ"></a>å—çº§ä½œç”¨åŸŸ</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ</h3><p>ES5åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸åˆç†çš„åœºæ™¯ã€‚</p>
<p>ç¬¬ä¸€ç§åœºæ™¯ï¼Œå†…å±‚å˜é‡å¯èƒ½ä¼šè¦†ç›–å¤–å±‚å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tmp = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(tmp);</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="keyword">var</span> tmp = <span class="string">"hello world"</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(); <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fæ‰§è¡Œåï¼Œè¾“å‡ºç»“æœä¸º<code>undefined</code>ï¼ŒåŸå› åœ¨äºå˜é‡æå‡ï¼Œå¯¼è‡´å†…å±‚çš„tmpå˜é‡è¦†ç›–äº†å¤–å±‚çš„tmpå˜é‡ã€‚</p>
<p>ç¬¬äºŒç§åœºæ™¯ï¼Œç”¨æ¥è®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'hello'</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; s.length; i++) &#123;</div><div class="line">  <span class="built_in">console</span>.log(s[i]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(i); <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡iåªç”¨æ¥æ§åˆ¶å¾ªç¯ï¼Œä½†æ˜¯å¾ªç¯ç»“æŸåï¼Œå®ƒå¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œæ³„éœ²æˆäº†å…¨å±€å˜é‡ã€‚</p>
<h3 id="ES6çš„å—çº§ä½œç”¨åŸŸ"><a href="#ES6çš„å—çº§ä½œç”¨åŸŸ" class="headerlink" title="ES6çš„å—çº§ä½œç”¨åŸŸ"></a>ES6çš„å—çº§ä½œç”¨åŸŸ</h3><p><code>let</code>å®é™…ä¸Šä¸ºJavaScriptæ–°å¢äº†å—çº§ä½œç”¨åŸŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> n = <span class="number">5</span>;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">let</span> n = <span class="number">10</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(n); <span class="comment">// 5</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å‡½æ•°æœ‰ä¸¤ä¸ªä»£ç å—ï¼Œéƒ½å£°æ˜äº†å˜é‡<code>n</code>ï¼Œè¿è¡Œåè¾“å‡º5ã€‚è¿™è¡¨ç¤ºå¤–å±‚ä»£ç å—ä¸å—å†…å±‚ä»£ç å—çš„å½±å“ã€‚å¦‚æœä½¿ç”¨<code>var</code>å®šä¹‰å˜é‡<code>n</code>ï¼Œæœ€åè¾“å‡ºçš„å€¼å°±æ˜¯10ã€‚</p>
<p>ES6å…è®¸å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;&#123;&#123;&#123;<span class="keyword">let</span> insane = <span class="string">'Hello World'</span>&#125;&#125;&#125;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨äº†ä¸€ä¸ªäº”å±‚çš„å—çº§ä½œç”¨åŸŸã€‚å¤–å±‚ä½œç”¨åŸŸæ— æ³•è¯»å–å†…å±‚ä½œç”¨åŸŸçš„å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;&#123;&#123;</div><div class="line">  &#123;<span class="keyword">let</span> insane = <span class="string">'Hello World'</span>&#125;</div><div class="line">  <span class="built_in">console</span>.log(insane); <span class="comment">// æŠ¥é”™</span></div><div class="line">&#125;&#125;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>å†…å±‚ä½œç”¨åŸŸå¯ä»¥å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„åŒåå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;&#123;&#123;</div><div class="line">  <span class="keyword">let</span> insane = <span class="string">'Hello World'</span>;</div><div class="line">  &#123;<span class="keyword">let</span> insane = <span class="string">'Hello World'</span>&#125;</div><div class="line">&#125;&#125;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>å—çº§ä½œç”¨åŸŸçš„å‡ºç°ï¼Œå®é™…ä¸Šä½¿å¾—è·å¾—å¹¿æ³›åº”ç”¨çš„ç«‹å³æ‰§è¡ŒåŒ¿åå‡½æ•°ï¼ˆIIFEï¼‰ä¸å†å¿…è¦äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// IIFEå†™æ³•</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> tmp = ...;</div><div class="line">  ...</div><div class="line">&#125;());</div><div class="line"></div><div class="line"><span class="comment">// å—çº§ä½œç”¨åŸŸå†™æ³•</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> tmp = ...;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜"><a href="#å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜" class="headerlink" title="å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜"></a>å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜</h3><p>å‡½æ•°èƒ½ä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œæ˜¯ä¸€ä¸ªç›¸å½“ä»¤äººæ··æ·†çš„é—®é¢˜ã€‚</p>
<p>ES5è§„å®šï¼Œå‡½æ•°åªèƒ½åœ¨é¡¶å±‚ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸå£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æƒ…å†µä¸€</span></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æƒ…å†µäºŒ</span></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ä¸¤ç§å‡½æ•°å£°æ˜ï¼Œæ ¹æ®ES5çš„è§„å®šéƒ½æ˜¯éæ³•çš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œæµè§ˆå™¨æ²¡æœ‰éµå®ˆè¿™ä¸ªè§„å®šï¼Œè¿˜æ˜¯æ”¯æŒåœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ï¼Œå› æ­¤ä¸Šé¢ä¸¤ç§æƒ…å†µå®é™…éƒ½èƒ½è¿è¡Œï¼Œä¸ä¼šæŠ¥é”™ã€‚ä¸è¿‡ï¼Œâ€œä¸¥æ ¼æ¨¡å¼â€ä¸‹è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5ä¸¥æ ¼æ¨¡å¼</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ES6å¼•å…¥äº†å—çº§ä½œç”¨åŸŸï¼Œæ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6ä¸¥æ ¼æ¨¡å¼</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ä¸æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>å¹¶ä¸”ES6è§„å®šï¼Œå—çº§ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå‡½æ•°å£°æ˜è¯­å¥çš„è¡Œä¸ºç±»ä¼¼äº<code>let</code>ï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–ä¸å¯å¼•ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="comment">// é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•°f</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ES5ä¸­è¿è¡Œï¼Œä¼šå¾—åˆ°â€œI am inside!â€ï¼Œå› ä¸ºåœ¨<code>if</code>å†…å£°æ˜çš„å‡½æ•°<code>f</code>ä¼šè¢«æå‡åˆ°å‡½æ•°å¤´éƒ¨ï¼Œå®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5ç‰ˆæœ¬</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">  &#125;</div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>ES6çš„è¿è¡Œç»“æœå°±å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œä¼šå¾—åˆ°â€œI am outside!â€ã€‚å› ä¸ºå—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°ç±»ä¼¼äº<code>let</code>ï¼Œå¯¹ä½œç”¨åŸŸä¹‹å¤–æ²¡æœ‰å½±å“ï¼Œå®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6ç‰ˆæœ¬</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ç§è¡Œä¸ºå·®å¼‚ä¼šå¯¹è€ä»£ç äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚ä¸ºäº†å‡è½»å› æ­¤äº§ç”Ÿçš„ä¸å…¼å®¹é—®é¢˜ï¼ŒES6åœ¨<a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-block-level-function-declarations-web-legacy-compatibility-semantics" target="_blank" rel="external">é™„å½•B</a>é‡Œé¢è§„å®šï¼Œæµè§ˆå™¨çš„å®ç°å¯ä»¥ä¸éµå®ˆä¸Šé¢çš„è§„å®šï¼Œæœ‰è‡ªå·±çš„<a href="http://stackoverflow.com/questions/31419897/what-are-the-precise-semantics-of-block-level-functions-in-es6" target="_blank" rel="external">è¡Œä¸ºæ–¹å¼</a>ã€‚</p>
<ul>
<li>å…è®¸åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚</li>
<li>å‡½æ•°å£°æ˜ç±»ä¼¼äº<code>var</code>ï¼Œå³ä¼šæå‡åˆ°å…¨å±€ä½œç”¨åŸŸæˆ–å‡½æ•°ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚</li>
<li>åŒæ—¶ï¼Œå‡½æ•°å£°æ˜è¿˜ä¼šæå‡åˆ°æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚</li>
</ul>
<p>æ³¨æ„ï¼Œä¸Šé¢ä¸‰æ¡è§„åˆ™åªå¯¹ES6çš„æµè§ˆå™¨å®ç°æœ‰æ•ˆï¼Œå…¶ä»–ç¯å¢ƒçš„å®ç°ä¸ç”¨éµå®ˆï¼Œè¿˜æ˜¯å°†å—çº§ä½œç”¨åŸŸçš„å‡½æ•°å£°æ˜å½“ä½œ<code>let</code>å¤„ç†ã€‚</p>
<p>å‰é¢é‚£æ®µä»£ç ï¼Œåœ¨Chromeç¯å¢ƒä¸‹è¿è¡Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6çš„æµè§ˆå™¨ç¯å¢ƒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="comment">// é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•°f</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div><div class="line"><span class="comment">// Uncaught TypeError: f is not a function</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç æŠ¥é”™ï¼Œæ˜¯å› ä¸ºå®é™…è¿è¡Œçš„æ˜¯ä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6çš„æµè§ˆå™¨ç¯å¢ƒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> f = <span class="literal">undefined</span>;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div><div class="line"><span class="comment">// Uncaught TypeError: f is not a function</span></div></pre></td></tr></table></figure>
<p>è€ƒè™‘åˆ°ç¯å¢ƒå¯¼è‡´çš„è¡Œä¸ºå·®å¼‚å¤ªå¤§ï¼Œåº”è¯¥é¿å…åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å¦‚æœç¡®å®éœ€è¦ï¼Œä¹Ÿåº”è¯¥å†™æˆå‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯å‡½æ•°å£°æ˜è¯­å¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‡½æ•°å£°æ˜è¯­å¥</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="string">'secret'</span>;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="string">'secret'</span>;</div><div class="line">  <span class="keyword">let</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ES6çš„å—çº§ä½œç”¨åŸŸå…è®¸å£°æ˜å‡½æ•°çš„è§„åˆ™ï¼Œåªåœ¨ä½¿ç”¨å¤§æ‹¬å·çš„æƒ…å†µä¸‹æˆç«‹ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸æŠ¥é”™</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>)</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div></pre></td></tr></table></figure>
<h2 id="constå‘½ä»¤"><a href="#constå‘½ä»¤" class="headerlink" title="constå‘½ä»¤"></a>constå‘½ä»¤</h2><p><code>const</code>å£°æ˜ä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> PI = <span class="number">3.1415</span>;</div><div class="line">PI <span class="comment">// 3.1415</span></div><div class="line"></div><div class="line">PI = <span class="number">3</span>;</div><div class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜æ”¹å˜å¸¸é‡çš„å€¼ä¼šæŠ¥é”™ã€‚</p>
<p><code>const</code>å£°æ˜çš„å˜é‡ä¸å¾—æ”¹å˜å€¼ï¼Œè¿™æ„å‘³ç€ï¼Œconstä¸€æ—¦å£°æ˜å˜é‡ï¼Œå°±å¿…é¡»ç«‹å³åˆå§‹åŒ–ï¼Œä¸èƒ½ç•™åˆ°ä»¥åèµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo;</div><div class="line"><span class="comment">// SyntaxError: Missing initializer in const declaration</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯¹äº<code>const</code>æ¥è¯´ï¼Œåªå£°æ˜ä¸èµ‹å€¼ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p><code>const</code>çš„ä½œç”¨åŸŸä¸<code>let</code>å‘½ä»¤ç›¸åŒï¼šåªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="keyword">const</span> MAX = <span class="number">5</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">MAX <span class="comment">// Uncaught ReferenceError: MAX is not defined</span></div></pre></td></tr></table></figure>
<p><code>const</code>å‘½ä»¤å£°æ˜çš„å¸¸é‡ä¹Ÿæ˜¯ä¸æå‡ï¼ŒåŒæ ·å­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼Œåªèƒ½åœ¨å£°æ˜çš„ä½ç½®åé¢ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(MAX); <span class="comment">// ReferenceError</span></div><div class="line">  <span class="keyword">const</span> MAX = <span class="number">5</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨å¸¸é‡<code>MAX</code>å£°æ˜ä¹‹å‰å°±è°ƒç”¨ï¼Œç»“æœæŠ¥é”™ã€‚</p>
<p><code>const</code>å£°æ˜çš„å¸¸é‡ï¼Œä¹Ÿä¸<code>let</code>ä¸€æ ·ä¸å¯é‡å¤å£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> message = <span class="string">"Hello!"</span>;</div><div class="line"><span class="keyword">let</span> age = <span class="number">25</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä»¥ä¸‹ä¸¤è¡Œéƒ½ä¼šæŠ¥é”™</span></div><div class="line"><span class="keyword">const</span> message = <span class="string">"Goodbye!"</span>;</div><div class="line"><span class="keyword">const</span> age = <span class="number">30</span>;</div></pre></td></tr></table></figure>
<p>å¯¹äºå¤åˆç±»å‹çš„å˜é‡ï¼Œå˜é‡åä¸æŒ‡å‘æ•°æ®ï¼Œè€Œæ˜¯æŒ‡å‘æ•°æ®æ‰€åœ¨çš„åœ°å€ã€‚<code>const</code>å‘½ä»¤åªæ˜¯ä¿è¯å˜é‡åæŒ‡å‘çš„åœ°å€ä¸å˜ï¼Œå¹¶ä¸ä¿è¯è¯¥åœ°å€çš„æ•°æ®ä¸å˜ï¼Œæ‰€ä»¥å°†ä¸€ä¸ªå¯¹è±¡å£°æ˜ä¸ºå¸¸é‡å¿…é¡»éå¸¸å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo = &#123;&#125;;</div><div class="line">foo.prop = <span class="number">123</span>;</div><div class="line"></div><div class="line">foo.prop</div><div class="line"><span class="comment">// 123</span></div><div class="line"></div><div class="line">foo = &#123;&#125;; <span class="comment">// TypeError: "foo" is read-only</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡<code>foo</code>å‚¨å­˜çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚ä¸å¯å˜çš„åªæ˜¯è¿™ä¸ªåœ°å€ï¼Œå³ä¸èƒ½æŠŠ<code>foo</code>æŒ‡å‘å¦ä¸€ä¸ªåœ°å€ï¼Œä½†å¯¹è±¡æœ¬èº«æ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ä¸ºå…¶æ·»åŠ æ–°å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> a = [];</div><div class="line">a.push(<span class="string">'Hello'</span>); <span class="comment">// å¯æ‰§è¡Œ</span></div><div class="line">a.length = <span class="number">0</span>;    <span class="comment">// å¯æ‰§è¡Œ</span></div><div class="line">a = [<span class="string">'Dave'</span>];    <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡<code>a</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„æœ¬èº«æ˜¯å¯å†™çš„ï¼Œä½†æ˜¯å¦‚æœå°†å¦ä¸€ä¸ªæ•°ç»„èµ‹å€¼ç»™<code>a</code>ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>å¦‚æœçœŸçš„æƒ³å°†å¯¹è±¡å†»ç»“ï¼Œåº”è¯¥ä½¿ç”¨<code>Object.freeze</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo = <span class="built_in">Object</span>.freeze(&#123;&#125;);</div><div class="line"></div><div class="line"><span class="comment">// å¸¸è§„æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¸èµ·ä½œç”¨ï¼›</span></div><div class="line"><span class="comment">// ä¸¥æ ¼æ¨¡å¼æ—¶ï¼Œè¯¥è¡Œä¼šæŠ¥é”™</span></div><div class="line">foo.prop = <span class="number">123</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡<code>foo</code>æŒ‡å‘ä¸€ä¸ªå†»ç»“çš„å¯¹è±¡ï¼Œæ‰€ä»¥æ·»åŠ æ–°å±æ€§ä¸èµ·ä½œç”¨ï¼Œä¸¥æ ¼æ¨¡å¼æ—¶è¿˜ä¼šæŠ¥é”™ã€‚</p>
<p>é™¤äº†å°†å¯¹è±¡æœ¬èº«å†»ç»“ï¼Œå¯¹è±¡çš„å±æ€§ä¹Ÿåº”è¯¥å†»ç»“ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å¯¹è±¡å½»åº•å†»ç»“çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> constantize = <span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">Object</span>.freeze(obj);</div><div class="line">  <span class="built_in">Object</span>.keys(obj).forEach( <span class="function">(<span class="params">key, value</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span> ) &#123;</div><div class="line">      constantize( obj[key] );</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ES5åªæœ‰ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼š<code>var</code>å‘½ä»¤å’Œ<code>function</code>å‘½ä»¤ã€‚ES6é™¤äº†æ·»åŠ <code>let</code>å’Œ<code>const</code>å‘½ä»¤ï¼Œåé¢ç« èŠ‚è¿˜ä¼šæåˆ°ï¼Œå¦å¤–ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼š<code>import</code>å‘½ä»¤å’Œ<code>class</code>å‘½ä»¤ã€‚æ‰€ä»¥ï¼ŒES6ä¸€å…±æœ‰6ç§å£°æ˜å˜é‡çš„æ–¹æ³•ã€‚</p>
<h2 id="é¡¶å±‚å¯¹è±¡çš„å±æ€§"><a href="#é¡¶å±‚å¯¹è±¡çš„å±æ€§" class="headerlink" title="é¡¶å±‚å¯¹è±¡çš„å±æ€§"></a>é¡¶å±‚å¯¹è±¡çš„å±æ€§</h2><p>é¡¶å±‚å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒæŒ‡çš„æ˜¯<code>window</code>å¯¹è±¡ï¼Œåœ¨NodeæŒ‡çš„æ˜¯<code>global</code>å¯¹è±¡ã€‚ES5ä¹‹ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æ˜¯ç­‰ä»·çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.a = <span class="number">1</span>;</div><div class="line">a <span class="comment">// 1</span></div><div class="line"></div><div class="line">a = <span class="number">2</span>;</div><div class="line"><span class="built_in">window</span>.a <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§èµ‹å€¼ä¸å…¨å±€å˜é‡çš„èµ‹å€¼ï¼Œæ˜¯åŒä¸€ä»¶äº‹ã€‚</p>
<p>é¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æŒ‚é’©ï¼Œè¢«è®¤ä¸ºæ˜¯JavaScriptè¯­è¨€æœ€å¤§çš„è®¾è®¡è´¥ç¬”ä¹‹ä¸€ã€‚è¿™æ ·çš„è®¾è®¡å¸¦æ¥äº†å‡ ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œé¦–å…ˆæ˜¯æ²¡æ³•åœ¨ç¼–è¯‘æ—¶å°±æŠ¥å‡ºå˜é‡æœªå£°æ˜çš„é”™è¯¯ï¼Œåªæœ‰è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“ï¼ˆå› ä¸ºå…¨å±€å˜é‡å¯èƒ½æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§åˆ›é€ çš„ï¼Œè€Œå±æ€§çš„åˆ›é€ æ˜¯åŠ¨æ€çš„ï¼‰ï¼›å…¶æ¬¡ï¼Œç¨‹åºå‘˜å¾ˆå®¹æ˜“ä¸çŸ¥ä¸è§‰åœ°å°±åˆ›å»ºäº†å…¨å±€å˜é‡ï¼ˆæ¯”å¦‚æ‰“å­—å‡ºé”™ï¼‰ï¼›æœ€åï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§æ˜¯åˆ°å¤„å¯ä»¥è¯»å†™çš„ï¼Œè¿™éå¸¸ä¸åˆ©äºæ¨¡å—åŒ–ç¼–ç¨‹ã€‚å¦ä¸€æ–¹é¢ï¼Œ<code>window</code>å¯¹è±¡æœ‰å®ä½“å«ä¹‰ï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨çš„çª—å£å¯¹è±¡ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ä¸€ä¸ªæœ‰å®ä½“å«ä¹‰çš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸åˆé€‚çš„ã€‚</p>
<p>ES6ä¸ºäº†æ”¹å˜è¿™ä¸€ç‚¹ï¼Œä¸€æ–¹é¢è§„å®šï¼Œä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œ<code>var</code>å‘½ä»¤å’Œ<code>function</code>å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼›å¦ä¸€æ–¹é¢è§„å®šï¼Œ<code>let</code>å‘½ä»¤ã€<code>const</code>å‘½ä»¤ã€<code>class</code>å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¸å±äºé¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»ES6å¼€å§‹ï¼Œå…¨å±€å˜é‡å°†é€æ­¥ä¸é¡¶å±‚å¯¹è±¡çš„å±æ€§è„±é’©ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="comment">// å¦‚æœåœ¨Nodeçš„REPLç¯å¢ƒï¼Œå¯ä»¥å†™æˆglobal.a</span></div><div class="line"><span class="comment">// æˆ–è€…é‡‡ç”¨é€šç”¨æ–¹æ³•ï¼Œå†™æˆthis.a</span></div><div class="line"><span class="built_in">window</span>.a <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="number">1</span>;</div><div class="line"><span class="built_in">window</span>.b <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå…¨å±€å˜é‡<code>a</code>ç”±<code>var</code>å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥å®ƒæ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼›å…¨å±€å˜é‡<code>b</code>ç”±<code>let</code>å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼Œè¿”å›<code>undefined</code>ã€‚</p>
<h2 id="é¡¶å±‚å¯¹è±¡"><a href="#é¡¶å±‚å¯¹è±¡" class="headerlink" title="é¡¶å±‚å¯¹è±¡"></a>é¡¶å±‚å¯¹è±¡</h2><p>ES5çš„é¡¶å±‚å¯¹è±¡ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒåœ¨å„ç§å®ç°é‡Œé¢æ˜¯ä¸ç»Ÿä¸€çš„ã€‚</p>
<ul>
<li>æµè§ˆå™¨é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯<code>window</code>ï¼Œä½†Nodeå’ŒWeb Workeræ²¡æœ‰<code>window</code>ã€‚</li>
<li>æµè§ˆå™¨å’ŒWeb Workeré‡Œé¢ï¼Œ<code>self</code>ä¹ŸæŒ‡å‘é¡¶å±‚å¯¹è±¡ï¼Œä½†æ˜¯Nodeæ²¡æœ‰<code>self</code>ã€‚</li>
<li>Nodeé‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯<code>global</code>ï¼Œä½†å…¶ä»–ç¯å¢ƒéƒ½ä¸æ”¯æŒã€‚</li>
</ul>
<p>åŒä¸€æ®µä»£ç ä¸ºäº†èƒ½å¤Ÿåœ¨å„ç§ç¯å¢ƒï¼Œéƒ½èƒ½å–åˆ°é¡¶å±‚å¯¹è±¡ï¼Œç°åœ¨ä¸€èˆ¬æ˜¯ä½¿ç”¨<code>this</code>å˜é‡ï¼Œä½†æ˜¯æœ‰å±€é™æ€§ã€‚</p>
<ul>
<li>å…¨å±€ç¯å¢ƒä¸­ï¼Œ<code>this</code>ä¼šè¿”å›é¡¶å±‚å¯¹è±¡ã€‚ä½†æ˜¯ï¼ŒNodeæ¨¡å—å’ŒES6æ¨¡å—ä¸­ï¼Œ<code>this</code>è¿”å›çš„æ˜¯å½“å‰æ¨¡å—ã€‚</li>
<li>å‡½æ•°é‡Œé¢çš„<code>this</code>ï¼Œå¦‚æœå‡½æ•°ä¸æ˜¯ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¿è¡Œï¼Œè€Œæ˜¯å•çº¯ä½œä¸ºå‡½æ•°è¿è¡Œï¼Œ<code>this</code>ä¼šæŒ‡å‘é¡¶å±‚å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™æ—¶<code>this</code>ä¼šè¿”å›<code>undefined</code>ã€‚</li>
<li>ä¸ç®¡æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œè¿˜æ˜¯æ™®é€šæ¨¡å¼ï¼Œ<code>new Function(&#39;return this&#39;)()</code>ï¼Œæ€»æ˜¯ä¼šè¿”å›å…¨å±€å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœæµè§ˆå™¨ç”¨äº†CSPï¼ˆContent Security Policyï¼Œå†…å®¹å®‰å…¨æ”¿ç­–ï¼‰ï¼Œé‚£ä¹ˆ<code>eval</code>ã€<code>new Function</code>è¿™äº›æ–¹æ³•éƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ã€‚</li>
</ul>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¾ˆéš¾æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œéƒ½å–åˆ°é¡¶å±‚å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸¤ç§å‹‰å¼ºå¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ–¹æ³•ä¸€</span></div><div class="line">(<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span></div><div class="line">   ? <span class="built_in">window</span></div><div class="line">   : (<span class="keyword">typeof</span> process === <span class="string">'object'</span> &amp;&amp;</div><div class="line">      <span class="keyword">typeof</span> <span class="built_in">require</span> === <span class="string">'function'</span> &amp;&amp;</div><div class="line">      <span class="keyword">typeof</span> global === <span class="string">'object'</span>)</div><div class="line">     ? global</div><div class="line">     : <span class="keyword">this</span>);</div><div class="line"></div><div class="line"><span class="comment">// æ–¹æ³•äºŒ</span></div><div class="line"><span class="keyword">var</span> getGlobal = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> self !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> self; &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> <span class="built_in">window</span>; &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> global !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> global; &#125;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'unable to locate global object'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç°åœ¨æœ‰ä¸€ä¸ª<a href="https://github.com/tc39/proposal-global" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œåœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ï¼Œå¼•å…¥<code>global</code>ä½œä¸ºé¡¶å±‚å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰€æœ‰ç¯å¢ƒä¸‹ï¼Œ<code>global</code>éƒ½æ˜¯å­˜åœ¨çš„ï¼Œéƒ½å¯ä»¥ä»å®ƒæ‹¿åˆ°é¡¶å±‚å¯¹è±¡ã€‚</p>
<p>å«ç‰‡åº“<a href="https://github.com/ljharb/System.global" target="_blank" rel="external"><code>system.global</code></a>æ¨¡æ‹Ÿäº†è¿™ä¸ªææ¡ˆï¼Œå¯ä»¥åœ¨æ‰€æœ‰ç¯å¢ƒæ‹¿åˆ°<code>global</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// CommonJSçš„å†™æ³•</span></div><div class="line"><span class="built_in">require</span>(<span class="string">'system.global/shim'</span>)();</div><div class="line"></div><div class="line"><span class="comment">// ES6æ¨¡å—çš„å†™æ³•</span></div><div class="line"><span class="keyword">import</span> shim <span class="keyword">from</span> <span class="string">'system.global/shim'</span>; shim();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯ä»¥ä¿è¯å„ç§ç¯å¢ƒé‡Œé¢ï¼Œ<code>global</code>å¯¹è±¡éƒ½æ˜¯å­˜åœ¨çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// CommonJSçš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> global = <span class="built_in">require</span>(<span class="string">'system.global'</span>)();</div><div class="line"></div><div class="line"><span class="comment">// ES6æ¨¡å—çš„å†™æ³•</span></div><div class="line"><span class="keyword">import</span> getGlobal <span class="keyword">from</span> <span class="string">'system.global'</span>;</div><div class="line"><span class="keyword">const</span> global = getGlobal();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†é¡¶å±‚å¯¹è±¡æ”¾å…¥å˜é‡<code>global</code>ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;letå‘½ä»¤&quot;&gt;&lt;a href=&quot;#letå‘½ä»¤&quot; class=&quot;headerlink&quot; title=&quot;letå‘½ä»¤&quot;&gt;&lt;/a&gt;letå‘½ä»¤&lt;/h2&gt;&lt;h3 id=&quot;åŸºæœ¬ç”¨æ³•&quot;&gt;&lt;a href=&quot;#åŸºæœ¬ç”¨æ³•&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬ç”¨æ³•&quot;&gt;&lt;/a&gt;åŸºæœ¬ç”¨æ³•&lt;/h3&gt;&lt;p&gt;ES6æ–°å¢äº†&lt;code&gt;let&lt;/code&gt;å‘½ä»¤ï¼Œç”¨æ¥å£°æ˜å˜é‡ã€‚å®ƒçš„ç”¨æ³•ç±»ä¼¼äº&lt;code&gt;var&lt;/code&gt;ï¼Œä½†æ˜¯æ‰€å£°æ˜çš„å˜é‡ï¼Œåªåœ¨&lt;code&gt;let&lt;/code&gt;å‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; a = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; b = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a &lt;span class=&quot;comment&quot;&gt;// ReferenceError: a is not defined.&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;b &lt;span class=&quot;comment&quot;&gt;// 1&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç åœ¨ä»£ç å—ä¹‹ä¸­ï¼Œåˆ†åˆ«ç”¨&lt;code&gt;let&lt;/code&gt;å’Œ&lt;code&gt;var&lt;/code&gt;å£°æ˜äº†ä¸¤ä¸ªå˜é‡ã€‚ç„¶ååœ¨ä»£ç å—ä¹‹å¤–è°ƒç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œç»“æœ&lt;code&gt;let&lt;/code&gt;å£°æ˜çš„å˜é‡æŠ¥é”™ï¼Œ&lt;code&gt;var&lt;/code&gt;å£°æ˜çš„å˜é‡è¿”å›äº†æ­£ç¡®çš„å€¼ã€‚è¿™è¡¨æ˜ï¼Œ&lt;code&gt;let&lt;/code&gt;å£°æ˜çš„å˜é‡åªåœ¨å®ƒæ‰€åœ¨çš„ä»£ç å—æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;for&lt;/code&gt;å¾ªç¯çš„è®¡æ•°å™¨ï¼Œå°±å¾ˆåˆé€‚ä½¿ç”¨&lt;code&gt;let&lt;/code&gt;å‘½ä»¤ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;; i++) &amp;#123;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//ReferenceError: i is not defined&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç ä¸­ï¼Œè®¡æ•°å™¨&lt;code&gt;i&lt;/code&gt;åªåœ¨&lt;code&gt;for&lt;/code&gt;å¾ªç¯ä½“å†…æœ‰æ•ˆï¼Œåœ¨å¾ªç¯ä½“å¤–å¼•ç”¨å°±ä¼šæŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç å¦‚æœä½¿ç”¨&lt;code&gt;var&lt;/code&gt;ï¼Œæœ€åè¾“å‡ºçš„æ˜¯10ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = [];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;; i++) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  a[i] = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &amp;#125;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;a[&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;](); &lt;span class=&quot;comment&quot;&gt;// 10&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡&lt;code&gt;i&lt;/code&gt;æ˜¯&lt;code&gt;var&lt;/code&gt;å£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚æ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯ï¼Œæ–°çš„&lt;code&gt;i&lt;/code&gt;å€¼éƒ½ä¼šè¦†ç›–æ—§å€¼ï¼Œå¯¼è‡´æœ€åè¾“å‡ºçš„æ˜¯æœ€åä¸€è½®çš„&lt;code&gt;i&lt;/code&gt;çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨&lt;code&gt;let&lt;/code&gt;ï¼Œå£°æ˜çš„å˜é‡ä»…åœ¨å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œæœ€åè¾“å‡ºçš„æ˜¯6ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="ECMAScript 6" scheme="https://ailley.github.io/tags/ECMAScript-6/"/>
    
  </entry>
  
  <entry>
    <title>ECMAScript 6ç®€ä»‹</title>
    <link href="https://ailley.github.io/2016/10/25/ECMAScript%206%E7%AE%80%E4%BB%8B/"/>
    <id>https://ailley.github.io/2016/10/25/ECMAScript 6ç®€ä»‹/</id>
    <published>2016-10-25T00:45:29.000Z</published>
    <updated>2016-10-25T00:52:39.298Z</updated>
    
    <content type="html"><![CDATA[<p>ECMAScript 6.0ï¼ˆä»¥ä¸‹ç®€ç§°ES6ï¼‰æ˜¯JavaScriptè¯­è¨€çš„ä¸‹ä¸€ä»£æ ‡å‡†ï¼Œå·²ç»åœ¨2015å¹´6æœˆæ­£å¼å‘å¸ƒäº†ã€‚å®ƒçš„ç›®æ ‡ï¼Œæ˜¯ä½¿å¾—JavaScriptè¯­è¨€å¯ä»¥ç”¨æ¥ç¼–å†™å¤æ‚çš„å¤§å‹åº”ç”¨ç¨‹åºï¼Œæˆä¸ºä¼ä¸šçº§å¼€å‘è¯­è¨€ã€‚</p>
<h2 id="ECMAScriptå’ŒJavaScriptçš„å…³ç³»"><a href="#ECMAScriptå’ŒJavaScriptçš„å…³ç³»" class="headerlink" title="ECMAScriptå’ŒJavaScriptçš„å…³ç³»"></a>ECMAScriptå’ŒJavaScriptçš„å…³ç³»</h2><p>ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ï¼ŒECMAScriptå’ŒJavaScriptåˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>
<p>è¦è®²æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å›é¡¾å†å²ã€‚1996å¹´11æœˆï¼ŒJavaScriptçš„åˆ›é€ è€…Netscapeå…¬å¸ï¼Œå†³å®šå°†JavaScriptæäº¤ç»™å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ECMAï¼Œå¸Œæœ›è¿™ç§è¯­è¨€èƒ½å¤Ÿæˆä¸ºå›½é™…æ ‡å‡†ã€‚æ¬¡å¹´ï¼ŒECMAå‘å¸ƒ262å·æ ‡å‡†æ–‡ä»¶ï¼ˆECMA-262ï¼‰çš„ç¬¬ä¸€ç‰ˆï¼Œè§„å®šäº†æµè§ˆå™¨è„šæœ¬è¯­è¨€çš„æ ‡å‡†ï¼Œå¹¶å°†è¿™ç§è¯­è¨€ç§°ä¸ºECMAScriptï¼Œè¿™ä¸ªç‰ˆæœ¬å°±æ˜¯1.0ç‰ˆã€‚</p>
<p>è¯¥æ ‡å‡†ä»ä¸€å¼€å§‹å°±æ˜¯é’ˆå¯¹JavaScriptè¯­è¨€åˆ¶å®šçš„ï¼Œä½†æ˜¯ä¹‹æ‰€ä»¥ä¸å«JavaScriptï¼Œæœ‰ä¸¤ä¸ªåŸå› ã€‚ä¸€æ˜¯å•†æ ‡ï¼ŒJavaæ˜¯Sunå…¬å¸çš„å•†æ ‡ï¼Œæ ¹æ®æˆæƒåè®®ï¼Œåªæœ‰Netscapeå…¬å¸å¯ä»¥åˆæ³•åœ°ä½¿ç”¨JavaScriptè¿™ä¸ªåå­—ï¼Œä¸”JavaScriptæœ¬èº«ä¹Ÿå·²ç»è¢«Netscapeå…¬å¸æ³¨å†Œä¸ºå•†æ ‡ã€‚äºŒæ˜¯æƒ³ä½“ç°è¿™é—¨è¯­è¨€çš„åˆ¶å®šè€…æ˜¯ECMAï¼Œä¸æ˜¯Netscapeï¼Œè¿™æ ·æœ‰åˆ©äºä¿è¯è¿™é—¨è¯­è¨€çš„å¼€æ”¾æ€§å’Œä¸­ç«‹æ€§ã€‚</p>
<p>å› æ­¤ï¼ŒECMAScriptå’ŒJavaScriptçš„å…³ç³»æ˜¯ï¼Œå‰è€…æ˜¯åè€…çš„è§„æ ¼ï¼Œåè€…æ˜¯å‰è€…çš„ä¸€ç§å®ç°ï¼ˆå¦å¤–çš„ECMAScriptæ–¹è¨€è¿˜æœ‰Jscriptå’ŒActionScriptï¼‰ã€‚æ—¥å¸¸åœºåˆï¼Œè¿™ä¸¤ä¸ªè¯æ˜¯å¯ä»¥äº’æ¢çš„ã€‚</p>
<h2 id="ES6ä¸ECMAScript-2015çš„å…³ç³»"><a href="#ES6ä¸ECMAScript-2015çš„å…³ç³»" class="headerlink" title="ES6ä¸ECMAScript 2015çš„å…³ç³»"></a>ES6ä¸ECMAScript 2015çš„å…³ç³»</h2><p>åª’ä½“é‡Œé¢ç»å¸¸å¯ä»¥çœ‹åˆ°â€ECMAScript 2015â€œè¿™ä¸ªè¯ï¼Œå®ƒä¸ES6æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p>
<p>2011å¹´ï¼ŒECMAScript 5.1ç‰ˆå‘å¸ƒåï¼Œå°±å¼€å§‹åˆ¶å®š6.0ç‰ˆäº†ã€‚å› æ­¤ï¼Œâ€ES6â€è¿™ä¸ªè¯çš„åŸæ„ï¼Œå°±æ˜¯æŒ‡JavaScriptè¯­è¨€çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬ã€‚</p>
<p>ä½†æ˜¯ï¼Œå› ä¸ºè¿™ä¸ªç‰ˆæœ¬å¼•å…¥çš„è¯­æ³•åŠŸèƒ½å¤ªå¤šï¼Œè€Œä¸”åˆ¶å®šè¿‡ç¨‹å½“ä¸­ï¼Œè¿˜æœ‰å¾ˆå¤šç»„ç»‡å’Œä¸ªäººä¸æ–­æäº¤æ–°åŠŸèƒ½ã€‚äº‹æƒ…å¾ˆå¿«å°±å˜å¾—æ¸…æ¥šäº†ï¼Œä¸å¯èƒ½åœ¨ä¸€ä¸ªç‰ˆæœ¬é‡Œé¢åŒ…æ‹¬æ‰€æœ‰å°†è¦å¼•å…¥çš„åŠŸèƒ½ã€‚å¸¸è§„çš„åšæ³•æ˜¯å…ˆå‘å¸ƒ6.0ç‰ˆï¼Œè¿‡ä¸€æ®µæ—¶é—´å†å‘6.1ç‰ˆï¼Œç„¶åæ˜¯6.2ç‰ˆã€6.3ç‰ˆç­‰ç­‰ã€‚<br><a id="more"></a><br>ä½†æ˜¯ï¼Œæ ‡å‡†çš„åˆ¶å®šè€…ä¸æƒ³è¿™æ ·åšã€‚ä»–ä»¬æƒ³è®©æ ‡å‡†çš„å‡çº§æˆä¸ºå¸¸è§„æµç¨‹ï¼šä»»ä½•äººåœ¨ä»»ä½•æ—¶å€™ï¼Œéƒ½å¯ä»¥å‘æ ‡å‡†å§”å‘˜ä¼šæäº¤æ–°è¯­æ³•çš„ææ¡ˆï¼Œç„¶åæ ‡å‡†å§”å‘˜ä¼šæ¯ä¸ªæœˆå¼€ä¸€æ¬¡ä¼šï¼Œè¯„ä¼°è¿™äº›ææ¡ˆæ˜¯å¦å¯ä»¥æ¥å—ï¼Œéœ€è¦å“ªäº›æ”¹è¿›ã€‚å¦‚æœç»è¿‡å¤šæ¬¡ä¼šè®®ä»¥åï¼Œä¸€ä¸ªææ¡ˆè¶³å¤Ÿæˆç†Ÿäº†ï¼Œå°±å¯ä»¥æ­£å¼è¿›å…¥æ ‡å‡†äº†ã€‚è¿™å°±æ˜¯è¯´ï¼Œæ ‡å‡†çš„ç‰ˆæœ¬å‡çº§æˆä¸ºäº†ä¸€ä¸ªä¸æ–­æ»šåŠ¨çš„æµç¨‹ï¼Œæ¯ä¸ªæœˆéƒ½ä¼šæœ‰å˜åŠ¨ã€‚</p>
<p>æ ‡å‡†å§”å‘˜ä¼šæœ€ç»ˆå†³å®šï¼Œæ ‡å‡†åœ¨æ¯å¹´çš„6æœˆä»½æ­£å¼å‘å¸ƒä¸€æ¬¡ï¼Œä½œä¸ºå½“å¹´çš„æ­£å¼ç‰ˆæœ¬ã€‚æ¥ä¸‹æ¥çš„æ—¶é—´ï¼Œå°±åœ¨è¿™ä¸ªç‰ˆæœ¬çš„åŸºç¡€ä¸Šåšæ”¹åŠ¨ï¼Œç›´åˆ°ä¸‹ä¸€å¹´çš„6æœˆä»½ï¼Œè‰æ¡ˆå°±è‡ªç„¶å˜æˆäº†æ–°ä¸€å¹´çš„ç‰ˆæœ¬ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸éœ€è¦ä»¥å‰çš„ç‰ˆæœ¬å·äº†ï¼Œåªè¦ç”¨å¹´ä»½æ ‡è®°å°±å¯ä»¥äº†ã€‚</p>
<p>ES6çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œå°±è¿™æ ·åœ¨2015å¹´6æœˆå‘å¸ƒäº†ï¼Œæ­£å¼åç§°å°±æ˜¯ã€ŠECMAScript 2015æ ‡å‡†ã€‹ï¼ˆç®€ç§°ES2015ï¼‰ã€‚2016å¹´6æœˆï¼Œå°å¹…ä¿®è®¢çš„ã€ŠECMAScript 2016æ ‡å‡†ã€‹ï¼ˆç®€ç§°ES2016ï¼‰å¦‚æœŸå‘å¸ƒï¼Œè¿™ä¸ªç‰ˆæœ¬å¯ä»¥çœ‹ä½œæ˜¯ES6.1ç‰ˆï¼Œå› ä¸ºä¸¤è€…çš„å·®å¼‚éå¸¸å°ï¼ˆåªæ–°å¢äº†æ•°ç»„å®ä¾‹çš„<code>includes</code>æ–¹æ³•å’ŒæŒ‡æ•°è¿ç®—ç¬¦ï¼‰ï¼ŒåŸºæœ¬ä¸Šæ˜¯åŒä¸€ä¸ªæ ‡å‡†ã€‚æ ¹æ®è®¡åˆ’ï¼Œ2017å¹´6æœˆå°†å‘å¸ƒES2017æ ‡å‡†ã€‚</p>
<p>å› æ­¤ï¼ŒES6æ—¢æ˜¯ä¸€ä¸ªå†å²åè¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ³›æŒ‡ï¼Œå«ä¹‰æ˜¯5.1ç‰ˆä»¥åçš„JavaScriptçš„ä¸‹ä¸€ä»£æ ‡å‡†ï¼Œæ¶µç›–äº†ES2015ã€ES2016ã€ES2017ç­‰ç­‰ï¼Œè€ŒES2015åˆ™æ˜¯æ­£å¼åç§°ï¼Œç‰¹æŒ‡è¯¥å¹´å‘å¸ƒçš„æ­£å¼ç‰ˆæœ¬çš„è¯­è¨€æ ‡å‡†ã€‚æœ¬ä¹¦ä¸­æåˆ°â€œES6â€çš„åœ°æ–¹ï¼Œä¸€èˆ¬æ˜¯æŒ‡ES2015æ ‡å‡†ï¼Œä½†æœ‰æ—¶ä¹Ÿæ˜¯æ³›æŒ‡â€œä¸‹ä¸€ä»£JavaScriptè¯­è¨€â€ã€‚</p>
<h2 id="è¯­æ³•ææ¡ˆçš„æ‰¹å‡†æµç¨‹"><a href="#è¯­æ³•ææ¡ˆçš„æ‰¹å‡†æµç¨‹" class="headerlink" title="è¯­æ³•ææ¡ˆçš„æ‰¹å‡†æµç¨‹"></a>è¯­æ³•ææ¡ˆçš„æ‰¹å‡†æµç¨‹</h2><p>ä»»ä½•äººéƒ½å¯ä»¥å‘TC39æ ‡å‡†å§”å‘˜ä¼šææ¡ˆã€‚ä¸€ç§æ–°çš„è¯­æ³•ä»ææ¡ˆåˆ°å˜æˆæ­£å¼æ ‡å‡†ï¼Œéœ€è¦ç»å†äº”ä¸ªé˜¶æ®µã€‚æ¯ä¸ªé˜¶æ®µçš„å˜åŠ¨éƒ½éœ€è¦ç”±TC39å§”å‘˜ä¼šæ‰¹å‡†ã€‚</p>
<ul>
<li>Stage 0 - Strawmanï¼ˆå±•ç¤ºé˜¶æ®µï¼‰</li>
<li>Stage 1 - Proposalï¼ˆå¾æ±‚æ„è§é˜¶æ®µï¼‰</li>
<li>Stage 2 - Draftï¼ˆè‰æ¡ˆé˜¶æ®µï¼‰</li>
<li>Stage 3 - Candidateï¼ˆå€™é€‰äººé˜¶æ®µï¼‰</li>
<li>Stage 4 - Finishedï¼ˆå®šæ¡ˆé˜¶æ®µï¼‰</li>
</ul>
<p>ä¸€ä¸ªææ¡ˆåªè¦èƒ½è¿›å…¥Stage 2ï¼Œå°±å·®ä¸å¤šç­‰äºè‚¯å®šä¼šåŒ…æ‹¬åœ¨ä»¥åçš„æ­£å¼æ ‡å‡†é‡Œé¢ã€‚ECMAScriptå½“å‰çš„æ‰€æœ‰ææ¡ˆï¼Œå¯ä»¥åœ¨TC39çš„å®˜æ–¹ç½‘ç«™<a href="https://github.com/tc39/ecma262" target="_blank" rel="external">Github.com/tc39/ecma262</a>æŸ¥çœ‹ã€‚</p>
<p>æœ¬ä¹¦çš„å†™ä½œç›®æ ‡ä¹‹ä¸€ï¼Œæ˜¯è·Ÿè¸ªECMAScriptè¯­è¨€çš„æœ€æ–°è¿›å±•ï¼Œä»‹ç»5.1ç‰ˆæœ¬ä»¥åæ‰€æœ‰çš„æ–°è¯­æ³•ã€‚å¯¹äºé‚£äº›æ˜ç¡®å°†è¦åˆ—å…¥æ ‡å‡†çš„æ–°è¯­æ³•ï¼Œå°¤å…¶æ˜¯é‚£äº›Babelè½¬ç å™¨ï¼ˆè¯¦è§åæ–‡ï¼‰å·²ç»æ”¯æŒçš„åŠŸèƒ½ï¼Œä¹Ÿå°†äºˆä»¥ä»‹ç»ã€‚</p>
<h2 id="ECMAScriptçš„å†å²"><a href="#ECMAScriptçš„å†å²" class="headerlink" title="ECMAScriptçš„å†å²"></a>ECMAScriptçš„å†å²</h2><p>ES6ä»å¼€å§‹åˆ¶å®šåˆ°æœ€åå‘å¸ƒï¼Œæ•´æ•´ç”¨äº†15å¹´ã€‚</p>
<p>å‰é¢æåˆ°ï¼ŒECMAScript 1.0æ˜¯1997å¹´å‘å¸ƒçš„ï¼Œæ¥ä¸‹æ¥çš„ä¸¤å¹´ï¼Œè¿ç»­å‘å¸ƒäº†ECMAScript 2.0ï¼ˆ1998å¹´6æœˆï¼‰å’ŒECMAScript 3.0ï¼ˆ1999å¹´12æœˆï¼‰ã€‚3.0ç‰ˆæ˜¯ä¸€ä¸ªå·¨å¤§çš„æˆåŠŸï¼Œåœ¨ä¸šç•Œå¾—åˆ°å¹¿æ³›æ”¯æŒï¼Œæˆä¸ºé€šè¡Œæ ‡å‡†ï¼Œå¥ å®šäº†JavaScriptè¯­è¨€çš„åŸºæœ¬è¯­æ³•ï¼Œä»¥åçš„ç‰ˆæœ¬å®Œå…¨ç»§æ‰¿ã€‚ç›´åˆ°ä»Šå¤©ï¼Œåˆå­¦è€…ä¸€å¼€å§‹å­¦ä¹ JavaScriptï¼Œå…¶å®å°±æ˜¯åœ¨å­¦3.0ç‰ˆçš„è¯­æ³•ã€‚</p>
<p>2000å¹´ï¼ŒECMAScript 4.0å¼€å§‹é…é…¿ã€‚è¿™ä¸ªç‰ˆæœ¬æœ€åæ²¡æœ‰é€šè¿‡ï¼Œä½†æ˜¯å®ƒçš„å¤§éƒ¨åˆ†å†…å®¹è¢«ES6ç»§æ‰¿äº†ã€‚å› æ­¤ï¼ŒES6åˆ¶å®šçš„èµ·ç‚¹å…¶å®æ˜¯2000å¹´ã€‚</p>
<p>ä¸ºä»€ä¹ˆES4æ²¡æœ‰é€šè¿‡å‘¢ï¼Ÿå› ä¸ºè¿™ä¸ªç‰ˆæœ¬å¤ªæ¿€è¿›äº†ï¼Œå¯¹ES3åšäº†å½»åº•å‡çº§ï¼Œå¯¼è‡´æ ‡å‡†å§”å‘˜ä¼šçš„ä¸€äº›æˆå‘˜ä¸æ„¿æ„æ¥å—ã€‚ECMAçš„ç¬¬39å·æŠ€æœ¯ä¸“å®¶å§”å‘˜ä¼šï¼ˆTechnical Committee 39ï¼Œç®€ç§°TC39ï¼‰è´Ÿè´£åˆ¶è®¢ECMAScriptæ ‡å‡†ï¼Œæˆå‘˜åŒ…æ‹¬Microsoftã€Mozillaã€Googleç­‰å¤§å…¬å¸ã€‚</p>
<p>2007å¹´10æœˆï¼ŒECMAScript 4.0ç‰ˆè‰æ¡ˆå‘å¸ƒï¼Œæœ¬æ¥é¢„è®¡æ¬¡å¹´8æœˆå‘å¸ƒæ­£å¼ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œå„æ–¹å¯¹äºæ˜¯å¦é€šè¿‡è¿™ä¸ªæ ‡å‡†ï¼Œå‘ç”Ÿäº†ä¸¥é‡åˆ†æ­§ã€‚ä»¥Yahooã€Microsoftã€Googleä¸ºé¦–çš„å¤§å…¬å¸ï¼Œåå¯¹JavaScriptçš„å¤§å¹…å‡çº§ï¼Œä¸»å¼ å°å¹…æ”¹åŠ¨ï¼›ä»¥JavaScriptåˆ›é€ è€…Brendan Eichä¸ºé¦–çš„Mozillaå…¬å¸ï¼Œåˆ™åšæŒå½“å‰çš„è‰æ¡ˆã€‚</p>
<p>2008å¹´7æœˆï¼Œç”±äºå¯¹äºä¸‹ä¸€ä¸ªç‰ˆæœ¬åº”è¯¥åŒ…æ‹¬å“ªäº›åŠŸèƒ½ï¼Œå„æ–¹åˆ†æ­§å¤ªå¤§ï¼Œäº‰è®ºè¿‡äºæ¿€çƒˆï¼ŒECMAå¼€ä¼šå†³å®šï¼Œä¸­æ­¢ECMAScript 4.0çš„å¼€å‘ï¼Œå°†å…¶ä¸­æ¶‰åŠç°æœ‰åŠŸèƒ½æ”¹å–„çš„ä¸€å°éƒ¨åˆ†ï¼Œå‘å¸ƒä¸ºECMAScript 3.1ï¼Œè€Œå°†å…¶ä»–æ¿€è¿›çš„è®¾æƒ³æ‰©å¤§èŒƒå›´ï¼Œæ”¾å…¥ä»¥åçš„ç‰ˆæœ¬ï¼Œç”±äºä¼šè®®çš„æ°”æ°›ï¼Œè¯¥ç‰ˆæœ¬çš„é¡¹ç›®ä»£å·èµ·åä¸ºHarmonyï¼ˆå’Œè°ï¼‰ã€‚ä¼šåä¸ä¹…ï¼ŒECMAScript 3.1å°±æ”¹åä¸ºECMAScript 5ã€‚</p>
<p>2009å¹´12æœˆï¼ŒECMAScript 5.0ç‰ˆæ­£å¼å‘å¸ƒã€‚Harmonyé¡¹ç›®åˆ™ä¸€åˆ†ä¸ºäºŒï¼Œä¸€äº›è¾ƒä¸ºå¯è¡Œçš„è®¾æƒ³å®šåä¸ºJavaScript.nextç»§ç»­å¼€å‘ï¼Œåæ¥æ¼”å˜æˆECMAScript 6ï¼›ä¸€äº›ä¸æ˜¯å¾ˆæˆç†Ÿçš„è®¾æƒ³ï¼Œåˆ™è¢«è§†ä¸ºJavaScript.next.nextï¼Œåœ¨æ›´è¿œçš„å°†æ¥å†è€ƒè™‘æ¨å‡ºã€‚TC39å§”å‘˜ä¼šçš„æ€»ä½“è€ƒè™‘æ˜¯ï¼ŒES5ä¸ES3åŸºæœ¬ä¿æŒå…¼å®¹ï¼Œè¾ƒå¤§çš„è¯­æ³•ä¿®æ­£å’Œæ–°åŠŸèƒ½åŠ å…¥ï¼Œå°†ç”±JavaScript.nextå®Œæˆã€‚å½“æ—¶ï¼ŒJavaScript.nextæŒ‡çš„æ˜¯ES6ï¼Œç¬¬å…­ç‰ˆå‘å¸ƒä»¥åï¼Œå°±æŒ‡ES7ã€‚TC39çš„åˆ¤æ–­æ˜¯ï¼ŒES5ä¼šåœ¨2013å¹´çš„å¹´ä¸­æˆä¸ºJavaScriptå¼€å‘çš„ä¸»æµæ ‡å‡†ï¼Œå¹¶åœ¨æ­¤åäº”å¹´ä¸­ä¸€ç›´ä¿æŒè¿™ä¸ªä½ç½®ã€‚</p>
<p>2011å¹´6æœˆï¼ŒECMAscript 5.1ç‰ˆå‘å¸ƒï¼Œå¹¶ä¸”æˆä¸ºISOå›½é™…æ ‡å‡†ï¼ˆISO/IEC 16262:2011ï¼‰ã€‚</p>
<p>2013å¹´3æœˆï¼ŒECMAScript 6è‰æ¡ˆå†»ç»“ï¼Œä¸å†æ·»åŠ æ–°åŠŸèƒ½ã€‚æ–°çš„åŠŸèƒ½è®¾æƒ³å°†è¢«æ”¾åˆ°ECMAScript 7ã€‚</p>
<p>2013å¹´12æœˆï¼ŒECMAScript 6è‰æ¡ˆå‘å¸ƒã€‚ç„¶åæ˜¯12ä¸ªæœˆçš„è®¨è®ºæœŸï¼Œå¬å–å„æ–¹åé¦ˆã€‚</p>
<p>2015å¹´6æœˆï¼ŒECMAScript 6æ­£å¼é€šè¿‡ï¼Œæˆä¸ºå›½é™…æ ‡å‡†ã€‚ä»2000å¹´ç®—èµ·ï¼Œè¿™æ—¶å·²ç»è¿‡å»äº†15å¹´ã€‚</p>
<h2 id="éƒ¨ç½²è¿›åº¦"><a href="#éƒ¨ç½²è¿›åº¦" class="headerlink" title="éƒ¨ç½²è¿›åº¦"></a>éƒ¨ç½²è¿›åº¦</h2><p>å„å¤§æµè§ˆå™¨çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¯¹ES6çš„æ”¯æŒå¯ä»¥æŸ¥çœ‹<a href="http://kangax.github.io/es5-compat-table/es6/" target="_blank" rel="external">kangax.github.io/es5-compat-table/es6/</a>ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ”¯æŒåº¦å·²ç»è¶Šæ¥è¶Šé«˜äº†ï¼ŒES6çš„å¤§éƒ¨åˆ†ç‰¹æ€§éƒ½å®ç°äº†ã€‚</p>
<p>Node.jsæ˜¯JavaScriptè¯­è¨€çš„æœåŠ¡å™¨è¿è¡Œç¯å¢ƒï¼Œå¯¹ES6çš„æ”¯æŒåº¦æ¯”æµè§ˆå™¨æ›´é«˜ã€‚é€šè¿‡Nodeï¼Œå¯ä»¥ä½“éªŒæ›´å¤šES6çš„ç‰¹æ€§ã€‚å»ºè®®ä½¿ç”¨ç‰ˆæœ¬ç®¡ç†å·¥å…·<a href="https://github.com/creationix/nvm" target="_blank" rel="external">nvm</a>ï¼Œæ¥å®‰è£…Nodeï¼Œå› ä¸ºå¯ä»¥è‡ªç”±åˆ‡æ¢ç‰ˆæœ¬ã€‚ä¸è¿‡ï¼Œ<code>nvm</code>ä¸æ”¯æŒWindowsç³»ç»Ÿï¼Œå¦‚æœä½ ä½¿ç”¨Windowsç³»ç»Ÿï¼Œä¸‹é¢çš„æ“ä½œå¯ä»¥æ”¹ç”¨<a href="https://github.com/hakobera/nvmw" target="_blank" rel="external">nvmw</a>æˆ–<a href="https://github.com/coreybutler/nvm-windows" target="_blank" rel="external">nvm-windows</a>ä»£æ›¿ã€‚</p>
<p>å®‰è£…nvméœ€è¦æ‰“å¼€å‘½ä»¤è¡Œçª—å£ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -o- https://raw.githubusercontent.com/creationix/nvm/&lt;version number&gt;/install.sh | bash</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å‘½ä»¤çš„<code>version number</code>å¤„ï¼Œéœ€è¦ç”¨ç‰ˆæœ¬å·æ›¿æ¢ã€‚æœ¬èŠ‚å†™ä½œæ—¶çš„ç‰ˆæœ¬å·æ˜¯<code>v0.29.0</code>ã€‚è¯¥å‘½ä»¤è¿è¡Œåï¼Œ<code>nvm</code>ä¼šé»˜è®¤å®‰è£…åœ¨ç”¨æˆ·ä¸»ç›®å½•çš„<code>.nvm</code>å­ç›®å½•ã€‚</p>
<p>ç„¶åï¼Œæ¿€æ´»<code>nvm</code>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">source</span> ~/.nvm/nvm.sh</div></pre></td></tr></table></figure>
<p>æ¿€æ´»ä»¥åï¼Œå®‰è£…Nodeçš„æœ€æ–°ç‰ˆã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ nvm install node</div></pre></td></tr></table></figure>
<p>å®‰è£…å®Œæˆåï¼Œåˆ‡æ¢åˆ°è¯¥ç‰ˆæœ¬ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ nvm use node</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹Nodeæ‰€æœ‰å·²ç»å®ç°çš„ES6ç‰¹æ€§ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ node --v8-options | grep harmony</div><div class="line"></div><div class="line">  --harmony_typeof</div><div class="line">  --harmony_scoping</div><div class="line">  --harmony_modules</div><div class="line">  --harmony_symbols</div><div class="line">  --harmony_proxies</div><div class="line">  --harmony_collections</div><div class="line">  --harmony_observation</div><div class="line">  --harmony_generators</div><div class="line">  --harmony_iteration</div><div class="line">  --harmony_numeric_literals</div><div class="line">  --harmony_strings</div><div class="line">  --harmony_arrays</div><div class="line">  --harmony_maths</div><div class="line">  --harmony</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœï¼Œä¼šå› ä¸ºç‰ˆæœ¬çš„ä¸åŒè€Œæœ‰æ‰€ä¸åŒã€‚</p>
<p>æˆ‘å†™äº†ä¸€ä¸ª<a href="https://github.com/ruanyf/es-checker" target="_blank" rel="external">ES-Checker</a>æ¨¡å—ï¼Œç”¨æ¥æ£€æŸ¥å„ç§è¿è¡Œç¯å¢ƒå¯¹ES6çš„æ”¯æŒæƒ…å†µã€‚è®¿é—®<a href="http://ruanyf.github.io/es-checker" target="_blank" rel="external">ruanyf.github.io/es-checker</a>ï¼Œå¯ä»¥çœ‹åˆ°æ‚¨çš„æµè§ˆå™¨æ”¯æŒES6çš„ç¨‹åº¦ã€‚è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ä½ æ­£åœ¨ä½¿ç”¨çš„Nodeç¯å¢ƒå¯¹ES6çš„æ”¯æŒç¨‹åº¦ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ npm install -g es-checker</div><div class="line">$ es-checker</div><div class="line"></div><div class="line">=========================================</div><div class="line">Passes 24 feature Dectations</div><div class="line">Your runtime supports 57% of ECMAScript 6</div><div class="line">=========================================</div></pre></td></tr></table></figure>
<h2 id="Babelè½¬ç å™¨"><a href="#Babelè½¬ç å™¨" class="headerlink" title="Babelè½¬ç å™¨"></a>Babelè½¬ç å™¨</h2><p><a href="https://babeljs.io/" target="_blank" rel="external">Babel</a>æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ES6è½¬ç å™¨ï¼Œå¯ä»¥å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ï¼Œä»è€Œåœ¨ç°æœ‰ç¯å¢ƒæ‰§è¡Œã€‚è¿™æ„å‘³ç€ï¼Œä½ å¯ä»¥ç”¨ES6çš„æ–¹å¼ç¼–å†™ç¨‹åºï¼Œåˆä¸ç”¨æ‹…å¿ƒç°æœ‰ç¯å¢ƒæ˜¯å¦æ”¯æŒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è½¬ç å‰</span></div><div class="line">input.map(<span class="function"><span class="params">item</span> =&gt;</span> item + <span class="number">1</span>);</div><div class="line"></div><div class="line"><span class="comment">// è½¬ç å</span></div><div class="line">input.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> item + <span class="number">1</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„åŸå§‹ä»£ç ç”¨äº†ç®­å¤´å‡½æ•°ï¼Œè¿™ä¸ªç‰¹æ€§è¿˜æ²¡æœ‰å¾—åˆ°å¹¿æ³›æ”¯æŒï¼ŒBabelå°†å…¶è½¬ä¸ºæ™®é€šå‡½æ•°ï¼Œå°±èƒ½åœ¨ç°æœ‰çš„JavaScriptç¯å¢ƒæ‰§è¡Œäº†ã€‚</p>
<h3 id="é…ç½®æ–‡ä»¶-babelrc"><a href="#é…ç½®æ–‡ä»¶-babelrc" class="headerlink" title="é…ç½®æ–‡ä»¶.babelrc"></a>é…ç½®æ–‡ä»¶<code>.babelrc</code></h3><p>Babelçš„é…ç½®æ–‡ä»¶æ˜¯<code>.babelrc</code>ï¼Œå­˜æ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚ä½¿ç”¨Babelçš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯é…ç½®è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>è¯¥æ–‡ä»¶ç”¨æ¥è®¾ç½®è½¬ç è§„åˆ™å’Œæ’ä»¶ï¼ŒåŸºæœ¬æ ¼å¼å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"presets"</span>: [],</div><div class="line">  <span class="string">"plugins"</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>presets</code>å­—æ®µè®¾å®šè½¬ç è§„åˆ™ï¼Œå®˜æ–¹æä¾›ä»¥ä¸‹çš„è§„åˆ™é›†ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦å®‰è£…ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ES2015è½¬ç è§„åˆ™</span></div><div class="line">$ npm install --save-dev babel-preset-es2015</div><div class="line"></div><div class="line"><span class="comment"># reactè½¬ç è§„åˆ™</span></div><div class="line">$ npm install --save-dev babel-preset-react</div><div class="line"></div><div class="line"><span class="comment"># ES7ä¸åŒé˜¶æ®µè¯­æ³•ææ¡ˆçš„è½¬ç è§„åˆ™ï¼ˆå…±æœ‰4ä¸ªé˜¶æ®µï¼‰ï¼Œé€‰è£…ä¸€ä¸ª</span></div><div class="line">$ npm install --save-dev babel-preset-stage-0</div><div class="line">$ npm install --save-dev babel-preset-stage-1</div><div class="line">$ npm install --save-dev babel-preset-stage-2</div><div class="line">$ npm install --save-dev babel-preset-stage-3</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°†è¿™äº›è§„åˆ™åŠ å…¥<code>.babelrc</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"presets"</span>: [</div><div class="line">    <span class="string">"es2015"</span>,</div><div class="line">    <span class="string">"react"</span>,</div><div class="line">    <span class="string">"stage-2"</span></div><div class="line">  ],</div><div class="line">  <span class="string">"plugins"</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä»¥ä¸‹æ‰€æœ‰Babelå·¥å…·å’Œæ¨¡å—çš„ä½¿ç”¨ï¼Œéƒ½å¿…é¡»å…ˆå†™å¥½<code>.babelrc</code>ã€‚</p>
<h3 id="å‘½ä»¤è¡Œè½¬ç babel-cli"><a href="#å‘½ä»¤è¡Œè½¬ç babel-cli" class="headerlink" title="å‘½ä»¤è¡Œè½¬ç babel-cli"></a>å‘½ä»¤è¡Œè½¬ç <code>babel-cli</code></h3><p>Babelæä¾›<code>babel-cli</code>å·¥å…·ï¼Œç”¨äºå‘½ä»¤è¡Œè½¬ç ã€‚</p>
<p>å®ƒçš„å®‰è£…å‘½ä»¤å¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --global babel-cli</div></pre></td></tr></table></figure>
<p>åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># è½¬ç ç»“æœè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º</span></div><div class="line">$ babel example.js</div><div class="line"></div><div class="line"><span class="comment"># è½¬ç ç»“æœå†™å…¥ä¸€ä¸ªæ–‡ä»¶</span></div><div class="line"><span class="comment"># --out-file æˆ– -o å‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶</span></div><div class="line">$ babel example.js --out-file compiled.js</div><div class="line"><span class="comment"># æˆ–è€…</span></div><div class="line">$ babel example.js -o compiled.js</div><div class="line"></div><div class="line"><span class="comment"># æ•´ä¸ªç›®å½•è½¬ç </span></div><div class="line"><span class="comment"># --out-dir æˆ– -d å‚æ•°æŒ‡å®šè¾“å‡ºç›®å½•</span></div><div class="line">$ babel src --out-dir lib</div><div class="line"><span class="comment"># æˆ–è€…</span></div><div class="line">$ babel src <span class="_">-d</span> lib</div><div class="line"></div><div class="line"><span class="comment"># -s å‚æ•°ç”Ÿæˆsource mapæ–‡ä»¶</span></div><div class="line">$ babel src <span class="_">-d</span> lib <span class="_">-s</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯åœ¨å…¨å±€ç¯å¢ƒä¸‹ï¼Œè¿›è¡ŒBabelè½¬ç ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœé¡¹ç›®è¦è¿è¡Œï¼Œå…¨å±€ç¯å¢ƒå¿…é¡»æœ‰Babelï¼Œä¹Ÿå°±æ˜¯è¯´é¡¹ç›®äº§ç”Ÿäº†å¯¹ç¯å¢ƒçš„ä¾èµ–ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™æ ·åšä¹Ÿæ— æ³•æ”¯æŒä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„Babelã€‚</p>
<p>ä¸€ä¸ªè§£å†³åŠæ³•æ˜¯å°†<code>babel-cli</code>å®‰è£…åœ¨é¡¹ç›®ä¹‹ä¸­ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å®‰è£…</span></div><div class="line">$ npm install --save-dev babel-cli</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæ”¹å†™<code>package.json</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  <span class="string">"devDependencies"</span>: &#123;</div><div class="line">    <span class="string">"babel-cli"</span>: <span class="string">"^6.0.0"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"build"</span>: <span class="string">"babel src -d lib"</span></div><div class="line">  &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è½¬ç çš„æ—¶å€™ï¼Œå°±æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm run build</div></pre></td></tr></table></figure>
<h3 id="babel-node"><a href="#babel-node" class="headerlink" title="babel-node"></a>babel-node</h3><p><code>babel-cli</code>å·¥å…·è‡ªå¸¦ä¸€ä¸ª<code>babel-node</code>å‘½ä»¤ï¼Œæä¾›ä¸€ä¸ªæ”¯æŒES6çš„REPLç¯å¢ƒã€‚å®ƒæ”¯æŒNodeçš„REPLç¯å¢ƒçš„æ‰€æœ‰åŠŸèƒ½ï¼Œè€Œä¸”å¯ä»¥ç›´æ¥è¿è¡ŒES6ä»£ç ã€‚</p>
<p>å®ƒä¸ç”¨å•ç‹¬å®‰è£…ï¼Œè€Œæ˜¯éš<code>babel-cli</code>ä¸€èµ·å®‰è£…ã€‚ç„¶åï¼Œæ‰§è¡Œ<code>babel-node</code>å°±è¿›å…¥REPLç¯å¢ƒã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ babel-node</div><div class="line">&gt; (x =&gt; x * 2)(1)</div><div class="line">2</div></pre></td></tr></table></figure>
<p><code>babel-node</code>å‘½ä»¤å¯ä»¥ç›´æ¥è¿è¡ŒES6è„šæœ¬ã€‚å°†ä¸Šé¢çš„ä»£ç æ”¾å…¥è„šæœ¬æ–‡ä»¶<code>es6.js</code>ï¼Œç„¶åç›´æ¥è¿è¡Œã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ babel-node es6.js</div><div class="line">2</div></pre></td></tr></table></figure>
<p><code>babel-node</code>ä¹Ÿå¯ä»¥å®‰è£…åœ¨é¡¹ç›®ä¸­ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save-dev babel-cli</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæ”¹å†™<code>package.json</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"script-name"</span>: <span class="string">"babel-node script.js"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä½¿ç”¨<code>babel-node</code>æ›¿ä»£<code>node</code>ï¼Œè¿™æ ·<code>script.js</code>æœ¬èº«å°±ä¸ç”¨åšä»»ä½•è½¬ç å¤„ç†ã€‚</p>
<h3 id="babel-register"><a href="#babel-register" class="headerlink" title="babel-register"></a>babel-register</h3><p><code>babel-register</code>æ¨¡å—æ”¹å†™<code>require</code>å‘½ä»¤ï¼Œä¸ºå®ƒåŠ ä¸Šä¸€ä¸ªé’©å­ã€‚æ­¤åï¼Œæ¯å½“ä½¿ç”¨<code>require</code>åŠ è½½<code>.js</code>ã€<code>.jsx</code>ã€<code>.es</code>å’Œ<code>.es6</code>åç¼€åçš„æ–‡ä»¶ï¼Œå°±ä¼šå…ˆç”¨Babelè¿›è¡Œè½¬ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save-dev babel-register</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ—¶ï¼Œå¿…é¡»é¦–å…ˆåŠ è½½<code>babel-register</code>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">require(<span class="string">"babel-register"</span>);</div><div class="line">require(<span class="string">"./index.js"</span>);</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°±ä¸éœ€è¦æ‰‹åŠ¨å¯¹<code>index.js</code>è½¬ç äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>babel-register</code>åªä¼šå¯¹<code>require</code>å‘½ä»¤åŠ è½½çš„æ–‡ä»¶è½¬ç ï¼Œè€Œä¸ä¼šå¯¹å½“å‰æ–‡ä»¶è½¬ç ã€‚å¦å¤–ï¼Œç”±äºå®ƒæ˜¯å®æ—¶è½¬ç ï¼Œæ‰€ä»¥åªé€‚åˆåœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨ã€‚</p>
<h3 id="babel-core"><a href="#babel-core" class="headerlink" title="babel-core"></a>babel-core</h3><p>å¦‚æœæŸäº›ä»£ç éœ€è¦è°ƒç”¨Babelçš„APIè¿›è¡Œè½¬ç ï¼Œå°±è¦ä½¿ç”¨<code>babel-core</code>æ¨¡å—ã€‚</p>
<p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install babel-core --save</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œåœ¨é¡¹ç›®ä¸­å°±å¯ä»¥è°ƒç”¨<code>babel-core</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'babel-core'</span>);</div><div class="line"></div><div class="line"><span class="comment">// å­—ç¬¦ä¸²è½¬ç </span></div><div class="line">babel.transform(<span class="string">'code();'</span>, options);</div><div class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div><div class="line"></div><div class="line"><span class="comment">// æ–‡ä»¶è½¬ç ï¼ˆå¼‚æ­¥ï¼‰</span></div><div class="line">babel.transformFile(<span class="string">'filename.js'</span>, options, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</div><div class="line">  result; <span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// æ–‡ä»¶è½¬ç ï¼ˆåŒæ­¥ï¼‰</span></div><div class="line">babel.transformFileSync(<span class="string">'filename.js'</span>, options);</div><div class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div><div class="line"></div><div class="line"><span class="comment">// Babel ASTè½¬ç </span></div><div class="line">babel.transformFromAst(ast, code, options);</div><div class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div></pre></td></tr></table></figure>
<p>é…ç½®å¯¹è±¡<code>options</code>ï¼Œå¯ä»¥å‚çœ‹å®˜æ–¹æ–‡æ¡£<a href="http://babeljs.io/docs/usage/options/" target="_blank" rel="external">http://babeljs.io/docs/usage/options/</a>ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> es6Code = <span class="string">'let x = n =&gt; n + 1'</span>;</div><div class="line"><span class="keyword">var</span> es5Code = <span class="built_in">require</span>(<span class="string">'babel-core'</span>)</div><div class="line">  .transform(es6Code, &#123;</div><div class="line">    <span class="attr">presets</span>: [<span class="string">'es2015'</span>]</div><div class="line">  &#125;)</div><div class="line">  .code;</div><div class="line"><span class="comment">// '"use strict";\n\nvar x = function x(n) &#123;\n  return n + 1;\n&#125;;'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>transform</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºéœ€è¦è¢«è½¬æ¢çš„ES6ä»£ç ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è½¬æ¢çš„é…ç½®å¯¹è±¡ã€‚</p>
<h3 id="babel-polyfill"><a href="#babel-polyfill" class="headerlink" title="babel-polyfill"></a>babel-polyfill</h3><p>Babelé»˜è®¤åªè½¬æ¢æ–°çš„JavaScriptå¥æ³•ï¼ˆsyntaxï¼‰ï¼Œè€Œä¸è½¬æ¢æ–°çš„APIï¼Œæ¯”å¦‚Iteratorã€Generatorã€Setã€Mapsã€Proxyã€Reflectã€Symbolã€Promiseç­‰å…¨å±€å¯¹è±¡ï¼Œä»¥åŠä¸€äº›å®šä¹‰åœ¨å…¨å±€å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼ˆæ¯”å¦‚<code>Object.assign</code>ï¼‰éƒ½ä¸ä¼šè½¬ç ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼ŒES6åœ¨<code>Array</code>å¯¹è±¡ä¸Šæ–°å¢äº†<code>Array.from</code>æ–¹æ³•ã€‚Babelå°±ä¸ä¼šè½¬ç è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æœæƒ³è®©è¿™ä¸ªæ–¹æ³•è¿è¡Œï¼Œå¿…é¡»ä½¿ç”¨<code>babel-polyfill</code>ï¼Œä¸ºå½“å‰ç¯å¢ƒæä¾›ä¸€ä¸ªå«ç‰‡ã€‚</p>
<p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save babel-polyfill</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œåœ¨è„šæœ¬å¤´éƒ¨ï¼ŒåŠ å…¥å¦‚ä¸‹ä¸€è¡Œä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">'babel-polyfill'</span>;</div><div class="line"><span class="comment">// æˆ–è€…</span></div><div class="line"><span class="built_in">require</span>(<span class="string">'babel-polyfill'</span>);</div></pre></td></tr></table></figure>
<p>Babelé»˜è®¤ä¸è½¬ç çš„APIéå¸¸å¤šï¼Œè¯¦ç»†æ¸…å•å¯ä»¥æŸ¥çœ‹<code>babel-plugin-transform-runtime</code>æ¨¡å—çš„<a href="https://github.com/babel/babel/blob/master/packages/babel-plugin-transform-runtime/src/definitions.js" target="_blank" rel="external">definitions.js</a>æ–‡ä»¶ã€‚</p>
<h3 id="æµè§ˆå™¨ç¯å¢ƒ"><a href="#æµè§ˆå™¨ç¯å¢ƒ" class="headerlink" title="æµè§ˆå™¨ç¯å¢ƒ"></a>æµè§ˆå™¨ç¯å¢ƒ</h3><p>Babelä¹Ÿå¯ä»¥ç”¨äºæµè§ˆå™¨ç¯å¢ƒã€‚ä½†æ˜¯ï¼Œä»Babel 6.0å¼€å§‹ï¼Œä¸å†ç›´æ¥æä¾›æµè§ˆå™¨ç‰ˆæœ¬ï¼Œè€Œæ˜¯è¦ç”¨æ„å»ºå·¥å…·æ„å»ºå‡ºæ¥ã€‚å¦‚æœä½ æ²¡æœ‰æˆ–ä¸æƒ³ä½¿ç”¨æ„å»ºå·¥å…·ï¼Œå¯ä»¥é€šè¿‡å®‰è£…5.xç‰ˆæœ¬çš„<code>babel-core</code>æ¨¡å—è·å–ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install babel-core@5</div></pre></td></tr></table></figure>
<p>è¿è¡Œä¸Šé¢çš„å‘½ä»¤ä»¥åï¼Œå°±å¯ä»¥åœ¨å½“å‰ç›®å½•çš„<code>node_modules/babel-core/</code>å­ç›®å½•é‡Œé¢ï¼Œæ‰¾åˆ°<code>babel</code>çš„æµè§ˆå™¨ç‰ˆæœ¬<code>browser.js</code>ï¼ˆæœªç²¾ç®€ï¼‰å’Œ<code>browser.min.js</code>ï¼ˆå·²ç²¾ç®€ï¼‰ã€‚</p>
<p>ç„¶åï¼Œå°†ä¸‹é¢çš„ä»£ç æ’å…¥ç½‘é¡µã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/babel-core/browser.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/babel"</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="comment">// Your ES6 code</span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>browser.js</code>æ˜¯Babelæä¾›çš„è½¬æ¢å™¨è„šæœ¬ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨è¿è¡Œã€‚ç”¨æˆ·çš„ES6è„šæœ¬æ”¾åœ¨<code>script</code>æ ‡ç­¾ä¹‹ä¸­ï¼Œä½†æ˜¯è¦æ³¨æ˜<code>type=&quot;text/babel&quot;</code>ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨<a href="https://github.com/Daniel15/babel-standalone" target="_blank" rel="external">babel-standalone</a>æ¨¡å—æä¾›çš„æµè§ˆå™¨ç‰ˆæœ¬ï¼Œå°†å…¶æ’å…¥ç½‘é¡µã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.4.4/babel.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/babel"</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="comment">// Your ES6 code</span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œç½‘é¡µä¸­å®æ—¶å°†ES6ä»£ç è½¬ä¸ºES5ï¼Œå¯¹æ€§èƒ½ä¼šæœ‰å½±å“ã€‚ç”Ÿäº§ç¯å¢ƒéœ€è¦åŠ è½½å·²ç»è½¬ç å®Œæˆçš„è„šæœ¬ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦‚ä½•å°†ä»£ç æ‰“åŒ…æˆæµè§ˆå™¨å¯ä»¥ä½¿ç”¨çš„è„šæœ¬ï¼Œä»¥<code>Babel</code>é…åˆ<code>Browserify</code>ä¸ºä¾‹ã€‚é¦–å…ˆï¼Œå®‰è£…<code>babelify</code>æ¨¡å—ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save-dev babelify babel-preset-es2015</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå†ç”¨å‘½ä»¤è¡Œè½¬æ¢ES6è„šæœ¬ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$  browserify script.js -o bundle.js \</div><div class="line">  -t [ babelify --presets [ es2015 ] ]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†ES6è„šæœ¬<code>script.js</code>ï¼Œè½¬ä¸º<code>bundle.js</code>ï¼Œæµè§ˆå™¨ç›´æ¥åŠ è½½åè€…å°±å¯ä»¥äº†ã€‚</p>
<p>åœ¨<code>package.json</code>è®¾ç½®ä¸‹é¢çš„ä»£ç ï¼Œå°±ä¸ç”¨æ¯æ¬¡å‘½ä»¤è¡Œéƒ½è¾“å…¥å‚æ•°äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"browserify"</span>: &#123;</div><div class="line">    <span class="string">"transform"</span>: [[<span class="string">"babelify"</span>, &#123; <span class="string">"presets"</span>: [<span class="string">"es2015"</span>] &#125;]]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="åœ¨çº¿è½¬æ¢"><a href="#åœ¨çº¿è½¬æ¢" class="headerlink" title="åœ¨çº¿è½¬æ¢"></a>åœ¨çº¿è½¬æ¢</h3><p>Babelæä¾›ä¸€ä¸ª<a href="https://babeljs.io/repl/" target="_blank" rel="external">REPLåœ¨çº¿ç¼–è¯‘å™¨</a>ï¼Œå¯ä»¥åœ¨çº¿å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ã€‚è½¬æ¢åçš„ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºES5ä»£ç æ’å…¥ç½‘é¡µè¿è¡Œã€‚</p>
<h3 id="ä¸å…¶ä»–å·¥å…·çš„é…åˆ"><a href="#ä¸å…¶ä»–å·¥å…·çš„é…åˆ" class="headerlink" title="ä¸å…¶ä»–å·¥å…·çš„é…åˆ"></a>ä¸å…¶ä»–å·¥å…·çš„é…åˆ</h3><p>è®¸å¤šå·¥å…·éœ€è¦Babelè¿›è¡Œå‰ç½®è½¬ç ï¼Œè¿™é‡Œä¸¾ä¸¤ä¸ªä¾‹å­ï¼šESLintå’ŒMochaã€‚</p>
<p>ESLintç”¨äºé™æ€æ£€æŸ¥ä»£ç çš„è¯­æ³•å’Œé£æ ¼ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save-dev eslint babel-eslint</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶<code>.eslintrc</code>ï¼Œåœ¨å…¶ä¸­åŠ å…¥<code>parser</code>å­—æ®µã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</div><div class="line">  <span class="string">"rules"</span>: &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†åœ¨<code>package.json</code>ä¹‹ä¸­ï¼ŒåŠ å…¥ç›¸åº”çš„<code>scripts</code>è„šæœ¬ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"my-module"</span>,</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"lint"</span>: <span class="string">"eslint my-files.js"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"devDependencies"</span>: &#123;</div><div class="line">    <span class="string">"babel-eslint"</span>: <span class="string">"..."</span>,</div><div class="line">    <span class="string">"eslint"</span>: <span class="string">"..."</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Mochaåˆ™æ˜¯ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Œå¦‚æœéœ€è¦æ‰§è¡Œä½¿ç”¨ES6è¯­æ³•çš„æµ‹è¯•è„šæœ¬ï¼Œå¯ä»¥ä¿®æ”¹<code>package.json</code>çš„<code>scripts.test</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">  <span class="string">"test"</span>: <span class="string">"mocha --ui qunit --compilers js:babel-core/register"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å‘½ä»¤ä¸­ï¼Œ<code>--compilers</code>å‚æ•°æŒ‡å®šè„šæœ¬çš„è½¬ç å™¨ï¼Œè§„å®šåç¼€åä¸º<code>js</code>çš„æ–‡ä»¶ï¼Œéƒ½éœ€è¦ä½¿ç”¨<code>babel-core/register</code>å…ˆè½¬ç ã€‚</p>
<h2 id="Traceurè½¬ç å™¨"><a href="#Traceurè½¬ç å™¨" class="headerlink" title="Traceurè½¬ç å™¨"></a>Traceurè½¬ç å™¨</h2><p>Googleå…¬å¸çš„<a href="https://github.com/google/traceur-compiler" target="_blank" rel="external">Traceur</a>è½¬ç å™¨ï¼Œä¹Ÿå¯ä»¥å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ã€‚</p>
<h3 id="ç›´æ¥æ’å…¥ç½‘é¡µ"><a href="#ç›´æ¥æ’å…¥ç½‘é¡µ" class="headerlink" title="ç›´æ¥æ’å…¥ç½‘é¡µ"></a>ç›´æ¥æ’å…¥ç½‘é¡µ</h3><p>Traceurå…è®¸å°†ES6ä»£ç ç›´æ¥æ’å…¥ç½‘é¡µã€‚é¦–å…ˆï¼Œå¿…é¡»åœ¨ç½‘é¡µå¤´éƒ¨åŠ è½½Traceuråº“æ–‡ä»¶ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://google.github.io/traceur-compiler/bin/traceur.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://google.github.io/traceur-compiler/bin/BrowserSystem.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://google.github.io/traceur-compiler/src/bootstrap.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">import</span> <span class="string">'./Greeter.js'</span>;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€å…±æœ‰4ä¸ª<code>script</code>æ ‡ç­¾ã€‚ç¬¬ä¸€ä¸ªæ˜¯åŠ è½½Traceurçš„åº“æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜¯å°†è¿™ä¸ªåº“æ–‡ä»¶ç”¨äºæµè§ˆå™¨ç¯å¢ƒï¼Œç¬¬å››ä¸ªåˆ™æ˜¯åŠ è½½ç”¨æˆ·è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬é‡Œé¢å¯ä»¥ä½¿ç”¨ES6ä»£ç ã€‚</p>
<p>æ³¨æ„ï¼Œç¬¬å››ä¸ª<code>script</code>æ ‡ç­¾çš„<code>type</code>å±æ€§çš„å€¼æ˜¯<code>module</code>ï¼Œè€Œä¸æ˜¯<code>text/javascript</code>ã€‚è¿™æ˜¯Traceurç¼–è¯‘å™¨è¯†åˆ«ES6ä»£ç çš„æ ‡å¿—ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†æ‰€æœ‰<code>type=module</code>çš„ä»£ç ç¼–è¯‘ä¸ºES5ï¼Œç„¶åå†äº¤ç»™æµè§ˆå™¨æ‰§è¡Œã€‚</p>
<p>é™¤äº†å¼•ç”¨å¤–éƒ¨ES6è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ç½‘é¡µä¸­æ”¾ç½®ES6ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;script type=<span class="string">"module"</span>&gt;</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Calc</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>()&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'Calc constructor'</span>);</div><div class="line">    &#125;</div><div class="line">    add(a, b)&#123;</div><div class="line">      <span class="keyword">return</span> a + b;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> c = <span class="keyword">new</span> Calc();</div><div class="line">  <span class="built_in">console</span>.log(c.add(<span class="number">4</span>,<span class="number">5</span>));</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸Šé¢ä»£ç ä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡º9ã€‚</p>
<p>å¦‚æœæƒ³å¯¹Traceurçš„è¡Œä¸ºæœ‰ç²¾ç¡®æ§åˆ¶ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢å‚æ•°é…ç½®çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  <span class="comment">// Create the System object</span></div><div class="line">  <span class="built_in">window</span>.System = <span class="keyword">new</span> traceur.runtime.BrowserTraceurLoader();</div><div class="line">  <span class="comment">// Set some experimental options</span></div><div class="line">  <span class="keyword">var</span> metadata = &#123;</div><div class="line">    <span class="attr">traceurOptions</span>: &#123;</div><div class="line">      <span class="attr">experimental</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">properTailCalls</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">symbols</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">arrayComprehension</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">asyncFunctions</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">asyncGenerators</span>: exponentiation,</div><div class="line">      <span class="attr">forOn</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">generatorComprehension</span>: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">  <span class="comment">// Load your module</span></div><div class="line">  System.import(<span class="string">'./myModule.js'</span>, &#123;<span class="attr">metadata</span>: metadata&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">ex</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.error(<span class="string">'Import failed'</span>, ex.stack || ex);</div><div class="line">  &#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆç”ŸæˆTraceurçš„å…¨å±€å¯¹è±¡<code>window.System</code>ï¼Œç„¶å<code>System.import</code>æ–¹æ³•å¯ä»¥ç”¨æ¥åŠ è½½ES6æ¨¡å—ã€‚åŠ è½½çš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡<code>metadata</code>ï¼Œè¯¥å¯¹è±¡çš„<code>traceurOptions</code>å±æ€§å¯ä»¥é…ç½®æ”¯æŒES6åŠŸèƒ½ã€‚å¦‚æœè®¾ä¸º<code>experimental: true</code>ï¼Œå°±è¡¨ç¤ºé™¤äº†ES6ä»¥å¤–ï¼Œè¿˜æ”¯æŒä¸€äº›å®éªŒæ€§çš„æ–°åŠŸèƒ½ã€‚</p>
<h3 id="åœ¨çº¿è½¬æ¢-1"><a href="#åœ¨çº¿è½¬æ¢-1" class="headerlink" title="åœ¨çº¿è½¬æ¢"></a>åœ¨çº¿è½¬æ¢</h3><p>Traceurä¹Ÿæä¾›ä¸€ä¸ª<a href="http://google.github.io/traceur-compiler/demo/repl.html" target="_blank" rel="external">åœ¨çº¿ç¼–è¯‘å™¨</a>ï¼Œå¯ä»¥åœ¨çº¿å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ã€‚è½¬æ¢åçš„ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºES5ä»£ç æ’å…¥ç½‘é¡µè¿è¡Œã€‚</p>
<p>ä¸Šé¢çš„ä¾‹å­è½¬ä¸ºES5ä»£ç è¿è¡Œï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"https://google.github.io/traceur-compiler/bin/traceur.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">&lt;script src=<span class="string">"https://google.github.io/traceur-compiler/bin/BrowserSystem.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">&lt;script src=<span class="string">"https://google.github.io/traceur-compiler/src/bootstrap.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line">&lt;script&gt;</div><div class="line">$traceurRuntime.ModuleStore.getAnonymousModule(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">  "use strict"</span>;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> Calc = <span class="function"><span class="keyword">function</span> <span class="title">Calc</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Calc constructor'</span>);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  ($traceurRuntime.createClass)(Calc, &#123;<span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a + b;</div><div class="line">  &#125;&#125;, &#123;&#125;);</div><div class="line"></div><div class="line">  <span class="keyword">var</span> c = <span class="keyword">new</span> Calc();</div><div class="line">  <span class="built_in">console</span>.log(c.add(<span class="number">4</span>, <span class="number">5</span>));</div><div class="line">  <span class="keyword">return</span> &#123;&#125;;</div><div class="line">&#125;);</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<h3 id="å‘½ä»¤è¡Œè½¬æ¢"><a href="#å‘½ä»¤è¡Œè½¬æ¢" class="headerlink" title="å‘½ä»¤è¡Œè½¬æ¢"></a>å‘½ä»¤è¡Œè½¬æ¢</h3><p>ä½œä¸ºå‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨æ—¶ï¼ŒTraceuræ˜¯ä¸€ä¸ªNodeçš„æ¨¡å—ï¼Œé¦–å…ˆéœ€è¦ç”¨Npmå®‰è£…ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install -g traceur</div></pre></td></tr></table></figure>
<p>å®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨Traceuräº†ã€‚</p>
<p>Traceurç›´æ¥è¿è¡Œes6è„šæœ¬æ–‡ä»¶ï¼Œä¼šåœ¨æ ‡å‡†è¾“å‡ºæ˜¾ç¤ºè¿è¡Œç»“æœï¼Œä»¥å‰é¢çš„<code>calc.js</code>ä¸ºä¾‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ traceur calc.js</div><div class="line">Calc constructor</div><div class="line">9</div></pre></td></tr></table></figure>
<p>å¦‚æœè¦å°†ES6è„šæœ¬è½¬ä¸ºES5ä¿å­˜ï¼Œè¦é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ traceur --script calc.es6.js --out calc.es5.js</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>--script</code>é€‰é¡¹è¡¨ç¤ºæŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œ<code>--out</code>é€‰é¡¹è¡¨ç¤ºæŒ‡å®šè¾“å‡ºæ–‡ä»¶ã€‚</p>
<p>ä¸ºäº†é˜²æ­¢æœ‰äº›ç‰¹æ€§ç¼–è¯‘ä¸æˆåŠŸï¼Œæœ€å¥½åŠ ä¸Š<code>--experimental</code>é€‰é¡¹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ traceur --script calc.es6.js --out calc.es5.js --experimental</div></pre></td></tr></table></figure>
<p>å‘½ä»¤è¡Œä¸‹è½¬æ¢ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥æ”¾åˆ°æµè§ˆå™¨ä¸­è¿è¡Œã€‚</p>
<h3 id="Node-jsç¯å¢ƒçš„ç”¨æ³•"><a href="#Node-jsç¯å¢ƒçš„ç”¨æ³•" class="headerlink" title="Node.jsç¯å¢ƒçš„ç”¨æ³•"></a>Node.jsç¯å¢ƒçš„ç”¨æ³•</h3><p>Traceurçš„Node.jsç”¨æ³•å¦‚ä¸‹ï¼ˆå‡å®šå·²å®‰è£…traceuræ¨¡å—ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> traceur = <span class="built_in">require</span>(<span class="string">'traceur'</span>);</div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="comment">// å°†ES6è„šæœ¬è½¬ä¸ºå­—ç¬¦ä¸²</span></div><div class="line"><span class="keyword">var</span> contents = fs.readFileSync(<span class="string">'es6-file.js'</span>).toString();</div><div class="line"></div><div class="line"><span class="keyword">var</span> result = traceur.compile(contents, &#123;</div><div class="line">  <span class="attr">filename</span>: <span class="string">'es6-file.js'</span>,</div><div class="line">  <span class="attr">sourceMap</span>: <span class="literal">true</span>,</div><div class="line">  <span class="comment">// å…¶ä»–è®¾ç½®</span></div><div class="line">  modules: <span class="string">'commonjs'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (result.error)</div><div class="line">  <span class="keyword">throw</span> result.error;</div><div class="line"></div><div class="line"><span class="comment">// resultå¯¹è±¡çš„jså±æ€§å°±æ˜¯è½¬æ¢åçš„ES5ä»£ç </span></div><div class="line">fs.writeFileSync(<span class="string">'out.js'</span>, result.js);</div><div class="line"><span class="comment">// sourceMapå±æ€§å¯¹åº”mapæ–‡ä»¶</span></div><div class="line">fs.writeFileSync(<span class="string">'out.js.map'</span>, result.sourceMap);</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ECMAScript 6.0ï¼ˆä»¥ä¸‹ç®€ç§°ES6ï¼‰æ˜¯JavaScriptè¯­è¨€çš„ä¸‹ä¸€ä»£æ ‡å‡†ï¼Œå·²ç»åœ¨2015å¹´6æœˆæ­£å¼å‘å¸ƒäº†ã€‚å®ƒçš„ç›®æ ‡ï¼Œæ˜¯ä½¿å¾—JavaScriptè¯­è¨€å¯ä»¥ç”¨æ¥ç¼–å†™å¤æ‚çš„å¤§å‹åº”ç”¨ç¨‹åºï¼Œæˆä¸ºä¼ä¸šçº§å¼€å‘è¯­è¨€ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ECMAScriptå’ŒJavaScriptçš„å…³ç³»&quot;&gt;&lt;a href=&quot;#ECMAScriptå’ŒJavaScriptçš„å…³ç³»&quot; class=&quot;headerlink&quot; title=&quot;ECMAScriptå’ŒJavaScriptçš„å…³ç³»&quot;&gt;&lt;/a&gt;ECMAScriptå’ŒJavaScriptçš„å…³ç³»&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ï¼ŒECMAScriptå’ŒJavaScriptåˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¦è®²æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å›é¡¾å†å²ã€‚1996å¹´11æœˆï¼ŒJavaScriptçš„åˆ›é€ è€…Netscapeå…¬å¸ï¼Œå†³å®šå°†JavaScriptæäº¤ç»™å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ECMAï¼Œå¸Œæœ›è¿™ç§è¯­è¨€èƒ½å¤Ÿæˆä¸ºå›½é™…æ ‡å‡†ã€‚æ¬¡å¹´ï¼ŒECMAå‘å¸ƒ262å·æ ‡å‡†æ–‡ä»¶ï¼ˆECMA-262ï¼‰çš„ç¬¬ä¸€ç‰ˆï¼Œè§„å®šäº†æµè§ˆå™¨è„šæœ¬è¯­è¨€çš„æ ‡å‡†ï¼Œå¹¶å°†è¿™ç§è¯­è¨€ç§°ä¸ºECMAScriptï¼Œè¿™ä¸ªç‰ˆæœ¬å°±æ˜¯1.0ç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ ‡å‡†ä»ä¸€å¼€å§‹å°±æ˜¯é’ˆå¯¹JavaScriptè¯­è¨€åˆ¶å®šçš„ï¼Œä½†æ˜¯ä¹‹æ‰€ä»¥ä¸å«JavaScriptï¼Œæœ‰ä¸¤ä¸ªåŸå› ã€‚ä¸€æ˜¯å•†æ ‡ï¼ŒJavaæ˜¯Sunå…¬å¸çš„å•†æ ‡ï¼Œæ ¹æ®æˆæƒåè®®ï¼Œåªæœ‰Netscapeå…¬å¸å¯ä»¥åˆæ³•åœ°ä½¿ç”¨JavaScriptè¿™ä¸ªåå­—ï¼Œä¸”JavaScriptæœ¬èº«ä¹Ÿå·²ç»è¢«Netscapeå…¬å¸æ³¨å†Œä¸ºå•†æ ‡ã€‚äºŒæ˜¯æƒ³ä½“ç°è¿™é—¨è¯­è¨€çš„åˆ¶å®šè€…æ˜¯ECMAï¼Œä¸æ˜¯Netscapeï¼Œè¿™æ ·æœ‰åˆ©äºä¿è¯è¿™é—¨è¯­è¨€çš„å¼€æ”¾æ€§å’Œä¸­ç«‹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼ŒECMAScriptå’ŒJavaScriptçš„å…³ç³»æ˜¯ï¼Œå‰è€…æ˜¯åè€…çš„è§„æ ¼ï¼Œåè€…æ˜¯å‰è€…çš„ä¸€ç§å®ç°ï¼ˆå¦å¤–çš„ECMAScriptæ–¹è¨€è¿˜æœ‰Jscriptå’ŒActionScriptï¼‰ã€‚æ—¥å¸¸åœºåˆï¼Œè¿™ä¸¤ä¸ªè¯æ˜¯å¯ä»¥äº’æ¢çš„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ES6ä¸ECMAScript-2015çš„å…³ç³»&quot;&gt;&lt;a href=&quot;#ES6ä¸ECMAScript-2015çš„å…³ç³»&quot; class=&quot;headerlink&quot; title=&quot;ES6ä¸ECMAScript 2015çš„å…³ç³»&quot;&gt;&lt;/a&gt;ES6ä¸ECMAScript 2015çš„å…³ç³»&lt;/h2&gt;&lt;p&gt;åª’ä½“é‡Œé¢ç»å¸¸å¯ä»¥çœ‹åˆ°â€ECMAScript 2015â€œè¿™ä¸ªè¯ï¼Œå®ƒä¸ES6æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;2011å¹´ï¼ŒECMAScript 5.1ç‰ˆå‘å¸ƒåï¼Œå°±å¼€å§‹åˆ¶å®š6.0ç‰ˆäº†ã€‚å› æ­¤ï¼Œâ€ES6â€è¿™ä¸ªè¯çš„åŸæ„ï¼Œå°±æ˜¯æŒ‡JavaScriptè¯­è¨€çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå› ä¸ºè¿™ä¸ªç‰ˆæœ¬å¼•å…¥çš„è¯­æ³•åŠŸèƒ½å¤ªå¤šï¼Œè€Œä¸”åˆ¶å®šè¿‡ç¨‹å½“ä¸­ï¼Œè¿˜æœ‰å¾ˆå¤šç»„ç»‡å’Œä¸ªäººä¸æ–­æäº¤æ–°åŠŸèƒ½ã€‚äº‹æƒ…å¾ˆå¿«å°±å˜å¾—æ¸…æ¥šäº†ï¼Œä¸å¯èƒ½åœ¨ä¸€ä¸ªç‰ˆæœ¬é‡Œé¢åŒ…æ‹¬æ‰€æœ‰å°†è¦å¼•å…¥çš„åŠŸèƒ½ã€‚å¸¸è§„çš„åšæ³•æ˜¯å…ˆå‘å¸ƒ6.0ç‰ˆï¼Œè¿‡ä¸€æ®µæ—¶é—´å†å‘6.1ç‰ˆï¼Œç„¶åæ˜¯6.2ç‰ˆã€6.3ç‰ˆç­‰ç­‰ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="ECMAScript 6" scheme="https://ailley.github.io/tags/ECMAScript-6/"/>
    
  </entry>
  
</feed>
